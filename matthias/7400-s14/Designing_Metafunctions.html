<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>4&nbsp;Designing Metafunctions</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">7400:<span class="mywbr"> &nbsp;</span> i<span class="mywbr"> &nbsp;</span>PPL</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="general.html" class="tocviewlink" data-pltdoc="x">General Information</a></td></tr><tr><td align="right"></td><td><a href="blog.html" class="tocviewlink" data-pltdoc="x">Blog</a></td></tr><tr><td align="right"></td><td><a href="texts.html" class="tocviewlink" data-pltdoc="x">Texts</a></td></tr><tr><td align="right"></td><td><a href="writing.html" class="tocviewlink" data-pltdoc="x">Writing</a></td></tr><tr><td align="right"></td><td><a href="presenting.html" class="tocviewlink" data-pltdoc="x">Presentations</a></td></tr><tr><td align="right"></td><td><a href="syllabus.html" class="tocviewlink" data-pltdoc="x">Schedule</a></td></tr><tr><td align="right"></td><td><a href="project.html" class="tocviewlink" data-pltdoc="x">Project</a></td></tr><tr><td align="right"></td><td><a href="Problem_Sets.html" class="tocviewlink" data-pltdoc="x">Problem Sets</a></td></tr><tr><td align="right"></td><td><a href="working-with-redex.html" class="tocviewselflink" data-pltdoc="x">Working with Redex</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td></td><td><a href="working-with-redex.html" class="tocviewlink" data-pltdoc="x">Working with Redex</a></td></tr></table><div class="tocviewsublist" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="lecture1.html" class="tocviewselflink" data-pltdoc="x">Lecture 1</a></td></tr><tr><td align="right"></td><td><a href="lecture2.html" class="tocviewlink" data-pltdoc="x">Lecture 2</a></td></tr><tr><td align="right"></td><td><a href="lecture3.html" class="tocviewlink" data-pltdoc="x">Lecture 3</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9660;</a></td><td></td><td><a href="lecture1.html" class="tocviewlink" data-pltdoc="x">Lecture 1</a></td></tr></table><div class="tocviewsublistbottom" style="display: block;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Natural_Languages.html" class="tocviewlink" data-pltdoc="x">Natural Languages</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Programming_Languages.html" class="tocviewlink" data-pltdoc="x">Programming Languages</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Redex__Quickly.html" class="tocviewlink" data-pltdoc="x">Redex, Quickly</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Designing Metafunctions</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="shapes1.html" class="tocviewlink" data-pltdoc="x">Example:<span class="mywbr"> &nbsp;</span> Shapes</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Redex__Quickly.html" title="backward to &quot;3 Redex, Quickly&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="lecture1.html" title="up to &quot;Lecture 1&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="shapes1.html" title="forward to &quot;5 Example: Shapes&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>4<tt>&nbsp;</tt><a name="(part._.Designing_.Metafunctions)"></a>Designing Metafunctions</h3><p><div class="SIntrapara">Design has two dimensions: process and the complexity of language
 definition. Let&rsquo;s look at the six-step process first:
</div><div class="SIntrapara"><ol><li><p>Analyze the problem. The result of the analysis is a language
definition and an interpretation. The latter explains what the various
ASts represent. We often call this language definition a  <span style="font-style: italic">data
definition</span>.</p><p>Make up some sample phrases using the language definition. They come in
handy for several of the following steps.</p></li><li><p>Formulate a <span style="font-style: italic">purpose statement</span>. A purpose statement is your
 concise description of the modeling (programming) task. One line of
 precise English per function suffices; if the project is large, add a
 paragraph for the entire project.</p><p>Also formulate a <span style="font-style: italic">function signature</span> (aka contract) using the
 language definition(s) from step 1.</p></li><li><p>Illustrate the concise purpose statement from step 2 with
 <span style="font-style: italic">functional examples</span>. The purpose of examples is to help you
 understand what the function actually computes.</p><p>Use the data definition from step 1 to design inputs. You should have one
 per language (non-terminal) clause and alternative. Use the purpose
 statement to figure out the expected values.</p></li><li><p>Create a <span style="font-style: italic">function template</span>, i.e., an outline of the function.
 An outline isn&rsquo;t some informal pseudo-code essay, but a transformation of
 all the knowledge in the data definition into a code layout. See below for
 some examples; see <a href="http://www.htdp.org">HtDP</a> for details.</p><p><span style="font-weight: bold">Note</span>: You are not required to show me your function templates in your
 homework solutions. I will be able to tell from your solution whether you
 can organize a function.</p></li><li><p>Define the function. <span style="font-style: italic">Code.</span></p><p>In most cases this task requires little more than combining the pieces on
 the right-hand side of each clause of the template. These &ldquo;combinators&rdquo;
 are sometimes elements from the AST language, and sometimes you need
 simple Racket functions. For the latter, guess and experiment in the
 interactions area. Or look in the HelpDesk.</p></li><li><p>Turn the examples into <span style="font-style: italic">unit tests</span>. Tests confirm whether your
 functions produce the right outputs for the given inputs. If a test fails,
 you may have a mistake in the function, in the test, or in both.</p><p>Every program (collection of functions) needs a test suite. Whenever
 you edit your programs, re-run the test suite. Never turn in a program
 that doesn&rsquo;t satisfy your test suite.</p></li></ol></div></p><p><div class="SIntrapara">The second dimension of design concerns the complexity of the data
definitions on which you define your functions:
</div><div class="SIntrapara"><ol><li><p>Atomic and unstructured data, e.g., symbols or chars or booleans, are
at the bottom of the chain.</p></li><li><p>The nest simplest data definition enumerates a finite number of
individual pieces of data. The <span class="RktSym">Colors</span> language is an example of
this kind.</p></li><li><p>Next up are fixed-width combinations of data, called
<span style="font-style: italic">structures</span> or <span style="font-style: italic">records</span> in many programming
languages.</p></li><li><p>Of course, you can also enumerate structures now and mixes of
structures and atomic data.</p></li><li><p>In the introduction to <span class="RktSym"><a href="http://docs.racket-lang.org/redex/The_Redex_Reference.html#%28form._%28%28lib._redex%2Freduction-semantics..rkt%29._define-language%29%29" class="RktStxLink" data-pltdoc="x">define-language</a></span> we have already seen
a self-referential data definition. You need those as soon as you want to
deal with arbitrarily large data, including, for example, natural numbers
(0, 1, 2, etc).</p></li><li><p>For the representation of programming languages, you most often need
nests of mutually referential data definitions.</p></li></ol></div><div class="SIntrapara">And yes, there are even more complex forms of data definitions. The best
 way to illustrate them is with a series of examples.</div></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="Redex__Quickly.html" title="backward to &quot;3 Redex, Quickly&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="lecture1.html" title="up to &quot;Lecture 1&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="shapes1.html" title="forward to &quot;5 Example: Shapes&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>