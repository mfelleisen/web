<!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!--

Generated from servlets.tex by tex2page, v 20070609
(running on MzScheme 370.6, unix), 
(c) Dorai Sitaram, 
http://www.ccs.neu.edu/~dorai/tex2page/tex2page-doc.html

-->
<head>
<title>
servlets
</title>
<link rel="stylesheet" type="text/css" href="servlets-Z-S.css" title=default>
<meta name=robots content="index,follow">
</head>
<body>
<div id=slidecontent>
<div align=right class=navigation></div>
<p></p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>





</p>
<p>
</p>
<p>
 </p>
<p>

</p>
<p>
</p>
<p>


</p>
<p>





</p>
<p>



</p>
<p>
</p>
<p>
 </p>
<p>














</p>
<p>



</p>
<p>
 
 
 </p>
<p>
 </p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>


</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>

</p>
<p>



</p>
<p>
  </p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>


</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
    </p>
<p>

</p>
<p>



</p>
<p>
  </p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>

</p>
<p>





</p>
<p>


</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>





</p>
<p>



</p>
<p>

</p>
<p>













</p>
<p>


</p>
<p>








</p>
<p>
</p>
<p>



</p>
<p>


  </p>
<p>
</p>
<p>
  </p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>







</p>
<p>
</p>
<p>
 </p>
<p>
</p>
<p>












</p>
<p>
</p>
<p>

 
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>



</p>
<p>
</p>
<p>


</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>




</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>





</p>
<p>





</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
 
 </p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
  </p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>







</p>
<p>
</p>
<p>
 </p>
<p>
</p>
<p>












</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<p>

</p>
<a name="node_sec_Temp_1"></a>
<h1 class=section>Extended Exercise: Interacting on the Web</h1>
<p></p>
<a name="node_sec_Temp_2"></a>
<h2 class=section>A Supplement to
<a href="http://www.htdp.org"> &#8220;How to Design Programs&#8221;</a></h2>
<p>&copy;2002 Felleisen, Findler, Flatt, Krishnamurthi
 <br>
 <br>
 <br>
</p>
<p>
</p>
<p>
</p>
<p>
</p>
<a name="node_sec_1"></a>
<h1 class=section>1&nbsp;&nbsp;Web Interactions</h1>
<p></p>
<p>
Programs can request information from the Web, process it, and post a
reply. In conventional languages, interacting via the Web is a complicated
process. In DrScheme, it is easy to develop such programs and to link
existing functions to a Web interface (assuming they are developed
according to the design recipe).  This extended exercise carefully
introduces the means to do so with a series of examples that are tied to
the classes of data in HtDP. </p>
<p>
</p>
<a name="node_sec_1.1"></a>
<h2 class=section>1.1&nbsp;&nbsp;The Basic Interaction Model</h2>
<p>
</p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node27.htm">5.1. Symbolic Information</a>
<br>

</p>

<p class=noindent>T<small>E</small><small>A</small><small>C</small><small>H</small><small>P</small><small>A</small><small>C</small><small>K</small>: <a href="servlet2.ss">servlet2.ss</a><br>
</p>
<p>
</p>

<p class=noindent>A program can query a consumer via a Web browser and obtain a
response.  The function that implements this interaction is 
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>single-query</span> <span class=selfeval>:</span> <span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=variable>String</span></code></span>
</pre></div><p>
The function consumes a question in a Web browser next to a text field. It
then suspends the program until the consumer hits <tt>return</tt> in that
field. At that point, the function produces the current content of the
text field as its result. </p>
<p>
On occasion, it is also important to inform a consumer of something and to
wait until the consumer wishes to continue the dialog. We can accomplish
this with the function 
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>inform</span> <span class=selfeval>:</span> <span class=variable>String</span> <span class=builtin>*</span> &nbsp;&rarr;&nbsp; <span class=builtin>true</span></code></span>
</pre></div><p>
It displays the given string (and indeed, as many strings as desired) on a
Web page. The bottom of the page is a link marked with the word
&#8220;Continue&#8221;. When the consumer clicks on this link, the function produces
<code class=scheme><span class=builtin>true</span></code>. </p>
<p>
Consider this expression: 
</p>
<div align=left><pre class=scheme>(<span class=variable>inform</span> <span class=selfeval>&quot;You typed&quot;</span>
        (<span class=variable>single-query</span> <span class=selfeval>&quot;How are you?&quot;</span>))
</pre></div><p>
It requests a string from the consumer and echoes it to a Web page. Here
is a slightly more interesting variant: 
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>reply</span> <span class=selfeval>:</span> <span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=variable>String</span></code></span>
<span class=comment>;; to compute a reply to a greeting </span>
(<span class=keyword>define</span> (<span class=variable>reply</span> <span class=variable>greeting</span>)
  (<span class=keyword>cond</span>
    [(<span class=builtin>string=?</span> <span class=selfeval>&quot;fine&quot;</span> <span class=variable>greeting</span>) <span class=selfeval>&quot;That's good.&quot;</span>]
    [(<span class=builtin>string=?</span> <span class=selfeval>&quot;not so good&quot;</span> <span class=variable>greeting</span>) <span class=selfeval>&quot;Oh. What's wrong?&quot;</span>]
    [<span class=keyword>else</span> <span class=selfeval>&quot;Sorry, I didn't catch this. Could you repeat this?&quot;</span>]))

(<span class=variable>inform</span> <span class=selfeval>&quot;You typed&quot;</span>
        (<span class=variable>reply</span> 
	  (<span class=variable>single-query</span> <span class=selfeval>&quot;How are you?&quot;</span>)))
</pre></div><p>
This program actually computes another string from the response to the
greeting and posts it instead of a plain echo to the next page. </p>
<p>
At first glance, <code class=scheme><span class=variable>single-query</span></code> is useless for programs that process
numeric data. After all, it only consumes and produces
strings. Fortunately, Scheme provides functions for converting strings to
numbers and numbers to strings. For example, 
</p>
<div align=left><pre class=scheme>(<span class=builtin>=</span> (<span style="font-family: sans-serif"> string</span>&rarr;<span style="font-family: sans-serif"> number</span> <span class=selfeval>&quot;5.05&quot;</span>) <span class=selfeval>5.05</span>)
</pre></div><p>
produces <code class=scheme><span class=builtin>true</span></code> and so does 
</p>
<div align=left><pre class=scheme>(<span class=builtin>string=?</span> (<span style="font-family: sans-serif"> number</span>&rarr;<span style="font-family: sans-serif"> string</span> <span class=selfeval>5.05</span>) <span class=selfeval>&quot;5.05&quot;</span>)
</pre></div><p>
Of course, not all conversions from strings to numbers can succeed. The
string <code class=scheme><span class=selfeval>&quot;this is not a number&quot;</span></code> just doesn&#8217;t represent a
number. For such cases, <code class=scheme><span style="font-family: sans-serif">string</span>&rarr;<span style="font-family: sans-serif">number</span></code> produces
<code class=scheme><span class=builtin>false</span></code>.</p>
<p>
Using the conversion functions, we can now develop a simplistic calculator
expression: 
</p>
<div align=left><pre class=scheme>(<span class=variable>inform</span>
 <span class=selfeval>&quot;Calculator Result&quot;</span>
 (<span style="font-family: sans-serif"> number</span>&rarr;<span style="font-family: sans-serif"> string</span>
   (<span class=builtin>+</span> (<span style="font-family: sans-serif"> string</span>&rarr;<span style="font-family: sans-serif"> number</span> (<span class=variable>single-query</span> <span class=selfeval>&quot;Enter a number&quot;</span>))
      (<span style="font-family: sans-serif"> string</span>&rarr;<span style="font-family: sans-serif"> number</span> (<span class=variable>single-query</span> <span class=selfeval>&quot;Enter another number&quot;</span>)))))
</pre></div><p>
This expressions requests two numbers from a computer, one at a time. It
then displays the sum of the two numbers. </p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p> </p>
<p>
</p>
<p><a name="node_thm_1.1.1"></a>
<b>Exercise 1.1.1.</b>&nbsp;&nbsp; 
Develop <code class=scheme><span class=variable>request-number</span></code>. The function consumes a string and uses
the string to request a number from a consumer. It produces a number. Use
the function <code class=scheme><i>string</i>&rarr;<i>number0</i></code>, which consumes a string and
produces a number:
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><i> string</i>&rarr;<i> number0</i> <span class=selfeval>:</span> <span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=variable>Number</span></code></span>
<span class=comment>;; convert <code class=scheme><span class=variable>s</span></code> to a number, if possible, otherwise produce <code class=scheme><span class=selfeval>0</span></code></span>
(<span class=keyword>define</span> (<i> string</i>&rarr;<i> number0</i> <span class=variable>s</span>)
  (<span class=keyword>cond</span>
    [(<span class=builtin>number?</span> (<span style="font-family: sans-serif"> string</span>&rarr;<span style="font-family: sans-serif"> number</span> <span class=variable>s</span>)) (<span style="font-family: sans-serif"> string</span>&rarr;<span style="font-family: sans-serif"> number</span> <span class=variable>s</span>)]
    [<span class=keyword>else</span> <span class=selfeval>0</span>]))
</pre></div><p>
If <code class=scheme><span style="font-family: sans-serif">string</span>&rarr;<span style="font-family: sans-serif">number</span></code> produces a number, the result is that number;
otherwise, it is <code class=scheme><span class=selfeval>0</span></code>.</p>
<p>
Use the two functions to make the calculator conform with our program
design guidelines and to make it more
robust.&nbsp;<a href="../Solutions/servlet-number0.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.1.2"></a>
<b>Exercise 1.1.2.</b>&nbsp;&nbsp; 
Develop a function that converts the name of a foreign currency (&quot;peso&quot;
(MX), &quot;euro&quot; (EU), &quot;pound&quot; (UK), etc) into a conversion factor, i.e., a
fraction that converts US$100 into the foreign currency. </p>
<p>
Use the function to develop a currency conversion Web site. The Web site
converts amounts in one of the chosen currencies to US dollars. It
consists of three pages: a page that requests the name of a currency, a
page that requests an amount, and a page that displays the result of the
calculation.</p>
<p>
A good site should not only display the final result on the last page, but
also a confirmation of the inputs. Make the last page look like this:
</p>
<pre class=verbatim>  Converting 9800 euro into US dollars yields 10000.
</pre><p>
That is, in addition to the result, it should display the amount and the
name of the original currency. Hint: develop a function <code class=scheme><span class=variable>result</span></code>,
which consumes the inputs deals with them
appropriately.&nbsp;<a href="../Solutions/servlet-currency.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.1.3"></a>
<b>Exercise 1.1.3.</b>&nbsp;&nbsp; 
Develop <code class=scheme><span class=variable>calculate</span></code>. The function consumes a number, a string
(<code class=scheme><span class=variable>o</span></code>), and another number.  It attempts to interpret <code class=scheme><span class=variable>o</span></code> as
one of the arithmetic operations +, -, *, or / and, if possible, applies
the appropriate operation to the two numbers. The function also converts
the result of the operation to a string. If <code class=scheme><span class=variable>o</span></code> is not one of the
four arithmetic operations, the function produces an informative
string.&nbsp;<a href="../Solutions/servlet-calculator.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.1.4"></a>
<b>Exercise 1.1.4.</b>&nbsp;&nbsp; 
Develop the function <code class=scheme><span class=variable>range-query</span></code>. It consumes a pair of numbers,
<code class=scheme><span class=variable>low</span></code> and <code class=scheme><span class=variable>high</span></code>. Its purpose is to request a number in this
range from a consumer. If the submitted response is in the specified range,
the function prints the phrase &#8220;<code class=scheme><span class=variable>n</span></code> is okay.&#8221;; otherwise, it
prints the phrase &#8220;<code class=scheme><span class=variable>n</span></code> is not okay.&#8221; The result of
<code class=scheme><span class=variable>range-query</span></code> is <code class=scheme><span class=builtin>true</span></code>. [Note: Do not forget the design
recipes and the guidelines.]&nbsp;<a href="../Solutions/servlet-range.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>
<a name="node_sec_1.2"></a>
<h2 class=section>1.2&nbsp;&nbsp;Hidden Interactions</h2>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">6.1. Structures</a>
<br>
</p>
<p>
</p>

<p class=noindent>Web programs often need to restrict access to a Web site. For example, a
store may limit a purchasing page to registered users. To implement such
restrictions, Web programs ask consumers to identify themselves with a
username and a password. Naturally, passwords should not appear on the
screen as consumers type them. For that reason, Web browsers provide
special password text fields. A DrScheme Web program can use such
password-style text fields by applying <code class=scheme><span class=variable>single-query</span></code> to a
<code class=scheme><span class=variable>password</span></code> structure rather than a plain string. </p>
<p>
A <code class=scheme><span class=variable>password</span></code> structure consists of a single value. To construct a
<code class=scheme><span class=variable>password</span></code> structure, we apply <code class=scheme><span class=builtin>make-password</span></code> to a string: 
</p>
<div align=left><pre class=scheme>(<span class=builtin>make-password</span> <span class=selfeval>&quot;Your passphrase please:&quot;</span>)
</pre></div><p>
When the program supplies such a structure to <code class=scheme><span class=variable>single-query</span></code>, the
function posts the embedded string as a question and places it next to a
password text field. Hence, when the user types a response in this field,
nobody can see the actual characters. </p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_3"></a>
<div class=figure align=center><table width=100%><tr><td align=center><p>
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>check-password</span> <span class=selfeval>:</span> <span class=variable>String</span> <span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=variable>Boolean</span></code> </span>
<span class=comment>;; to make sure that the <code class=scheme><span class=variable>name</span></code> and the <code class=scheme><span class=variable>password</span></code> match </span>
(<span class=keyword>define</span> (<span class=variable>check-password</span> <span class=variable>name</span> <span class=variable>password</span>)
  (<span class=keyword>cond</span>
    ((<span class=builtin>string=?</span> <span class=selfeval>&quot;matthias&quot;</span> <span class=variable>name</span>) (<span class=builtin>string=?</span> <span class=selfeval>&quot;red&quot;</span> <span class=variable>password</span>))
    ((<span class=builtin>string=?</span> <span class=selfeval>&quot;matthew&quot;</span> <span class=variable>name</span>) (<span class=builtin>string=?</span> <span class=selfeval>&quot;green&quot;</span> <span class=variable>password</span>))
    ((<span class=builtin>string=?</span> <span class=selfeval>&quot;robby&quot;</span> <span class=variable>name</span>) (<span class=builtin>string=?</span> <span class=selfeval>&quot;blue&quot;</span> <span class=variable>password</span>))
    ((<span class=builtin>string=?</span> <span class=selfeval>&quot;shriram&quot;</span> <span class=variable>name</span>) (<span class=builtin>string=?</span> <span class=selfeval>&quot;pink&quot;</span> <span class=variable>password</span>))))

<span class=comment>;; <code class=scheme><span class=variable>response</span> <span class=selfeval>:</span> <span class=variable>String</span> <span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=builtin>true</span></code></span>
<span class=comment>;; to produce a response from a password check </span>
(<span class=keyword>define</span> (<span class=variable>response</span> <span class=variable>name</span> <span class=variable>password</span>)
  (<span class=keyword>cond</span>
    [(<span class=variable>check-password</span> <span class=variable>name</span> <span class=variable>password</span>)
     (<span class=variable>inform</span> <span class=selfeval>&quot;Login&quot;</span> <span class=selfeval>&quot;Welcome! You successfully logged in.&quot;</span>)]
    [<span class=keyword>else</span> 
     (<span class=variable>inform</span> <span class=selfeval>&quot;Login&quot;</span> <span class=selfeval>&quot;Sorry! Your name and password don't match.&quot;</span>)])) 

<span class=comment>;; run program run </span>
(<span class=variable>response</span> (<span class=variable>single-query</span> <span class=selfeval>&quot;Your name:&quot;</span>) (<span class=variable>single-query</span> <span class=selfeval>&quot;Your password:&quot;</span>))
</pre></div><p></p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 1:</b>&nbsp;&nbsp;A simple login program</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
Figure&nbsp;<a href="#node_fig_Temp_3">1</a> is a typical use of the <code class=scheme><span class=variable>password</span></code>
structure. The program first requests a user name and then a password. The
function <code class=scheme><span class=variable>response</span></code> checks that the two match and informs the
consumer of the result. </p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p> </p>
<p>
</p>
<p><a name="node_thm_1.2.1"></a>
<b>Exercise 1.2.1.</b>&nbsp;&nbsp; 
Modify the program in figure&nbsp;<a href="#node_fig_Temp_3">1</a> so that the successful
consumer is allowed to convert currencies. Use the functions from exercise
for the second part.&nbsp;<a href="#node_thm_1.1.2">1.1.2</a>.&nbsp;<a href="../Solutions/servlet-password.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.2.2"></a>
<b>Exercise 1.2.2.</b>&nbsp;&nbsp; 
Develop a Web site that registers new users. The site should ask for a
name, a password, and a confirmation of the password. If the two 
passwords are the same, the site confirms that the consumer is
registered. The confirmation should include the consumers chosen
username. If the two passwords differ, the site informs the consumer that
there is a mismatch.&nbsp;<a href="../Solutions/servlet-new-pw.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>
<a name="node_sec_1.3"></a>
<h2 class=section>1.3&nbsp;&nbsp;Typed Interactions</h2>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">7. The Varieties of Data</a>
<br>
</p>
<p>
</p>

<p class=noindent>Our first version of the calculator program in
section&nbsp;<a href="#node_sec_1.1">1.1</a> is seriously flawed. It provides the consumer with
a simple text field and then attempts to convert the string input to a
number. If the consumer submits a text that does not represent a number,
the program fails because <code class=scheme><span style="font-family: sans-serif">string</span>&rarr;<span style="font-family: sans-serif">number</span></code> produces <code class=scheme><span class=builtin>false</span></code>,
and <code class=scheme><span class=builtin>+</span></code> can only consume numbers. </p>
<p>
Since this situation recurs frequently, DrScheme supports a variety of ways
to query the consumer so that the results belong to a well-defined class
of data. More specifically, <code class=scheme><span class=variable>single-query</span></code> consumes not only
strings but queries. The class of queries is defined as follows: </p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">Query</span> is either
</p>
<ol>
<li><p><code class=scheme><span class=variable>String</span></code>
</p>
<li><p><code class=scheme>(<span class=builtin>make-password</span> <span class=variable>String</span>)</code>
</p>
<li><p><code class=scheme>(<span class=builtin>make-number</span> <span class=variable>String</span>)</code>
</p>
<li><p><code class=scheme>(<span class=builtin>make-boolean</span> <span class=variable>String</span>)</code>
</p>
<li><p><code class=scheme>(<span class=builtin>make-yes-no</span> <span class=variable>String</span> <span class=variable>String</span> <span class=variable>String</span>)</code>
</p>
</ol><p> 
 
</td></tr>
</table>
</blockquote>
</p>
<p>
The first three kinds of queries place questions next to text fields, but
<code class=scheme><span class=variable>single-query</span></code> ensures that these text fields have appropriate
properties. For a <code class=scheme><span class=variable>number</span></code> structure, for example, it insists that
the contents of the text field is a number when it is submitted.  Using a
<code class=scheme><span class=variable>boolean</span></code> structure, however, draws a check box next to the
question. If the consumer turns the check box on, <code class=scheme><span class=variable>single-query</span></code>&#8217;s
result is <code class=scheme><span class=builtin>true</span></code>; otherwise it is <code class=scheme><span class=builtin>false</span></code>. A <code class=scheme><span class=variable>yes-no</span></code>
structure poses a Yes-or-No-type question with two possible phrases as
responses. For example, a Web program may ask
</p>
<div align=left><pre class=scheme>(<span class=variable>single-query</span>
  (<span class=builtin>make-yes-no</span> 
    <span class=selfeval>&quot;Do you accept the agreement?&quot;</span> <span class=selfeval>&quot;I accept.&quot;</span> <span class=selfeval>&quot;I decline.&quot;</span>))
</pre></div><p>
The response is either <code class=scheme><span class=selfeval>&quot;I accept.&quot;</span></code> or <code class=scheme><span class=selfeval>&quot;I decline.&quot;</span></code> but
nothing else</p>
<p>
We can now exploit this richer class of queries to improve the calculator: 
</p>
<div align=left><pre class=scheme>(<span class=variable>inform</span>
 <span class=selfeval>&quot;Calculator Result&quot;</span>
 (<span style="font-family: sans-serif"> number</span>&rarr;<span style="font-family: sans-serif"> string</span>
   (<span class=builtin>+</span> (<span class=variable>single-query</span> (<span class=builtin>make-number</span> <span class=selfeval>&quot;Enter a number&quot;</span>))
      (<span class=variable>single-query</span> (<span class=builtin>make-number</span> <span class=selfeval>&quot;Enter another number&quot;</span>)))))
</pre></div><p>
Now both applications of <code class=scheme><span class=variable>single-query</span></code> produce a number, and it is
therefore no long necessary to convert their results.</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p> </p>
<p>
</p>
<p><a name="node_thm_1.3.1"></a>
<b>Exercise 1.3.1.</b>&nbsp;&nbsp; 
The function <code class=scheme><span class=variable>single-query</span></code> consumes a <code class=scheme><span class=variable>Query</span></code> and produces an
<code class=scheme><span class=variable>Response</span></code>. Develop a data definition for <code class=scheme><span class=variable>Response</span></code>. Then discuss
which query produces which response.&nbsp;<a href="../Solutions/servlet-answer.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.3.2"></a>
<b>Exercise 1.3.2.</b>&nbsp;&nbsp; 
Modify the solution of exercise&nbsp;<a href="#node_thm_1.1.2">1.1.2</a> so that it uses
the new kinds of queries where
appropriate.&nbsp;<a href="../Solutions/servlet-currency-typed.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.3.3"></a>
<b>Exercise 1.3.3.</b>&nbsp;&nbsp; 
Modify the solution of exercise&nbsp;<a href="#node_thm_1.1.3">1.1.3</a> so that it uses
the new kinds of queries where
appropriate.&nbsp;<a href="../Solutions/servlet-calculator-typed.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.3.4"></a>
<b>Exercise 1.3.4.</b>&nbsp;&nbsp; 
Develop a structure and data definition for a calendar date (year, month, day). 
Use numbers for each piece of information. </p>
<p>
Develop the function <code class=scheme><span class=variable>request-date</span></code>. It consumes <code class=scheme><span class=builtin>true</span></code> and
produces a calendar date, which it requests from a consumer via a
browser. Make sure that the submitted information is in the proper
range.&nbsp;<a href="../Solutions/servlet-date.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.3.5"></a>
<b>Exercise 1.3.5.</b>&nbsp;&nbsp; 
Develop <code class=scheme><span class=variable>pick-toppings</span></code>. The function consumes <code class=scheme><span class=builtin>true</span></code> and then
asks the consumer which of the following toppings should be put on a pizza:
anchovies, broccoli, or chestnuts. The result of the function is a
<code class=scheme><span class=variable>toppings</span></code> structure with three Boolean
fields.&nbsp;<a href="../Solutions/servlet-toppings-struct.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>
<a name="node_sec_1.4"></a>
<h2 class=section>1.4&nbsp;&nbsp;Radio Boxes and Interactions</h2>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">9. Compound Data, Part 2: Lists</a>
<br>
</p>
<p>
</p>

<p class=noindent>Consider the problem of finding out a consumer&#8217;s preference. Say, a
program needs to determined the preferred choice of color for some
product. Suppose the product comes in five colors: green, red, blue, white,
and black. The choices naturally make up a list, and the consumer should pick
exactly one of the items on the list.</p>
<p>
Using the current class of queries, solving this problem is a complicated
game. For that reason, Web browsers support a so-called radio check box in
addition to ordinary check box. Roughly speaking, a radio box is a multiple
choice question. It consists of a question and a list of mutually exclusive
responses. To accommodate this kind of interaction, we extend the
<code class=scheme><span class=variable>Query</span></code> class with an additional alternative: </p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">Query</span> is either 
</p>
<ol>
<li><p><tt>...</tt> 
</p>
<li><p><b>6.</b>&nbsp;&nbsp; <code class=scheme>(<span class=builtin>make-radio</span> <span class=variable>String</span> <span class=variable>List-of-string</span>)</code>
</p>
</ol><p></p>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">List-of-string</span> is either 
</p>
<ol>
<li><p><code class=scheme><span class=builtin>empty</span></code>, or 
</p>
<li><p><code class=scheme>(<span class=builtin>cons</span> <span class=variable>String</span> <span class=variable>List-of-string</span>)</code>
</p>
</ol><p></p>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>
Now, choosing a color is no longer a problem:
</p>
<div align=left><pre class=scheme>(<span class=variable>single-query</span> 
  (<span class=builtin>make-radio</span>
    <span class=selfeval>&quot;Please choose a color from the following list&quot;</span>
    (<span class=builtin>list</span> <span class=selfeval>&quot;green&quot;</span> <span class=selfeval>&quot;red&quot;</span> <span class=selfeval>&quot;blue&quot;</span> <span class=selfeval>&quot;white&quot;</span> <span class=selfeval>&quot;black&quot;</span>)))
</pre></div><p>
The result of this application is one of the five choices. </p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.4.1"></a>
<b>Exercise 1.4.1.</b>&nbsp;&nbsp; 
Develop a Web page that &#8220;sells&#8221; a product that comes in four
sizes.&nbsp;<a href="../Solutions/servlet-sell.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.4.2"></a>
<b>Exercise 1.4.2.</b>&nbsp;&nbsp; 
Develop the function <code class=scheme><span class=variable>request-grade</span></code>, which consumes a list of grades and
produces one of them, via a Web interaction with a
teacher.&nbsp;<a href="../Solutions/servlet-grades.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.4.3"></a>
<b>Exercise 1.4.3.</b>&nbsp;&nbsp; 
Develop a variant of <code class=scheme><span class=variable>request-date</span></code> (see exercise&nbsp;<a href="#node_thm_1.3.4">1.3.4</a>)
using <code class=scheme><span class=variable>radio</span></code> structures instead of (numeric) text fields so that
consumers can&#8217;t make silly input mistakes.&nbsp;<a href="../Solutions/servlet-date-again.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.4.4"></a>
<b>Exercise 1.4.4.</b>&nbsp;&nbsp; 
Use the function <code class=scheme><span class=variable>request-date</span></code> from
exercise&nbsp;<a href="#node_thm_1.4.3">1.4.3</a> to develop a &#8220;suspend and resume&#8221;
service for your favorite newspaper. The purpose of the service is to
enable subscribers to suspend the delivery of their newspaper for a
vacation. The service should interact with consumers as follows:
</p>
<ol>
<li><p>log in (provide name, subscription number); and 
</p>
<li><p>choose a date for suspending the newspaper delivery; and 
</p>
<li><p>choose a date for resuming delivery; and 
</p>
<li><p>print page with a summary of the information.
</p>
</ol><p>
Make sure the dates are ordered properly and inform the consumer of
mistakes.&nbsp;<a href="../Solutions/servlet-suspend.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.4.5"></a>
<b>Exercise 1.4.5.</b>&nbsp;&nbsp; 
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">10.1 Functions that Produce Lists</a></p>
<p>
Develop a Web site for evaluating teachers. The underlying Web program should
consume a list of questions (strings), pose each question, and produce a list
of grades. Use the numbers 1 through 4 as grades.&nbsp;<a href="../Solutions/servlet-evals.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.4.6"></a>
<b>Exercise 1.4.6.</b>&nbsp;&nbsp; 
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">10.2 Lists that Contains Structures</a></p>
<p>
Develop the function <code class=scheme><span class=variable>play</span></code>, which plays an on-line version of the
game show &#8220;Who Wants To Be A Millionaire?&#8221; with a consumer. The function
consumes a list of questions and produces <code class=scheme><span class=builtin>true</span></code>. Each question
comes with a correct answer and a list of possible answers; the correct
answer is an item on this list. The program poses each question and its
possible answers. As long as the consumer chooses the correct answer, the
game continues. When the consumer submits an incorrect answer, the program
terminates and the player loses. When there are no more questions, the
player has won.</p>
<p>
Hint: Develop <code class=scheme><span class=variable>ask-all-questions</span></code>. This auxiliary function consumes
a list of questions (and their associated answers), asks all questions,
and produces a Boolean value. Specifically, if all answers are correct,
the function produces <code class=scheme><span class=builtin>true</span></code>, otherwise <code class=scheme><span class=builtin>false</span></code>. Test
<code class=scheme><span class=variable>ask-all-questions</span></code> with a simplistic definition for a function
that asks a single question.</p>
<p>
Challenge: Use the navigation capabilities of your favorite Web browser to
<em>win</em> a game with three questions, each with two answers without
ever re-starting the game program.&nbsp;<a href="../Solutions/servlet-millionaire.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>
<a name="node_sec_1.5"></a>
<h2 class=section>1.5&nbsp;&nbsp;Forms and Interactions</h2>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">10. Lists that Contains Structures</a></p>
<p>
</p>

<p class=noindent>Consumers do not like to wait for Web pages. Hence, Web programs
should send as few pages as necessary and not more. Now that we know lists, it
is natural to say that a program should send an entire list of
queries. Although this idea is natural, it also has a serious flaw. To
understand this flaw, consider what the browser should send back to the
program when given a list of queries. Since the consumer must provide an
response to each and every one, the browser should send a list of responses. This
raises the question of how to identify a browser&#8217;s response for a specific
question. Clearly, we could use the position of the original question to find
the response to the question.  Experience shows, however, that this procedure is
cumbersome and error-prone. Instead we follow an old Lisp tradition and
associate symbols with queries and responses.</p>
<p>
DrScheme&#8217;s general mechanism for conducting Web dialog&#8217;s with consumers is
based on forms: </p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">Form</span> is either 
</p>
<ol>
<li><p><code class=scheme><span class=builtin>empty</span></code>, or 
</p>
<li><p><code class=scheme>(<span class=builtin>cons</span> <span class=variable>Form-item</span> <span class=variable>Form</span>)</code>
</p>
</ol><p></p>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">Form-item</span> is a list with two items: <br>
</p>
<div align=center>&nbsp;<code class=scheme>(<span class=builtin>cons</span> <span class=variable>Symbol</span> (<span class=builtin>cons</span> <span class=variable>Query</span> <span class=builtin>empty</span>))</code>.&nbsp;</div>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>
</p>

<p class=noindent>A Web program can send a form to the consumer via an additional
function: 
</p>
<div align=left><pre class=scheme> <span class=comment>;; <code class=scheme><span class=variable>form-query</span> <span class=selfeval>:</span> <span class=variable>Form</span> &nbsp;&rarr;&nbsp; <span class=variable>Table</span></code></span>
</pre></div><p>
The response that the function produces is also a list and contains as many
items as the form that it sent. Here is the data definition: </p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">Table</span> is either 
</p>
<ol>
<li><p><code class=scheme><span class=builtin>empty</span></code>, or 
</p>
<li><p><code class=scheme>(<span class=builtin>cons</span> <span class=variable>Table-item</span> <span class=variable>Table</span>)</code>
</p>
</ol><p></p>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">Table-item</span> is a list with two items: <br>
</p>
<div align=center>&nbsp;<code class=scheme>(<span class=builtin>cons</span> <span class=variable>Symbol</span> (<span class=builtin>cons</span> <span class=variable>Response</span> <span class=builtin>empty</span>))</code>.&nbsp;</div>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>
</p>

<p class=noindent>As before, a response is either a string, a number, or a boolean,
though as discussed, each kind of query produces a specific kind of response. </p>
<p>
Take a look at this example:
</p>
<div align=left><pre class=scheme>(<span class=variable>form-query</span> 
  (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=builtin>first</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;first name&quot;</span> <span class=builtin>empty</span>))
    (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>last</span> (<span class=builtin>cons</span>  <span class=selfeval>&quot;last name&quot;</span> <span class=builtin>empty</span>))
      (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>yob</span> (<span class=builtin>cons</span> (<span class=builtin>make-number</span> <span class=selfeval>&quot;year of birth&quot;</span>) <span class=builtin>empty</span>))
	<span class=builtin>empty</span>))))
</pre></div><p>
This query requests three pieces of information with a single Web page: a
consumer&#8217;s first name, last name, and year of birth. The result is a
structure such as this one: 
</p>
<div align=left><pre class=scheme>(<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=builtin>first</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;matthias&quot;</span> <span class=builtin>empty</span>))
  (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>last</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;krishnamurthi&quot;</span> <span class=builtin>empty</span>))
    (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>yob</span> (<span class=builtin>cons</span> <span class=selfeval>1914</span> <span class=builtin>empty</span>))
      <span class=builtin>empty</span>)))
</pre></div><p>
That is, the result is also a list of three items: two strings and a
number, each tagged with a symbol. </p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_4"></a>
<div class=figure align=center><table width=100%><tr><td align=center><div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>String</span> &nbsp;&rarr;&nbsp; (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>likes</span> <span class=variable>Query</span>)</code></span>
(<span class=keyword>define</span> (<span class=variable>likes</span> <span class=variable>lang</span>)
  (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>likes</span> (<span class=builtin>make-boolean</span> (<span class=builtin>string-append</span> <span class=selfeval>&quot;Do you like &quot;</span> <span class=variable>lang</span> <span class=selfeval>&quot; ?&quot;</span>))))

<span class=comment>;; <code class=scheme><span class=variable>Form</span></code></span>
(<span class=keyword>define</span> <span class=variable>language-query</span>
  (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>name</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;Name:&quot;</span> <span class=builtin>empty</span>))
        (<span class=builtin>cons</span> (<span class=variable>likes</span> <span class=selfeval>&quot;Scheme&quot;</span>) 
	  (<span class=builtin>cons</span> (<span class=variable>likes</span> <span class=selfeval>&quot;Java&quot;</span>)
	    (<span class=builtin>cons</span> (<span class=variable>likes</span> <span class=selfeval>&quot;C++&quot;</span>)
	      <span class=builtin>empty</span>)))))

<span class=comment>;; <code class=scheme><span class=variable>likes-how-many</span> <span class=selfeval>:</span> <span class=variable>Table</span> &nbsp;&rarr;&nbsp; <span class=variable>Number</span></code></span>
<span class=comment>;; to count how many times the tag <code class=scheme><span class=keyword>'</span><span class=variable>likes</span></code> is associated with <code class=scheme><span class=builtin>true</span></code></span>
(<span class=keyword>define</span> (<span class=variable>likes-how-many</span> <span class=variable>a-table</span>) ...)

<span class=comment>;; run program run: </span>
(<span class=variable>inform</span> <span class=selfeval>&quot;Okay, so you like &quot;</span>
        (<span style="font-family: sans-serif"> number</span>&rarr;<span style="font-family: sans-serif"> string</span> (<span class=variable>likes-how-many</span> (<span class=variable>form-query</span> <span class=variable>language-query</span>)))
        <span class=selfeval>&quot; languages.&quot;</span>)
</pre></div><p></p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 2:</b>&nbsp;&nbsp;</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
The tags in a <code class=scheme><span class=variable>Form</span></code> don&#8217;t have to be unique. For example, the
program fragment in figure&nbsp;<a href="#node_fig_Temp_4">2</a> asks four questions,
three of them labeled <code class=scheme><span class=keyword>'</span><span class=variable>likes</span></code>. It counts how many of those the
consumer checked and confirms the tally.</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.5.1"></a>
<b>Exercise 1.5.1.</b>&nbsp;&nbsp; 
Develop the function <code class=scheme><span class=variable>likes-how-many</span></code>, which consumes a
<code class=scheme><span class=variable>Table</span></code> and counts how many times the tag <code class=scheme><span class=keyword>'</span><span class=variable>likes</span></code> is
associated with <code class=scheme><span class=builtin>true</span></code> in the table. Use the function to complete
the program in figure&nbsp;<a href="#node_fig_Temp_4">2</a>.&nbsp;<a href="../Solutions/servlet-stuff.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.5.2"></a>
<b>Exercise 1.5.2.</b>&nbsp;&nbsp; 
Develop the function <code class=scheme><span class=variable>choose-toppings</span></code>. It consumes a list of strings
(pizza toppings) and presents all of them as boolean queries on a single Web
page. If produces the list of all checked choices.&nbsp;<a href="../Solutions/servlet-toppings.html">Solution</a></p>
<p> </p>
<p>
</p>
<p><a name="node_thm_1.5.3"></a>
<b>Exercise 1.5.3.</b>&nbsp;&nbsp; 
Develop <code class=scheme><span class=variable>extract1</span></code>. The function consumes a symbol (<code class=scheme><span class=variable>s</span></code>) and
a table (<code class=scheme><span class=variable>t</span></code>). It extracts the list of all <code class=scheme><span class=variable>Table-items</span></code>
whose tag is <code class=scheme><span class=variable>s</span></code>.</p>
<p>
Develop <code class=scheme><span class=variable>extract2</span></code>. The function consumes a symbol (<code class=scheme><span class=variable>s</span></code>) and
a table (<code class=scheme><span class=variable>t</span></code>). It extracts the single value in <code class=scheme><span class=variable>t</span></code> whose tag
is <code class=scheme><span class=variable>s</span></code>. If there is more than one such item or none, the function
signals an error. Hint: Use <code class=scheme><span class=variable>extract1</span></code> and develop an auxiliary
function that extracts a single item from a list of answers, if the list
contains a single answer.&nbsp;<a href="../Solutions/servlet-extract.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
The teachpack <tt>servlets2.ss</tt> provides two functions for extracting
items from a <code class=scheme><span class=variable>Table</span></code>. The first one, <code class=scheme><span class=variable>extract/single</span></code>, finds
the response that is associated with a unique tag; it raises an exception
if the table contains no response or more than one response labeled with
the given tag. The second one, <code class=scheme><span class=variable>extract</span></code>, finds all the responses
associated with a given tag. If there aren&#8217;t any, it produces
<code class=scheme><span class=builtin>empty</span></code>.  Using <code class=scheme><span class=variable>extract</span></code>, we can define the function
<code class=scheme><span class=variable>likes-how-many</span></code> as a one-liner:
</p>
<div align=left><pre class=scheme>(<span class=keyword>define</span> (<span class=variable>likes-how-many</span> <span class=variable>alor</span>)
  (<span class=builtin>length</span> (<span class=variable>extract</span> <span class=keyword>'</span><span class=variable>likes</span> <span class=variable>alor</span>)))
</pre></div><p>
The function <code class=scheme><span class=variable>extract/single</span></code> is useful when we need to extract
unique pieces of information. </p>
<p>
</p>
<p>
</p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_5"></a>
<div class=figure align=center><table width=100%><tr><td align=center><div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>basic-info</span> <span class=selfeval>:</span> <span class=builtin>true</span> &nbsp;&rarr;&nbsp; <span class=variable>Table</span></code></span>
<span class=comment>;; request basic info from participant</span>
(<span class=keyword>define</span> (<span class=variable>basic-info</span> <span class=variable>go</span>)
  (<span class=variable>form-query</span> <span class=variable>INFO-PAGE</span>))

<span class=comment>;; <code class=scheme><span class=variable>Form</span></code></span>
(<span class=keyword>define</span> <span class=variable>INFO-PAGE</span>
  (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=builtin>first</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;First Name&quot;</span> <span class=builtin>empty</span>))
        (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>last</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;Last Name:&quot;</span> <span class=builtin>empty</span>))
	      (<span class=builtin>cons</span> (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>email</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;Email address:&quot;</span> <span class=builtin>empty</span>))
		    <span class=builtin>empty</span>))))

<span class=comment>;; <code class=scheme><span class=variable>determine-choices</span> <span class=selfeval>:</span> <span class=variable>Table</span> &nbsp;&rarr;&nbsp; <span class=variable>Table</span></code></span>
<span class=comment>;; dispatch to additional page per choice, append all choices made</span>
(<span class=keyword>define</span> (<span class=variable>determine-choices</span> <span class=variable>contact-info</span>)
  (<span class=variable>refine-choices</span> <span class=variable>contact-info</span> (<span class=variable>form-query</span> <span class=variable>CHOICE-PAGE</span>)))

<span class=comment>;; <code class=scheme><span class=variable>List-of-strings</span></code> [list of locations]</span>
(<span class=keyword>define</span> <span class=variable>LOCs</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;Atlanta&quot;</span> ...))

<span class=comment>;; <code class=scheme><span class=variable>Form</span>[<span class=builtin>first</span><span class=keyword>,</span><span class=builtin>second</span><span class=keyword>,</span><span class=variable>housing</span>]</code></span>
(<span class=keyword>define</span> <span class=variable>CHOICE-PAGE</span> 
  (<span class=builtin>cons</span>
   (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>loc</span> (<span class=builtin>cons</span> (<span class=builtin>make-radio</span> <span class=selfeval>&quot;first choice of location&quot;</span> <span class=variable>LOCs</span>) <span class=builtin>empty</span>))
   (<span class=builtin>cons</span>
    (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>loc</span> (<span class=builtin>cons</span> (<span class=builtin>make-radio</span> <span class=selfeval>&quot;second choice of location&quot;</span> <span class=variable>LOCs</span>) <span class=builtin>empty</span>))
    (<span class=builtin>cons</span>
     (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>housing</span> (<span class=builtin>cons</span> (<span class=builtin>make-boolean</span> <span class=selfeval>&quot;Do you need housing?&quot;</span>) <span class=builtin>empty</span>))
     <span class=builtin>empty</span>))))

<span class=comment>;; <code class=scheme><span class=variable>refine-choices</span> <span class=selfeval>:</span> <span class=variable>Table</span> <span class=variable>Table</span> &nbsp;&rarr;&nbsp; <span class=variable>Table</span></code></span>
(<span class=keyword>define</span> (<span class=variable>refine-choices</span> <span class=variable>t1</span> <span class=variable>t2</span>)
  (<span class=builtin>append</span> <span class=variable>t1</span> (<span class=variable>extract1</span> <span class=keyword>'</span><span class=variable>loc</span> <span class=variable>t2</span>) (<span class=variable>refine-housing</span> (<span class=variable>extract/single</span> <span class=keyword>'</span><span class=variable>housing</span> <span class=variable>t2</span>))))

<span class=comment>;; <code class=scheme><span class=variable>refine-housing</span> <span class=selfeval>:</span> <span class=variable>Boolean</span> &nbsp;&rarr;&nbsp; <span class=variable>Table</span></code></span>
(<span class=keyword>define</span> (<span class=variable>refine-housing</span> <span class=variable>housing?</span>) ...)

<span class=comment>;; <code class=scheme><span class=variable>confirm-info+choices</span> <span class=selfeval>:</span> <span class=variable>Table</span> &nbsp;&rarr;&nbsp; <span class=builtin>true</span></code></span>
(<span class=keyword>define</span> (<span class=variable>confirm-info+choices</span> <span class=variable>t</span>)
  (<span class=variable>inform</span> <span class=selfeval>&quot;Confirmation&quot;</span> ... (<span class=variable>extract/single</span> <span class=keyword>'</span><i> first</i> <span class=variable>t</span>) ...))
</pre></div><p></p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 3:</b>&nbsp;&nbsp;A workshop registration site</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
Forms and tables greatly facilitate the development of serious Web
dialogs. Consider a dialog for registering participants for summer
workshops on designing programs. It is important for the workshop manager
to obtain some basic information from all the participants and to
determine some additional information. </p>
<p>
Let&#8217;s be more concrete:
</p>
<ol>
<li><p>The Web program should gather basic information such as first name,
last name, and an email address. </p>
<p>
</p>
<li><p>Next the program should ask the participant which workshop he wishes
to attend. Workshops take place in Atlanta, Boston, Chicago, New York
City, Providence, and Salt Lake City. Each participant may sign up
for a first and a second choice.  Also, the manager needs to know whether
the participant wishes to use on-campus housing and, if so, what kind.
</p>
</ol><p> 
Finally, the program should summarize the chosen options and ask for a final
commitment from the participant. </p>
<p>
The explanation suggests that this particular dialog consists of a
collection of questions that can be arranged in a chain with
subchains. One natural translation of the chain into a program is a
composition of functions that correspond to each stage. Each function in
turn may consist of additional function compositions:
</p>
<div align=left><pre class=scheme>(<span class=variable>confirm-info+choices</span> (<span class=variable>determine-choices</span> (<span class=variable>basic-info</span> <span class=builtin>true</span>)))
</pre></div><p>
This sample expression first collects basic information, determines what
other information it should collect, and finally requests a confirmation.</p>
<p>
Using a function composition raises a question concerning the flow of data
among the functions. For a dialog such as this one, we can think of the
data as a record of information about the participant. At each stage, we
learn more and the record grows as it flows through the functions. Since
<code class=scheme><span class=variable>form-query</span></code> produces <code class=scheme><span class=variable>Table</span></code>s and since a <code class=scheme><span class=variable>Table</span></code> is
a convenient representation for an ever-growing record, it is natural to
use <code class=scheme><span class=variable>Table</span></code> as the class of values.</p>
<p>
Figure&nbsp;<a href="#node_fig_Temp_5">3</a> shows the code. The contracts for
<code class=scheme><span class=variable>basic-info</span></code>, <code class=scheme><span class=variable>determine-choices</span></code>, and
<code class=scheme><span class=variable>confirm-info+choices</span></code> reflect the preceding discussion. The domain
of <code class=scheme><span class=variable>basic-info</span></code> is <code class=scheme><span class=builtin>true</span></code>, because it simply waits for a
signal from the browser that the potential participant has entered the
site. For symmetry, the range of <code class=scheme><span class=variable>confirm-info+choices</span></code> is
<code class=scheme><span class=builtin>true</span></code>, because the result is simply a signal that the dialog has
terminated properly.</p>
<p>
For a first instructive example, take a look at <code class=scheme><span class=variable>basic-info</span></code> in
figure&nbsp;<a href="#node_fig_Temp_5">3</a>. The function comes with an auxiliary <code class=scheme><span class=variable>Form</span></code>
definition that specifies the form with which it gathers the necessary
information.  A second interesting example is <code class=scheme><span class=variable>refine-choices</span></code>. It
appends three tables: <code class=scheme><span class=variable>t1</span></code>, which contains the basic information;
<code class=scheme>(<span class=variable>extract</span> <span class=keyword>'</span><span class=variable>loc</span> <span class=variable>t2</span>)</code>, which is the subset of the table concerning housing
(see exercise&nbsp;<a href="#node_thm_1.5.3">1.5.3</a>); and the table that
<code class=scheme><span class=variable>refine-housing</span></code> builds.</p>
<p>
The contract for <code class=scheme><span class=variable>refine-housing</span></code> suggests which task the function
performs. It consumes a boolean that specifies whether or not a
participants needs housing. If so, the function builds a table with
another query to the participant: 
</p>
<div align=left><pre class=scheme>(<span class=keyword>define</span> (<span class=variable>refine-housing</span> <span class=variable>housing?</span>)
  (<span class=keyword>cond</span>
    [<span class=variable>housing?</span>
      (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>housing-type</span> 
	    (<span class=builtin>cons</span> (<span class=variable>single-query</span> 
		    (<span class=builtin>make-yes-no</span>
		      <span class=selfeval>&quot;What kind of housing do you need?&quot;</span>
		      <span class=selfeval>&quot;Single&quot;</span>
		      <span class=selfeval>&quot;Double&quot;</span>))
	           <span class=builtin>empty</span>))]
    [<span class=keyword>else</span>
      (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>housing-type</span> (<span class=builtin>cons</span> <span class=selfeval>&quot;none&quot;</span> <span class=builtin>empty</span>))]))
</pre></div><p>
If not, the function produces a default table without sending another
query to the participant. In short, auxiliary functions not only match the
program to the tasks at hand, they also make dialogs naturally more
efficient for a consumer. </p>
<p>
</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.5.4"></a>
<b>Exercise 1.5.4.</b>&nbsp;&nbsp; 
Complete the workshop sign-up program.</p>
<p>
Modify the workshop program so that it can request better information about the
housing request. Specifically, if the participant chooses a double room, the
manager needs to know whether the second space is for a spouse, whether it is
for a known partner, or whether the participant wishes to be paired with
another person.&nbsp;<a href="../Solutions/servlet-workshop.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.5.5"></a>
<b>Exercise 1.5.5.</b>&nbsp;&nbsp; 
Revise the suspend-and-resume program from exercise&nbsp;<a href="#node_thm_1.4.4">1.4.4</a> so
that it uses <code class=scheme><span class=variable>Form</span></code>s and
<code class=scheme><span class=variable>Table</span></code>s.&nbsp;<a href="../Solutions/servlet-suspend-again.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.5.6"></a>
<b>Exercise 1.5.6.</b>&nbsp;&nbsp; 
Revise the teacher-evaluation program so that it groups related questions on a
single page.&nbsp;<a href="../Solutions/servlet-evals-again.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_1.5.7"></a>
<b>Exercise 1.5.7.</b>&nbsp;&nbsp; 
Develop a pizza ordering site where customers in a store&#8217;s database can login
and order a pizza. The dialog provides the following four stages:
</p>
<ol>   
<li><p>the login stage requests a customer name and also asks whether
delivery is desired;</p>
<p>
</p>
<li><p>the pizza specification stage determines the pizza that the consumer
would like; here are the options: 
</p>
<dl><dt></dt><dd>      
</dd><dt><b>kind</b></dt><dd> chicago, new york, california, hawaii;
</dd><dt><b>size</b></dt><dd> small, medium, large, texas;
</dd><dt><b>toppings</b></dt><dd> eggplant, banana, broccoli, anchovies, eggs.
</dd></dl><p></p>
<p>
</p>
<li><p>if the consumer chose the delivery option during login, the third
optional stage requests delivery information now; we assume that we only
need the street address and the zip code (5 digits, i.e., numbers);</p>
<p>
</p>
<li><p>the confirmation stage prints a summary of all information, including
the cost of the pizza; once the consumer proceeds, the pizza is ordered
and the servlet terminates. </p>
<p>
The cost of a pizza is determined as follows. The kind determines the base
cost; a Chicago style pizza is 6.95, all others are 5.95.  The size adds
some cost: for a medium add $1, for a large $5, and for a &#8220;texas&#8221; add
$7.  Finally, the first topping is free, the others cost $.50 per
topping. The money is due upon pickup or
delivery.
</p>
</ol><p>
The program should produce a <code class=scheme><span class=variable>Table</span></code> with the customer name, the
pizza specification, and information about the delivery. Do not worry
about things that can go wrong.&nbsp;<a href="../Solutions/servlet-pizza-big.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p> </p>
<p>
</p>
<a name="node_sec_2"></a>
<h1 class=section>2&nbsp;&nbsp;List Abbreviations</h1>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">Intermezzo 2: List Abbreviations</a>
<br>
</p>
<p>
</p>

<p class=noindent>Use the above exercises and examples to motivate abbreviations
for forming lists. Especially <code class=scheme><span class=builtin>list</span></code> is useful in this context.</p>
<p>
</p>
<a name="node_sec_3"></a>
<h1 class=section>3&nbsp;&nbsp;Web Pages in Scheme</h1>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.html">Intermezzo 2: List Abbreviations</a>
<br>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">14.3 Lists in Lists</a>
<br>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node??.htm">15. Mutually Referential Data Definitions</a>
<br>
</p>
<p>
</p>

<p class=noindent>The design of sophisticated Web programs requires more
familiarity the design of Web pages and Web forms than the first section
assumes. Such Web programs produce Web pages with interesting layouts,
mixing information with query elements in complex ways. On some occasions,
Web programs even consume Web pages or information that looks like a Web
page.  In this section, we discuss the basics of Web page formatting,
representing Web pages in DrScheme, and Web page elements for querying
consumers.</p>
<p>
</p>
<a name="node_sec_3.1"></a>
<h2 class=section>3.1&nbsp;&nbsp;XHTML</h2>
<p>The language of the Web is XHTML.<a name="node_call_footnote_Temp_6"></a><sup><small><a href="#node_footnote_Temp_6">1</a></small></sup>  It
consists of words and instructions for rendering the words. One of the
most well-known instructions is to turn some words into a link to another
Web page. This instruction connects pages in the fashion of a spider
web. Other instructions render a group of words as a paragraph, as an
unsorted list, or as a table.</p>
<p>
Roughly speaking, an XHTML expression is a fully parenthesized form of
data. The major visual difference between an XHTML expression and an
S-expression is that there are many forms of &#8220;parentheses&#8221; in XHTML, not
just Scheme&#8217;s parentheses, brackets, and braces. XHTML&#8217;s parentheses are
made up of words, called tags. For example, a simple XHTML Web page looks
like this: 
</p>
<pre class=verbatim>&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;My first Web page&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
  &lt;h1&gt;My first Web page&lt;/h1&gt;
  &lt;p&gt;Hello World.&lt;/p&gt;
 &lt;/body&gt;
&lt;/html&gt;
</pre><p> 
The tokens <code class=verbatim>&lt;html&gt;</code> and <code class=verbatim>&lt;/html&gt;</code> are called the <span style="font-style: oblique">start
tag</span> and the <span style="font-style: oblique">end tag</span>. We think of them as parentheses. </p>
<p>
Here is the meaning of some of the most basic tags in XHTML: 
</p>
<div align=center><table><tr><td>

<table border=0><tr><td valign=top ><strong>tag</strong>  </td><td valign=top ><strong>meaning</strong> </td></tr>
<tr><td valign=top ><tt>html</tt> </td><td valign=top >brackets a Web page </td></tr>
<tr><td valign=top ><tt>head</tt> </td><td valign=top >the head section, mostly invisible specifications</td></tr>
<tr><td valign=top ><tt>title</tt></td><td valign=top >the words in the title bar of the browser window</td></tr>
<tr><td valign=top ><tt>body</tt> </td><td valign=top >the body section, the actual page</td></tr>
<tr><td valign=top ><tt>h1</tt>   </td><td valign=top >large font for titles (test <tt>h2</tt>, <tt>h3</tt>, etc)</td></tr>
<tr><td valign=top ><tt>p</tt>    </td><td valign=top >a paragraph</td></tr>
<tr><td valign=top ><tt>em</tt>   </td><td valign=top >emphasis
</td></tr></table>
</td></tr></table></div>

In addition to these tags, it is important to know about <tt>a</tt> and <tt>img</tt> tags as well as attributes. <p>
Most tag come with attributes. Typographically, an attribute looks like an
equation in the start tag. For example, the body of a Web page may include a
specification for a background color: 
</p>
<pre class=verbatim> &lt;body bgcolor=&quot;#e5e5e5&quot;&gt;A page with color&lt;/body&gt;
</pre><p>
The name of the attribute is <tt>bgcolor</tt>; the value is <tt>&quot;e5e5e5&quot;</tt>.
All attribute values are specified as strings. To achieve a good visual
effect, it is important to study what the valid attributes and their
values of XHTML elements are. </p>
<p>
Two tags that always come with attributes are <tt>a</tt> and <tt>img</tt>. With
the former, we can specify a link in a Web page. For example, if we place 
</p>
<pre class=verbatim> &lt;a href=&quot;http://www.htdp.org/&quot;&gt;
  How to Design Programs (on-line)
 &lt;/a&gt;
</pre><p>
we create a link to the on-line version of &#8220;How to Design Programs&#8221; in a
Web page. The <tt>href</tt> attribute specifies the address to which we link
and the words between the tags specify how the link appears on a
page. Similarly, this line 
</p>
<pre class=verbatim> &lt;img src=&quot;http://www.htdp.org/htdp.gif&quot; 
      alt=&quot;a picture&quot;&gt;
 &lt;/img&gt;
</pre><p>
places the image from <tt>http://www.htdp.org/htdp.gif</tt> inside of a Web
page. The <tt>src</tt> attribute says where the image is located, and the
<tt>alt</tt> attribute specifies what to replace the image with in case the
Web browser can&#8217;t look it up. </p>
<p>
</p>
<p>
</p>
<p>


</p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_7"></a>
<div class=figure align=center><table width=100%><tr><td align=center><div class=smallskip></div>
<p style="margin-top: 0pt; margin-bottom: 0pt">
</p>
<div align=center>&nbsp;<img src="servlets-Z-G-1.gif" border="0" alt="[servlets-Z-G-1.gif]">&nbsp;</div>
</td></tr>
<tr><td align=center><b>Figure 4:</b>&nbsp;&nbsp;XHTML in DrScheme</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
</p>
<p>
XHTML tables play a central role in the design of Web forms. A table
consists of rows; a row consists of cells. Here are the subset of the tags
that matter in this context: 
</p>
<div align=center><table><tr><td>

<table border=0><tr><td valign=top ><strong>table tag</strong> </td><td valign=top ><strong>meaning</strong></td></tr>
<tr><td valign=top ><tt>table</tt> </td><td valign=top >a table </td></tr>
<tr><td valign=top ><tt>tr</tt>    </td><td valign=top >a row </td></tr>
<tr><td valign=top ><tt>th</tt>    </td><td valign=top >a title cell in a row </td></tr>
<tr><td valign=top ><tt>td</tt>    </td><td valign=top >a cell in a row
</td></tr></table>
</td></tr></table></div>

Each of these tags comes with a number of attributes (concerning
alignment, spacing, coloring, etc). <p>
Consider the following XHTML specification: 
</p>
<pre class=verbatim>&lt;table&gt;
 &lt;tr&gt;&lt;th&gt;table tag&lt;/th&gt; &lt;th&gt;meaning&lt;/th&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;table&lt;/td&gt;     &lt;td&gt;a table&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;tr&lt;/td&gt;        &lt;td&gt;a row&lt;/td&gt;&lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;th&lt;/td&gt;        &lt;td&gt;a title cell in a row&lt;/td&gt;
     &lt;/tr&gt;
 &lt;tr&gt;&lt;td&gt;td&lt;/td&gt;        &lt;td&gt;a cell in a row&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;
</pre><p>
This XHTML specification produces a table in a Web browser that is similar
to the one above that specifies the meaning of table tags.</p>
<p>
DrScheme supports XHTML with a special editing feature, called an XML box.
An XML box is inserted with the <tt>Special | Insert XML Box</tt>
menu. Inside the box, DrScheme auto-completes XHTML the end tags and
inserts tabs in an XHTML appropriate fashion. Figure&nbsp;<a href="#node_fig_Temp_7">4</a>
illustrates the idea with a simple example. As the figure shows, a box can
appear wherever a Scheme expression appears. Naturally, this means that
such boxes <em>are</em> Scheme expressions and evaluate to Scheme
values. The &#8220;why&#8221; and &#8220;how&#8221; of this connection is the subject of the
next section.</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.1.1"></a>
<b>Exercise 3.1.1.</b>&nbsp;&nbsp; 
Specify an XHTML page that contains a title, a link to a page made by your
teacher, and a picture.&nbsp;<a href="../Solutions/servlet-page.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.1.2"></a>
<b>Exercise 3.1.2.</b>&nbsp;&nbsp; 
Specify an XHTML table with three rows of two cells each. Each right cell
should contain a picture of one of your friends, and the left cell the
friend&#8217;s name.&nbsp;<a href="../Solutions/servlet-table.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>
<a name="node_sec_3.2"></a>
<h2 class=section>3.2&nbsp;&nbsp;XHTML in Scheme</h2>
<p>Effective Web programming requires a tight integration of XHTML into Scheme
and vice versa. A program must be able to specify patterns of Web pages,
produce portions of Web pages, and glue together pieces of a Web page to
form a whole. The best way to achieve this integration is to represent
XHTML (a new form of information) as Scheme data. </p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_8"></a>
<div class=figure align=center><table width=100%><tr><td align=center><p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

An <span style="font-style: oblique">X-exp</span> is one of: 
</p>
<ol>
<li><p><code class=scheme><span class=variable>String</span></code>
</p>
<li><p><code class=scheme>(<span class=builtin>cons</span> <span class=variable>Symbol</span> (<span class=builtin>cons</span> <span class=variable>Attributes</span> <span class=variable>List-of-X</span>)))</code>
</p>
</ol><p></p>
<p>
</p>
<div class=bigskip></div>
<p style="margin-top: 0pt; margin-bottom: 0pt">
</p>
<p>
An <span style="font-style: oblique">List-of-X</span> is either 
</p>
<ol>
<li><p><code class=scheme><span class=builtin>empty</span></code>
</p>
<li><p><code class=scheme>(<span class=builtin>cons</span> <span class=variable>X-exp</span> <span class=variable>List-of-X</span>)</code>
</p>
</ol><p></p>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">List-of-Attributes</span> is either 
</p>
<ol>
<li><p><code class=scheme><span class=builtin>empty</span></code>
</p>
<li><p><code class=scheme>(<span class=builtin>cons</span> <span class=variable>Attribute</span> <span class=variable>List-of-Attributes</span>)</code>
</p>
</ol><p></p>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

An <span style="font-style: oblique">Attribute</span> is a list of two items: 
<code class=scheme>(<span class=builtin>cons</span> <span class=variable>Symbol</span> (<span class=builtin>cons</span> <span class=variable>String</span> <span class=builtin>empty</span>))</code></p>
<p>
 
</td></tr>
</table>
</blockquote>
</p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 5:</b>&nbsp;&nbsp;XHTML as Scheme</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
Figure&nbsp;<a href="#node_fig_Temp_8">5</a> presents the data definitions for one of many
possible representations of XHTML in Scheme. A plain piece of XHTML
corresponds to an X-expression or <code class=scheme><span class=variable>X-exp</span></code> for short. It is either a
string or a list with at least two items: a symbol, a
<code class=scheme><span class=variable>List-of-Attribites</span></code>, followed by a list of X-expressions. The
symbol is the name of the tag. The list of X-expressions represents the
XHTML that is between the start and the end tag. </p>
<p>
For a good understanding of X-expressions, it is best to consider a series
of examples. Here is our first Web page again and its Scheme
representation:
</p>
<div align=center><table><tr><td>
 <span class=small></td><td><div align=left>
<p>
<tt>&lt;html&gt;</tt> <br>
&nbsp;&nbsp; <tt>&lt;head&gt;</tt> <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<tt>&lt;title&gt;</tt> <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<tt>A Simple Web Page</tt><br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<tt>&lt;/title&gt;</tt> <br>
&nbsp;&nbsp;&nbsp; <tt>&lt;/head&gt;</tt> <br>
&nbsp;&nbsp;&nbsp; <tt>&lt;body&gt;</tt> <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <tt>&lt;h1&gt;My First Web Page&lt;/h1&gt;</tt> <br>
&nbsp;&nbsp;&nbsp;       &nbsp;&nbsp;&nbsp; <tt>&lt;p&gt;</tt>Hello World.<tt>&lt;/p&gt;</tt><br>
&nbsp;&nbsp;&nbsp; <tt>&lt;/body&gt;</tt> <br>
<tt>&lt;/html&gt;</tt> 
</p>
<p>
</p>
</div></td><td>&nbsp;&nbsp;&nbsp;</td><td><div align=left>
<div align=left><pre class=scheme><span class=keyword>'</span>(<span class=variable>html</span> ()
   (<span class=variable>head</span> ()
     (<span class=variable>title</span> ()
       <span class=selfeval>&quot;A Simple Web Page&quot;</span>))


   (<span class=variable>body</span> ()
     (<span class=variable>h1</span> <span class=selfeval>&quot;My First Web Page&quot;</span>)
     (<span class=variable>p</span> <span class=selfeval>&quot;Hello World&quot;</span>)))


</pre></div>
</div></td><td>
</span></td></tr></table></div>

<p>
</p>

<p class=noindent>The comparison shows that a Scheme representation of XHTML is
more compact than XHTML itself. When we write down an X-expression we only
write down the name of the tag, not a start and an end tag. Empty
attribute lists become <code class=scheme>()</code> because <code class=scheme><span class=keyword>'</span>()</code> is
<code class=scheme><span class=builtin>empty</span></code>. </p>
<p>
Now suppose we wish to have a page with a white background. In that case,
we add an attribute to the body tag: 
</p>
<div align=left><pre class=scheme><span class=keyword>'</span>(<span class=variable>html</span> ()
   (<span class=variable>head</span> () 
     (<span class=variable>title</span> () <span class=selfeval>&quot;My First Scheme Web Page with Attributes&quot;</span>))
   (<span class=variable>body</span> ([<span class=variable>bgcolor</span> <span class=selfeval>&quot;white&quot;</span>])
     (<span class=variable>h1</span> <span class=selfeval>&quot;My First Page&quot;</span>)
     (<span class=variable>p</span> <span class=selfeval>&quot;Hello World&quot;</span>)))     
</pre></div><p>
The page has a head element and a body element. The body has one
attribute: a background color. </p>
<p>
The real power of Scheme&#8217;s X-expressions, though, is derived from the
power of lists and nesting lists. Here is a generalization of the first
Web page: 
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=variable>X-exp</span></code></span>
(<span class=keyword>define</span> (<span class=variable>n-th-web-page</span> <span class=variable>n</span>)
  (<span class=keyword>local</span> ([<span class=keyword>define</span> <span class=variable>title</span> (<span class=builtin>string-append</span> <span class=selfeval>&quot;My &quot;</span> <span class=variable>n</span> <span class=selfeval>&quot; Scheme Web page&quot;</span>)])
    (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>html</span> <span class=builtin>empty</span>
      (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>head</span> <span class=builtin>empty</span> (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>title</span> <span class=builtin>empty</span> <span class=variable>title</span>))
      (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>body</span> (<span class=builtin>list</span> [<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>bgcolor</span> <span class=selfeval>&quot;white&quot;</span>])
	(<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>h1</span> <span class=builtin>empty</span> <span class=variable>title</span>)
	(<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>p</span> <span class=builtin>empty</span> <span class=selfeval>&quot;Hello World&quot;</span>)))))
</pre></div><p>
Using <code class=scheme><span class=variable>n-th-web-page</span></code>, we can now easily produce the
<code class=scheme><span class=selfeval>&quot;first&quot;</span></code>, <code class=scheme><span class=selfeval>&quot;second&quot;</span></code>, and so on Web pages. Of course, this
definition is basically a constant definition for a Web page; its only
parameter is <code class=scheme><span class=variable>n</span></code>, which is plugged into the text without any
concern for its structure.</p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_9"></a>
<div class=figure align=center><table width=100%><tr><td align=center><div align=left><pre class=scheme><span class=comment>;; A <span style="font-style: oblique"> List-of-2strings</span> is either </span>
<span class=comment>;; - <code class=scheme><span class=builtin>empty</span></code></span>
<span class=comment>;; - <code class=scheme>(<span class=builtin>cons</span> <span class=variable>String-pair</span> <span class=variable>List-of-2Strings</span>)</code></span>
<span class=comment>;; A <span style="font-style: oblique"> String-pair</span> is a list with two strings: <code class=scheme>(<span class=builtin>list</span> <span class=variable>String</span> <span class=variable>String</span>)</code></span>

<span class=comment>;; <code class=scheme><span class=variable>create-table</span> <span class=selfeval>:</span> <span class=variable>List-of-2Strings</span> &nbsp;&rarr;&nbsp; <span class=variable>X-exp</span>[<span class=variable>table</span>]</code></span>
(<span class=keyword>define</span> (<span class=variable>create-table</span> <span class=variable>alos</span>)
  (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>table</span> (<span class=builtin>cons</span> <span class=builtin>empty</span> (<span class=variable>create-all-rows</span> <span class=variable>alos</span>))))
              
<span class=comment>;; <code class=scheme><span class=variable>List-of-2strings</span> &nbsp;&rarr;&nbsp; <span class=variable>list-of-X</span>[<span class=variable>tr</span>]</code></span>
(<span class=keyword>define</span> (<span class=variable>create-all-rows</span> <span class=variable>alos</span>)
  (<span class=keyword>cond</span>
    [(<span class=builtin>empty?</span> <span class=variable>alos</span>) <span class=builtin>empty</span>]
    [<span class=keyword>else</span> (<span class=builtin>cons</span> (<span class=variable>create-one-row</span> (<span class=builtin>first</span> <span class=variable>alos</span>)) (<span class=variable>create-all-rows</span> (<span class=builtin>rest</span> <span class=variable>alos</span>)))]))

<span class=comment>;; <code class=scheme><span class=variable>String-pair</span> &nbsp;&rarr;&nbsp; <span class=variable>X-exp</span>[<span class=variable>tr</span>]</code></span>
(<span class=keyword>define</span> (<span class=variable>create-one-row</span> <span class=variable>s2</span>)
  (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>tr</span> <span class=builtin>empty</span>
        (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>td</span> <span class=builtin>empty</span> (<span class=builtin>first</span> <span class=variable>s2</span>)) 
        (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>td</span> <span class=builtin>empty</span> (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>img</span> (<span class=builtin>list</span> (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>src</span> (<span class=builtin>second</span> <span class=variable>s2</span>))
                                         (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>width</span> <span class=selfeval>&quot;200&quot;</span>)
                                         (<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>alt</span> <span class=selfeval>&quot;pic&quot;</span>))))))
</pre></div><p></p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 6:</b>&nbsp;&nbsp;Creating XHTML</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
While such Web page patterns are useful, it is still a pretty static way of
dealing with XHTML. Consider a store instead. When a consumer inquires
about sales, a Web program may need to produce a table of descriptions and
pictures from a list of strings and URLs. In other words, we need a
function that produces a table from a list. It is not the table itself,
however, that requires computation but the rows in the table. After all,
the tag <code class=scheme><span class=keyword>'</span><span class=variable>table</span></code> occurs only once in the resulting page, but the
tag <code class=scheme><span class=keyword>'</span><span class=variable>tr</span></code> occurs as many times as there are objects on the for-sale
list. </p>
<p>
Figure&nbsp;<a href="#node_fig_Temp_9">6</a> displays the code for the program. The
function <code class=scheme><span class=variable>create-table</span></code> is the main function, though
<code class=scheme><span class=variable>create-all-rows</span></code> conducts most of the work. The latter function
produces the all the rows from the list. Finally, the last function in the
figure is analogous to <code class=scheme><span class=variable>n-th-web-page</span></code>. It just plugs in some
constants into a template. </p>
<p>
The teachpack <tt>servlet2.ss</tt> provides the function inform/html for
displaying XHTML expressions in a browser. It consumes a list of
<code class=scheme><span class=variable>X-exp</span></code> and sends them to a Web browser. As for <code class=scheme><span class=variable>inform</span></code>, the
bottom of the page includes a link so that consumers can continue with the
rest of the program. </p>
<p>
</p>
<p>
</p>
<p>


</p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_10"></a>
<div class=figure align=center><table width=100%><tr><td align=center><div class=smallskip></div>
<p style="margin-top: 0pt; margin-bottom: 0pt">


<img src=Images/xhtml2.gif alt="[XHTML in DrScheme]">
</p>
</td></tr>
<tr><td align=center><b>Figure 7:</b>&nbsp;&nbsp;Mixing XHTML and Scheme in DrScheme</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.2.1"></a>
<b>Exercise 3.2.1.</b>&nbsp;&nbsp; 
Develop the function <code class=scheme><span class=variable>create-paragraphs</span></code>. It consumes a list of
strings and produces a series of XHTML paragraphs from them. The
paragraphs are then wrapped in a <code class=scheme><span class=keyword>'</span><span class=variable>div</span></code>. </p>
<p>
After the function is tested, use <code class=scheme><span class=variable>inform/html</span></code> to display the
result of the function in a browser.&nbsp;<a href="../Solutions/servlet-div-p.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.2.2"></a>
<b>Exercise 3.2.2.</b>&nbsp;&nbsp; 
Develop the function <code class=scheme><span class=variable>create-enumeration</span></code>. It consumes a list of
strings and produces an XHTML enumeration or ordered list. An ordered
list is tagged with <code class=scheme><span class=keyword>'</span><span class=variable>ol</span></code> and contains elements that are tagged
with <code class=scheme><span class=keyword>'</span><span class=variable>li</span></code> (for list item). </p>
<p>
After the function is tested, use <code class=scheme><span class=variable>inform/html</span></code> to display the
result of the function in a browser.&nbsp;<a href="../Solutions/servlet-enum.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.2.3"></a>
<b>Exercise 3.2.3.</b>&nbsp;&nbsp; 
Develop the function <code class=scheme><span class=variable>enum-table</span></code>. It consumes a natural number and
produces a table with that many rows. Each row has one cell, and the cell
contains the number as an index.&nbsp;<a href="../Solutions/servlet-indexed.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.2.4"></a>
<b>Exercise 3.2.4.</b>&nbsp;&nbsp;  
Develop the function <code class=scheme><span class=variable>create-matrix</span></code>. It consumes two natural numbers:
<code class=scheme><span class=variable>n</span></code> and <code class=scheme><span class=variable>m</span></code>. Its result is an <code class=scheme><span class=variable>X-exp</span></code>. 
</p>
<div align=left><pre class=scheme><span class=comment>;; Example: </span>
(<span class=builtin>equal?</span> 
  (<span class=variable>create-matrix</span> <span class=selfeval>3</span> <span class=selfeval>2</span>)
  <span class=keyword>'</span>(<span class=variable>table</span> ()
     (<span class=variable>tr</span> () (<span class=variable>td</span> () <span class=selfeval>&quot;cell00&quot;</span>) (<span class=variable>td</span> () <span class=selfeval>&quot;cell01&quot;</span>))
     (<span class=variable>tr</span> () (<span class=variable>td</span> () <span class=selfeval>&quot;cell10&quot;</span>) (<span class=variable>td</span> () <span class=selfeval>&quot;cell11&quot;</span>))
     (<span class=variable>tr</span> () (<span class=variable>td</span> () <span class=selfeval>&quot;cell20&quot;</span>) (<span class=variable>td</span> () <span class=selfeval>&quot;cell21&quot;</span>))))
</pre></div><p>
Make up examples with smaller numbers.&nbsp;<a href="../Solutions/servlet-matrix.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
Figure&nbsp;<a href="#node_fig_Temp_10">7</a> shows how to mix XML boxes and Scheme code in
DrScheme. The functions in the <tt>Definitions</tt> are the same as those
presented in figure&nbsp;<a href="#node_fig_Temp_9">6</a>. In <code class=scheme><span class=variable>create-one-row</span></code>,
the boxes inside of the XML boxes are so-called <em>Scheme Boxes</em>, also
available under the <tt>Special</tt> menu. These boxes evaluate to plain
Scheme values are place into the surrounding XHTML text. We can thus turn
an XML box into a pattern.</p>
<p>
The box inside of <code class=scheme><span class=variable>create-table</span></code>&#8217;s XHTML box is a so-called
<em>Scheme Slice Box</em>. The expression inside such a box must evaluate to
a list. The list is spliced into the surrounding XHTML text. In this case,
the rows are placed inside the XML box as the rows of the table. If we had
used an ordinary Scheme Box instead, all rows would become a single
ill-formed XHTML element inside of the table. Distinguishing the two kinds
of boxes takes practice, but pays off when XHTML with large portions of
plain text play a role in the Web page creation. </p>
<p>
</p>
<a name="node_sec_3.3"></a>
<h2 class=section>3.3&nbsp;&nbsp;Forms</h2>
<p>
<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_11"></a>
<div class=figure align=center><table width=100%><tr><td align=center>
 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">F-expr</span> is:
<div align=left><pre class=scheme>  (<span class=builtin>cons</span> <span class=keyword>'</span><span class=variable>form</span>
    (<span class=builtin>cons</span> (<span class=keyword>listof</span> <span class=variable>F-attributes</span>)
      (<span class=keyword>listof</span> <span class=variable>X-exp</span>)))
</pre></div><p> 
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">F-attribute</span> is one of: 
</p>
<ol>
<li><p><code class=scheme>(<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>method</span> <span class=variable>String</span>[<span class=selfeval>&quot;get&quot;</span><span class=keyword>,</span><span class=selfeval>&quot;post&quot;</span>])</code>
</p>
<li><p><code class=scheme>(<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>action</span> <span class=variable>String</span>[<span class=variable>url</span>])</code>
</p>
</ol><p> 
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">F-input</span> is a list: <code class=scheme>(<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>input</span> <span class=variable>I-attributes</span>)</code> 
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">I-attributes</span> is one of: 
</p>
<ol>
<li><p><code class=scheme>(<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>type</span> <span class=variable>I-type</span>)</code>
</p>
<li><p><code class=scheme>(<span class=builtin>list</span> <span class=keyword>'</span><span class=variable>name</span> <span class=variable>String</span>)</code>
</p>
</ol><p> 
 
</td></tr>
</table>
</blockquote>
</p>
<p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">I-type</span> is one of: 
</p>
<ol>
<li><p><code class=scheme><span class=selfeval>&quot;submit&quot;</span></code>
</p>
<li><p><code class=scheme><span class=selfeval>&quot;text&quot;</span></code>
</p>
<li><p><code class=scheme><span class=selfeval>&quot;password&quot;</span></code>
</p>
<li><p><code class=scheme><span class=selfeval>&quot;check&quot;</span></code>
</p>
<li><p><code class=scheme><span class=selfeval>&quot;radio&quot;</span></code>
</p>
</ol><p> 
 
</td></tr>
</table>
</blockquote>
</p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 8:</b>&nbsp;&nbsp;XHTML forms in Scheme</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.3.1"></a>
<b>Exercise 3.3.1.</b>&nbsp;&nbsp; 
&nbsp;<a href="../Solutions/servlet-0.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_3.3.2"></a>
<b>Exercise 3.3.2.</b>&nbsp;&nbsp; 
&nbsp;<a href="../Solutions/servlet-1.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>
<a name="node_sec_3.4"></a>
<h2 class=section>3.4&nbsp;&nbsp;Exercises</h2>
<p></p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/">Abstractions</a></p>
<p>
do exercises with map, etc. prepare spreadsheet </p>
<p>
</p>
<a name="node_sec_4"></a>
<h1 class=section>4&nbsp;&nbsp;The Full Power of Servlets</h1>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node???.html">21.2 Finger Exercises with Abstract List Functions</a></p>
<p>
</p>
<div align=left><pre class=scheme><span class=comment>;; </span>
</pre></div><p></p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_12"></a>
<div class=figure align=center><table width=100%><tr><td align=center><p>

 
<blockquote>
<table bgcolor="tan">
<tr><td>

A <span style="font-style: oblique">Request</span> is a structure:<br>
</p>
<div align=center>&nbsp; <code class=scheme>(<span class=variable>make-response</span> ... <span class=variable>Bin</span> ...)</code> &nbsp;</div>

for some type <code class=scheme><span class=variable>Bin</span></code>. 
 
</td></tr>
</table>
</blockquote>
<p>
</p>

<p class=noindent><strong>Functions</strong>:
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>send/suspend</span> <span class=selfeval>:</span> (<span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=variable>X-exp</span>) &nbsp;&rarr;&nbsp; <span class=variable>Request</span></code></span>
<span class=comment>;; send a Web page and suspend </span>

<span class=comment>;; <code class=scheme><span class=variable>send/finish</span> <span class=selfeval>:</span> <span class=variable>X-exp</span> &nbsp;&rarr;&nbsp; <span class=variable>Request</span></code></span>
<span class=comment>;; send a Web page and finish off the servlet</span>

<span class=comment>;; <code class=scheme><span class=variable>build-suspender</span> <span class=selfeval>:</span> (<span class=keyword>listof</span> <span class=variable>X-exp</span>) (<span class=keyword>listof</span> <span class=variable>X-exp</span>) &nbsp;&rarr;&nbsp; (<span class=variable>String</span> &nbsp;&rarr;&nbsp; <span class=variable>X-exp</span>)</code></span>
<span class=comment>;; build a suspender from <code class=scheme><span class=variable>title</span></code> and <code class=scheme><span class=variable>form-body</span></code></span>
<span class=comment>;; also consumes two optional values that specify attributes </span>
(<span class=keyword>define</span> (<span class=variable>build-suspender</span> <span class=variable>title</span> <span class=variable>form-body</span>) ...)

<span class=comment>;; <code class=scheme><span class=variable>extract-binding/single</span> <span class=selfeval>:</span> <span class=variable>Symbol</span> <span class=variable>Bin</span> &nbsp;&rarr;&nbsp; <span class=variable>String</span></code></span>
<span class=comment>;; extracting the answer for <code class=scheme><span class=variable>tag</span></code> from a response; </span>
<span class=comment>;; the tag must occur exactly once</span>
(<span class=keyword>define</span> (<span class=variable>extract-binding/single</span> <span class=variable>tag</span> <span class=variable>b</span>) ...)

<span class=comment>;; <code class=scheme><span class=variable>extract-bindings</span> <span class=selfeval>:</span> <span class=variable>Symbol</span> <span class=variable>Bin</span> &nbsp;&rarr;&nbsp; (<span class=keyword>listof</span> <span class=variable>String</span>)</code></span>
<span class=comment>;; extracting all the answers for a given tag from a response; </span>
<span class=comment>;; the list is empty if there is no such tag</span>
(<span class=keyword>define</span> (<span class=variable>extract-bindings</span> <span class=variable>tag</span> <span class=variable>b</span>) ...)
</pre></div><p></p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 9:</b>&nbsp;&nbsp;The servlet api</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_4.0.1"></a>
<b>Exercise 4.0.1.</b>&nbsp;&nbsp; 
&nbsp;<a href="../Solutions/servlet-0.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_4.0.2"></a>
<b>Exercise 4.0.2.</b>&nbsp;&nbsp; 
&nbsp;<a href="../Solutions/servlet-1.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>
<a name="node_sec_5"></a>
<h1 class=section>5&nbsp;&nbsp;Giving Consumers a Second Chance</h1>
<p></p>
<p>
</p>

<p class=noindent>P<small>R</small><small>E</small><small>R</small><small>E</small><small>Q</small><small>U</small><small>I</small><small>S</small><small>I</small><small>T</small><small>E</small>: 
<a href="http://www.htdp.org/2002-09-22/Book/node???.html">25. A New Form of Recursion</a></p>
<p>

<blockquote><table bgcolor="beige"><tr><td>

</p>
<a name="node_fig_Temp_13"></a>
<div class=figure align=center><table width=100%><tr><td align=center><p>
</p>
<div align=left><pre class=scheme><span class=comment>;; <code class=scheme><span class=variable>login</span> <span class=selfeval>:</span> <span class=builtin>true</span> &nbsp;&rarr;&nbsp; <span class=builtin>true</span></code></span>
<span class=comment>;; to produce a login from a password check </span>
(<span class=keyword>define</span> (<span class=variable>login</span> <span class=variable>go</span>)
  (<span class=keyword>local</span> ((<span class=keyword>define</span> <span class=variable>name</span> (<span class=variable>single-query</span> <span class=selfeval>&quot;Your name:&quot;</span>))
	  (<span class=keyword>define</span> <span class=variable>pass</span> (<span class=variable>single-query</span> <span class=selfeval>&quot;Your password:&quot;</span>)))
    (<span class=keyword>cond</span>
      [(<span class=variable>check-password</span> <span class=variable>name</span> <span class=variable>pass</span> <span class=variable>DB</span>)
       (<span class=variable>inform</span> <span class=selfeval>&quot;Login&quot;</span> <span class=selfeval>&quot;Welcome! You successfully logged in.&quot;</span>)]
      [<span class=keyword>else</span> 
	(<span class=keyword>local</span>
	  ([<span class=keyword>define</span> <span class=variable>_</span>
	     (<span class=variable>inform</span> <span class=selfeval>&quot;Login&quot;</span> <span class=selfeval>&quot;Your name and password don't match.&quot;</span>)])
	  (<span class=variable>login</span> <span class=builtin>true</span>))])))

<span class=comment>;; <code class=scheme><span class=variable>check-password</span> <span class=selfeval>:</span> <span class=variable>String</span> <span class=variable>String</span> (<span class=keyword>listof</span> (<span class=builtin>list</span> <span class=variable>String</span> <span class=variable>String</span>)) &nbsp;&rarr;&nbsp; <span class=variable>Boolean</span></code> </span>
<span class=comment>;; to make sure that the <code class=scheme><span class=variable>name</span></code> and the <code class=scheme><span class=variable>password</span></code> match in DB</span>
(<span class=keyword>define</span> (<span class=variable>check-password</span> <span class=variable>name</span> <span class=variable>password</span> <span class=variable>DB</span>)
  ...)

<span class=comment>;; run program run </span>
(<span class=variable>login</span> <span class=builtin>true</span>)
</pre></div><p></p>
<p>
</p>
</td></tr>
<tr><td align=center><b>Figure 10:</b>&nbsp;&nbsp;A full-fledged login program</td></tr>
<tr><td> 
</td></tr></table></div><p>

</td></tr></table></blockquote>
</p>
<p>
</p>
<p></p>
<hr>
<p></p>
<p><strong>Exercise</strong>
</p>
<p></p>
<p>
</p>
<p><a name="node_thm_5.0.3"></a>
<b>Exercise 5.0.3.</b>&nbsp;&nbsp; 
&nbsp;<a href="../Solutions/servlet-0.html">Solution</a></p>
<p></p>
<p>
</p>
<p><a name="node_thm_5.0.4"></a>
<b>Exercise 5.0.4.</b>&nbsp;&nbsp; 
&nbsp;<a href="../Solutions/servlet-1.html">Solution</a></p>
<p></p>
<hr>
<p></p>
<p></p>
<p></p>
<p>
</p>

<div class=footnoterule><hr></div><p></p>
<div class=footnote><p><a name="node_footnote_Temp_6"></a><sup><small><a href="#node_call_footnote_Temp_6">1</a></small></sup> Technically, XHTML is a dialect
of a family of languages, called XML, and represents conventional
HTML. Since Web browsers are forgiving, we ignore the difference.</p>
</div>
<div class=smallskip></div>
<p style="margin-top: 0pt; margin-bottom: 0pt">
<div align=right class=navigation></div>
</p>
<p></p>
<div align=right class=colophon>Last modified: Monday, October 27th, 2003 7:31:46pm<br><div align=right class=advertisement>HTML conversion by <a href="http://www.ccs.neu.edu/~dorai/tex2page/tex2page-doc.html">TeX2page 20070609</a></div></div>
</div>
</body>
</html>
