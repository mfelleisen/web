<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>9 --- The Revision</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="shared.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Software Development</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="abstract.html" class="tocviewlink" data-pltdoc="x">Abstract</a></td></tr><tr><td align="right"></td><td><a href="finals.html" class="tocviewlink" data-pltdoc="x">Final Code Walks</a></td></tr><tr><td align="right"></td><td><a href="general.html" class="tocviewlink" data-pltdoc="x">General</a></td></tr><tr><td align="right"></td><td><a href="staff.html" class="tocviewlink" data-pltdoc="x">Staff</a></td></tr><tr><td align="right"></td><td><a href="readings.html" class="tocviewlink" data-pltdoc="x">Readings</a></td></tr><tr><td align="right"></td><td><a href="communication.html" class="tocviewlink" data-pltdoc="x">Communicate</a></td></tr><tr><td align="right"></td><td><a href="lab.html" class="tocviewlink" data-pltdoc="x">Lab Book</a></td></tr><tr><td align="right"></td><td><a href="reviews.html" class="tocviewlink" data-pltdoc="x">In-<wbr></wbr>Class Reviews</a></td></tr><tr><td align="right"></td><td><a href="top-down.html" class="tocviewlink" data-pltdoc="x">Presenting a Milestone</a></td></tr><tr><td align="right"></td><td><a href="projects.html" class="tocviewlink" data-pltdoc="x">Assignments, Overview</a></td></tr><tr><td align="right"></td><td><a href="delivery.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Delivery</a></td></tr><tr><td align="right"></td><td><a href="make.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Make</a></td></tr><tr><td align="right"></td><td><a href="readme.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Read Me</a></td></tr><tr><td align="right"></td><td><a href="testme.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Test Me</a></td></tr><tr><td align="right"></td><td><a href="debugging.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Debugging</a></td></tr><tr><td align="right"></td><td><a href="late.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Late Policy</a></td></tr><tr><td align="right"></td><td><a href="grades.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Code Grades</a></td></tr><tr><td align="right"></td><td><a href="projects2.html" class="tocviewlink" data-pltdoc="x">Assignments, Actual</a></td></tr><tr><td align="right"></td><td><a href="tahbpl.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>TAHBPL</a></td></tr><tr><td align="right"></td><td><a href="assignments.html" class="tocviewselflink" data-pltdoc="x">&#8212;<wbr></wbr>Project Milestones</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td></td><td><a href="assignments.html" class="tocviewlink" data-pltdoc="x">&#8212;<wbr></wbr>Project Milestones</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="maze.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">The Game:<span class="mywbr"> &nbsp;</span> Labyrinth</span></a></td></tr><tr><td align="right"></td><td><a href="components.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">The Components</span></a></td></tr><tr><td align="right"></td><td><a href="gems.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">The Gems</span></a></td></tr><tr><td align="right"></td><td><a href="1.html" class="tocviewlink" data-pltdoc="x">1 &#8212;<wbr></wbr> The Analysis</a></td></tr><tr><td align="right"></td><td><a href="plan.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">Maze</span><span class="stt">.</span><span style="color: red">Com</span>, <span style="color: red">a Plan</span></a></td></tr><tr><td align="right"></td><td><a href="2.html" class="tocviewlink" data-pltdoc="x">2 &#8212;<wbr></wbr> The Board</a></td></tr><tr><td align="right"></td><td><a href="3.html" class="tocviewlink" data-pltdoc="x">3 &#8212;<wbr></wbr> The State</a></td></tr><tr><td align="right"></td><td><a href="4.html" class="tocviewlink" data-pltdoc="x">4 &#8212;<wbr></wbr> The Strategy</a></td></tr><tr><td align="right"></td><td><a href="local_protocol.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">Logical Interactions</span></a></td></tr><tr><td align="right"></td><td><a href="5.html" class="tocviewlink" data-pltdoc="x">5 &#8212;<wbr></wbr> Games!</a></td></tr><tr><td align="right"></td><td><a href="6.html" class="tocviewlink" data-pltdoc="x">6 &#8212;<wbr></wbr> The Observer</a></td></tr><tr><td align="right"></td><td><a href="partner1.html" class="tocviewlink" data-pltdoc="x"><span style="color: blue">Howdy Pardner</span></a></td></tr><tr><td align="right"></td><td><a href="7.html" class="tocviewlink" data-pltdoc="x">7 &#8212;<wbr></wbr> The Clean Up</a></td></tr><tr><td align="right"></td><td><a href="remote.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">Remote Interactions</span></a></td></tr><tr><td align="right"></td><td><a href="8.html" class="tocviewlink" data-pltdoc="x">8 &#8212;<wbr></wbr> Remote</a></td></tr><tr><td align="right"></td><td><a href="partner2.html" class="tocviewlink" data-pltdoc="x"><span style="color: blue">Howdy Pardner, Again</span></a></td></tr><tr><td align="right"></td><td><a href="9.html" class="tocviewselflink" data-pltdoc="x">9 &#8212;<wbr></wbr> The Revision</a></td></tr><tr><td align="right"></td><td><a href="10.html" class="tocviewlink" data-pltdoc="x">10 &#8212;<wbr></wbr> Revised!</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;">&bull;</td><td></td><td><a href="9.html" class="tocviewselflink" data-pltdoc="x">9 &#8212;<wbr></wbr> The Revision</a></td></tr></table></div></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.7.0.3</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="partner2.html" title="backward to &quot;Howdy Pardner, Again&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="assignments.html" title="up to &quot;---Project Milestones&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="10.html" title="forward to &quot;10 --- Revised!&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4><a name="(part._9)"></a>9 &#8212;<wbr></wbr> The Revision</h4><a name="(part._chap~3a9)"></a><p><span style="color: blue">Due</span> Thursday, 01 December 2022, 11:59:59pm</p><p><span style="color: blue">Delivery</span> Place the product of this week&rsquo;s milestone into your git repo as follows:</p><ul><li><p>for the Programming Task, <span style="color: purple">modify the referee, its state, and the
actual player as needed. Then describe the changes with concise prose and </span>
place <span style="color: purple">the resulting document,</span> <span class="stt">revisions.md</span>, into <span class="strike" style="text-decoration:line-through">Maze/Players/</span><span class="stt"> </span><span style="color: purple">Maze/Planning/</span>;</p></li><li><p>for the Runnable task, place <span class="stt">xserver</span> and <span class="stt">xclient</span><span style="color: purple">s</span> into a top-level repo directory named <span class="stt">9</span></p></li></ul><p><span style="color: blue">Programming Task</span> The co-CEOs received a request from their investors to
make the game a bit more interesting. Specifically, the investors would like
players to chase down several treasures, not just one.</p><p>Here is the precise specification. After the referee receives the <span style="font-style: italic">n</span>
players, it assigns them homes. All potential goals are arranged as a ordered
sequence. The first <span style="font-style: italic">n</span> elements are removed from this sequence and
assigned to the players as goals during setup. Every time a player reaches a
goal tile, the referee removes the next goal<span class="strike" style="text-decoration:line-through">s</span> from the front of the
sequence and assigns it to the player that just landed on a goal tile;
<span style="color: purple">to inform the player of the chosen goal, the referee uses the <span class="stt">setup</span>
method in the usual manner</span>. Once the sequence is empty, players are no longer
assigned a new goal but are told to go home.</p><p><div class="SIntrapara">The ranking of players has to change, too. When the game is over, the referee
<span class="emph">always</span> uses the following steps to determine the winner(s):
</div><div class="SIntrapara"><ul><li><p>for all players that have collected the same highest number of
treasures&#8212;<wbr></wbr>equivalently, have visited the same number of goals&#8212;<wbr></wbr>the
referee determines their Euclidean distance to their <span class="strike" style="text-decoration:line-through"><span class="emph">next</span></span>
&ldquo;goal,&rdquo;<span class="refelem"><span class="refcolumn"><span class="refcontent"><span style="color: purple">The word ``goal'' is overloaded here.</span></span></span></span>
<span style="color: purple">which is either a home or a treasure coordinate</span>. The
winners are those that share the same <span style="color: purple">minimal</span> distance. <span style="color: purple">If the
game-terminating player is one of the players with the highest number of
collected treasures, it is the <span class="emph">sole</span> winner.</span></p></li></ul></div><div class="SIntrapara">Your referee methods/functions should initialize this sequence of additional
goals to the empty one.</div></p><p>You may need to adapt your referee method that accepts a players and an already
formed state, which includes player knowledge with the initially assigned goal.</p><p><div class="SIntrapara"><span style="color: blue">Runnables Task</span> Construct two executable programs:
</div><div class="SIntrapara"><ul><li><p><span class="stt">xserver</span>, which starts your server, and</p></li><li><p><span class="stt">xclients</span>, which launches a number of clients and points them to a server.</p></li></ul></div></p><p><span style="font-weight: bold">Well-formed and Valid</span> You may assume that all (system-configurations) inputs to your
test harnesses from <span class="stt">STDIN</span> are well-formed and valid.  A <a href="C.html#%28tech._well._formed%29" class="techoutside" data-pltdoc="x"><span class="techinside">well-formed</span></a> piece of JSON
satisfies the grammar; such a piece is <a href="C.html#%28tech._valid%29" class="techoutside" data-pltdoc="x"><span class="techinside">valid</span></a> if it also satisfies all
the side constraints of a schema specification. </p><p>Both programs are launched with a port argument on the command line. For
<span class="stt">xclients</span>, the command line may also specify an IP address, as an optional
second argument; the default is local host (<span class="stt">127.0.0.1</span>).</p><p><div class="SIntrapara">Both programs consume a configuration from <span class="stt">STDIN</span>. Our test harness will split
test cases from <a href="8.html" data-pltdoc="x">8 &#8212;<wbr></wbr> Remote</a>:
 the first JSON value from a test-input file is the configuration for <span class="stt">xclients</span>
and
 the second JSON value is used as the configuration for <span class="stt">xserver</span>.
The test harness starts an <span class="stt">xclients</span> script and a <span class="stt">xserver</span> script
as independent processes, though not necessarily your pairs:
</div><div class="SIntrapara"><ul><li><p>The <span class="stt">xclients</span> script turns the player specifications into
independently running players; you may use threads in your language or Linux
processes if you write this script as a plain shell script.</p><p><span style="color: purple">If these threads or processes are launched without precaution, the test
is going to run in a non-deterministic fashion and will yield non-deterministic
-- and therefore incomparable -- results. To reduce the likelihood of a
non-deterministic outcome, the <span class="stt">xclients</span> script will wait for 3s between launching clients. In our test runs, the server
will launch in time to allow the first client to connect first, but not
necessarily on the first try.</span></p></li><li><p>The <span class="stt">xserver</span> spawns the server as another <span class="strike" style="text-decoration:line-through">independent</span> thread or
process <span style="color: purple">that is independent of the client</span>. The server waits for the players to sign up and passes their local
representation plus the given <a href="6.html#%28tech._refereestate%29" class="techoutside" data-pltdoc="x"><span class="techinside">RefereeState</span></a> to the referee. The latter
runs a game and hands the result of running the game back to the server, which
renders it as a JSON value to <span class="stt">STDOUT</span>.</p></li></ul></div><div class="SIntrapara">The test harness compares this actual output to the expected output of the test
case (<span style="color: purple">from <a href="8.html" data-pltdoc="x">8 &#8212;<wbr></wbr> Remote</a></span>). The test bed ignores the output of <span class="stt">xclients</span>.</div></p><p><span style="color: purple">Configure your referee so that it grants each player 4.0s per
method call. This time period is long but it allows for TCP hiccups, especially
with the take-turn method.</span></p><p><span style="color: purple"><span style="font-weight: bold">Critical Supplement</span> Our tests will come with the player specs set
up so that the youngest player matches the first player in the given state and the
oldest player matches the last player in the given state. The tests are by
running the test cases as is through the server-client set up and comparing it
with the corresponding state run via the referee.</span></p><p><span class="emph">Running the Scripts</span> Since the test inputs from <a href="8.html" data-pltdoc="x">8 &#8212;<wbr></wbr> Remote</a> consist of two
&ldquo;lines,&rdquo; you can run the scripts in two separate terminal windows and have them
communicate on the same machine, as the following two screenshots illustrate.</p><blockquote><p><img src="xclients.png" alt="" width="617" height="291"/></p></blockquote><p>This first screenshot displays a single shell script line. On the left of the
pipe symbol, the <span class="stt">head</span> function extracts the first line from a test-input
file. The pipe re-directs <span class="stt">STDOUT</span> of <span class="stt">head</span> to <span class="stt">STDIN</span> of he function to
the right side of the pipe symbol. On the right side, the line invokes the
<span class="stt">sclients</span> script, which is informed by its command-line argument that it
should connect all of the players to a server on port <span class="stt">12345</span> (on the same
machine).</p><blockquote><p><img src="xserver.png" alt="" width="617" height="270"/></p></blockquote><p>This second screenshot shows how to use Unix&rsquo;s <span class="stt">tail</span> function to extract the
second line of the same test-input file as in the first screenshot. Its output
is piped into <span class="stt">xserver</span>, which makes its server listen for client connections
on port <span class="stt">12345</span>. Before the server shuts down, it renders the result of
running the game to <span class="stt">STDOUT</span>. To find out whether this result is correct, you
can use <span class="stt">cat</span> to print the test-output file to <span class="stt">STDOUT</span>. Eyeballing the two
lines suggests that the experiment produced the desired result.</p><p><span style="font-weight: bold">Note</span> This is not a test.</p><p><span style="font-weight: bold">Note</span> You may to wish write <span class="stt">xclients</span> as a shell (bash) script that
spawns Linux processes or as a short TAHBPL program that spins up threads.  In
either case, the idea is to spawn the server and the clients as parallel
programs to mimic a distributed setting as much as possible using a single
machine.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="partner2.html" title="backward to &quot;Howdy Pardner, Again&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="assignments.html" title="up to &quot;---Project Milestones&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="10.html" title="forward to &quot;10 --- Revised!&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>