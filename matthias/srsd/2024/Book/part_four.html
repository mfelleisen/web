<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>IV&nbsp;Programming Interfaces</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="shared.css" title="default"/><link rel="stylesheet" type="text/css" href="figure.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="figure.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Socially Responsible <br/> Software Development</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="part_preface.html" class="tocviewlink" data-pltdoc="x"><span class="Smaller">Prelude</span></a></td></tr><tr><td align="right">I&nbsp;</td><td><a href="part_one.html" class="tocviewlink" data-pltdoc="x"><span class="Smaller">Perspective</span></a></td></tr><tr><td align="right">II&nbsp;</td><td><a href="part_two.html" class="tocviewlink" data-pltdoc="x"><span class="Smaller">Principles</span></a></td></tr><tr><td align="right">III&nbsp;</td><td><a href="part_three.html" class="tocviewlink" data-pltdoc="x"><span class="Smaller">Project</span></a></td></tr><tr><td align="right">IV&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x"><span class="Smaller">Programming Interfaces</span></a></td></tr><tr><td align="right">V&nbsp;</td><td><a href="part_five.html" class="tocviewlink" data-pltdoc="x"><span class="Smaller">Programming Basics</span></a></td></tr><tr><td align="right"></td><td><a href="part_postlude.html" class="tocviewlink" data-pltdoc="x"><span class="Smaller">Postlude</span></a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>IV&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x"><span class="Smaller">Programming Interfaces</span></a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">13&nbsp;</td><td><a href="#%28part._ch~3aold-if%29" class="tocviewlink" data-pltdoc="x">The Nature of Interfaces</a></td></tr><tr><td align="right">14&nbsp;</td><td><a href="#%28part._ch~3amodules%29" class="tocviewlink" data-pltdoc="x">Encapsulation via Interfaces</a></td></tr><tr><td align="right">15&nbsp;</td><td><a href="#%28part._sec~3aapi-design%29" class="tocviewlink" data-pltdoc="x">Designing an Interface</a></td></tr><tr><td align="right">16&nbsp;</td><td><a href="#%28part._sec~3aapi-expression%29" class="tocviewlink" data-pltdoc="x">Expressing an Interface</a></td></tr><tr><td align="right">17&nbsp;</td><td><a href="#%28part._ch~3adesign-alt%29" class="tocviewlink" data-pltdoc="x">Interface Inspections, Systematically</a></td></tr></table></div></div></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">8.14.0.1</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="part_three.html" title="backward to &quot;III Project&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Socially Responsible  Software Development&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="part_five.html" title="forward to &quot;V Programming Basics&quot;" data-pltdoc="x" rel="next">next &rarr;</a></span>&nbsp;</div><h3 class="heading">IV<tt>&nbsp;</tt><a name="(part._part~3afour)"></a><span class="Smaller">Programming Interfaces</span><span class="button-group"><a href="#(part._part~3afour)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3aold-if%29" class="toclink" data-pltdoc="x">13<span class="hspace">&nbsp;</span>The Nature of Interfaces</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aontology%29" class="toclink" data-pltdoc="x">13.1<span class="hspace">&nbsp;</span>An Interface is the Common Ontology for Clients and Server</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3amodules%29" class="toclink" data-pltdoc="x">14<span class="hspace">&nbsp;</span>Encapsulation via Interfaces</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aencapsulation%29" class="toclink" data-pltdoc="x">14.1<span class="hspace">&nbsp;</span>Interface Inspections for Encapsulation</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3areact-encapsulation%29" class="toclink" data-pltdoc="x">14.2<span class="hspace">&nbsp;</span>Encapsulating Properly</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aapi-design%29" class="toclink" data-pltdoc="x">15<span class="hspace">&nbsp;</span>Designing an Interface</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sub~3aif-example1%29" class="toclink" data-pltdoc="x">15.1<span class="hspace">&nbsp;</span>Inspecting Simple Interface Designs</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aapi-expression%29" class="toclink" data-pltdoc="x">16<span class="hspace">&nbsp;</span>Expressing an Interface</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._ch~3adesign-alt%29" class="toclink" data-pltdoc="x">17<span class="hspace">&nbsp;</span>Interface Inspections, Systematically</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#%28part._sec~3aintf-inspection%29" class="toclink" data-pltdoc="x">17.1<span class="hspace">&nbsp;</span>Inspections and Design Alternatives</a></p></td></tr></table><p><table cellspacing="0" cellpadding="0"><tr><td><p>&#160;</p></td></tr><tr><td><p></p></td></tr><tr><td><p>&#160;</p></td></tr></table></p><p>What is a software component? How are they developed? Used?</p><p>As the preceding chapter suggests, the first step of any software development
process identifies all the major components of the system, at least as much as
possible. &ldquo;Identifying a component&rdquo; means picking a title or name; writing
down a purpose statement; and perhaps formulating an informal description of the
functionality (or other attributes). Once this much is worked out&#8212;<wbr></wbr>with formal
documents or an informal README file or as a thought in someone&rsquo;s head&#8212;<wbr></wbr>the
team&rsquo;s developers switch from their role as architect into a role of component
creator.</p><p>In essence, a component is the location of a major design decision, concerning
either an outward-facing piece of software or an internal one needed for some
use-cases. A design decision means choosing one of several alternatives: the
data chosen to represent some particular information or the data chosen to
represent intermediate results; the interpretation mapping data to information
and vice versa; some examples if the data definition is complex; plus an
expression of functionality signatures.</p><p>Creating a single container for a design decision should mean that any necessary
revisions of the decision affect only this one place. That is, if unforeseen
circumstances reveal the need to implement an alternative choice, a developer
can go to this container and make appropriate changes only there. And ideally,
such changes should not affect the functionality of the rest of the system.
Software developers speak of <span class="emph">encapsulating</span> a design decision or of just
<span class="emph">encapsulation</span>.</p><p><div class="SIntrapara">Realizing encapsulation of a design decision demands two steps. First, the
developers must separate the implementation details of the component from how
others perceive and use the component, that is,
</div><div class="SIntrapara"><ul><li><p>the <span class="emph">interface</span>, i.e., how others view the component;</p></li><li><p>the <span class="emph">implementation</span>, i.e., how a developer implements the design.</p></li></ul></div><div class="SIntrapara">Most software engineering literature says an interface describes the
<span class="emph">server component</span> and those that use it are called <span class="emph">client
components</span>. The creators of the client components are consumers of the server
component&rsquo;s interface. In this chapter, we call them consuming developers or
consumers.</div></p><p><a href="#%28counter._%28figure._fig~3ainterface-schematic%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">18</span></a> displays a schematic diagram of the
arrangement. A component&rsquo;s <span class="stt">interface</span> shields the internal
details&#8212;<wbr></wbr><span class="stt">hidden code</span> of the server component&#8212;<wbr></wbr>from the rest of the system
and especially all those <span class="stt">client</span> components that need to use the
functionality of the component.</p><blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="interface.svg" alt="" width="588.06pt" height="215.622pt"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3ainterface-schematic))" x-target-lift="Figure"></a>Figure&nbsp;18: </span>An interface for hiding a component&rsquo;s internals</span></p></blockquote><p>Second, everyone else working on the system must develop to the interface of the
component&#8212;<wbr></wbr>not its internals&#8212;<wbr></wbr>whether the project is written in a typed
language with some support for interfaces or in an untyped language without any
idea of an interface.  This understanding of interfaces&#8212;<wbr></wbr>as a policy of
visibility and interaction between pieces of code&#8212;<wbr></wbr>makes up half of the design
of interfaces.  The other half concerns the expressiveness of the interface, its
convenient use, and controlling the integrity of its use.</p><p>This chapter focuses on the design of component interfaces and its consequences;
the next chapter is about implementing the hidden details with code that people
can understand. Designing a component interface is the key step to designing and
implementing the component. It is thus often equated with programming
components, hence the title of this chapter. The remaining sections introduce
the proper meaning of encapsulation, an approach to designing interfaces, and
ways of expressing complete interfaces. In parallel, the sections also
illustrate how to inspect interface designs and what such inspections reveal
about system-level, architectural decisions.</p><h3 class="heading">13<tt>&nbsp;</tt><a name="(part._ch~3aold-if)"></a>The Nature of Interfaces<span class="button-group"><a href="#(part._ch~3aold-if)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p>What are interfaces? How do they relate components?</p><p>While a component consists of code, an interface is a document that explains how
this code should interact with the code of other components. As such they inform
developers of client code about pieces of the data representation(s) hidden in
the component; about the functionality that can create, instantiate, inspect,
and manipulate these data representations; about conditions that these
operations must obey; and perhaps even about non-functional aspects, such as
resource consumption and management. Everything else remains hidden from the
developer of client components.</p><p>These documents come in many different forms and shapes. In some cases, the
document is just an informal description. In some research languages, the
interface is just code. For typed mainstream languages, an interface document
mixes informal descriptions with language constructs that allow the some amount
of compile-time checking of properties.</p><p><div class="SIntrapara">Java serves as a good example of this common mixture. Its <span class="stt">interface</span>
construct allows developers to write down method signatures and even default
implementations and to tell developers of client code to program to those. A
Java <span class="stt">interface</span> does not suffice, however, to describe the interfaces
between components in the sense spelled out above. For example, if a method&rsquo;s
input is signature <span class="stt">int</span> <span class="stt">x</span> but a small natural number is required, a
<span class="refelem"><span class="refcolumn"><span class="refcontent">Technically speaking, Java lacks a contract system.</span></span></span>  developer
has to add an informal comment&#8212;<wbr></wbr>using, say, JavaDoc&#8212;<wbr></wbr>that <span class="stt">x</span> must be
greater or equal to <span class="stt">0</span> and smaller than some other number. Similarly,
consider an interface that specifies three methods&#8212;<wbr></wbr><span class="stt">start</span>, <span class="stt">extract</span>,
and <span class="stt">end</span>&#8212;<wbr></wbr>but also requires that <span class="stt">start</span> is called at most once and
before <span class="stt">extract</span> and <span class="stt">end</span>, the developer is again forced to describe this
relationship in informal prose. In short,
</div><div class="SIntrapara"><blockquote class="SCentered"><p>a component interface is more than a Java <span class="stt">interface</span>.</p></blockquote></div><div class="SIntrapara">To avoid confusion, we may occasionally use &ldquo;Interface&rdquo; using the capital
letter to emphasize the general nature of its meaning instead of the narrow
meaning of Java&rsquo;s (and other languages&rsquo;) <span class="stt">interface</span>.</div></p><p>In order to understand how interfaces relate components, we need to take a close
look at components. For a homework in an introductory course, a component may
<span class="refelem"><span class="refcolumn"><span class="refcontent"><a href="https://developer.android.com/reference/android/media/MediaPlayer">For an example, take a look at the interface of an
Android media player component.</a></span></span></span>  consist of a single class. A follow-up course
may ask students to combine a class with a Java-style interface&#8212;<wbr></wbr>for
practice. In a professional setting, a developer may have to read an interface
document of many pages to understand a component that comes with a dozen classes
or even more. On occasion, a component may itself play the role of an interface,
a situation that <a href="#%28counter._%28figure._fig~3aco-schematic%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">19</span></a> captures.</p><blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="component-as-interface.svg" alt="" width="588.06pt" height="215.622pt"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aco-schematic))" x-target-lift="Figure"></a>Figure&nbsp;19: </span>A component as an interface between two system layers</span></p></blockquote><p>When a component is just a single class, its code <span class="emph">is</span> the interface for
all the <span class="emph">objects</span> created from this class. For example, in Java all
<span class="stt">public</span> pieces are available to developers of client code in different
packages; all <span class="stt">private</span> pieces remain hidden; the class encapsulates these
pieces. And still, a client programmer must read the code to understand how the
object functions.</p><p>A (class) framework&#8212;<wbr></wbr>or just library in ancient days&#8212;<wbr></wbr>tends to come with an
interface document that reveals nothing about the code <span style="font-style: italic">per se</span> and that
assumes little to nothing about the client code. Such frameworks tend to consist
of many classes or modules. In Java, it is also going to include <span class="stt">interface</span>s,
though as mentioned, they do not describe the component&rsquo;s interface, neither
individually nor collectively. Introductory courses tend to use such frameworks
from the standard library of the chosen language.</p><p>Finally, some bespoke systems may contain components that play the role of an
interface. In this case, these interface components sit between two layers of
components, and making their code available is needed to completely clarify some
rules of interaction.  This kind of component is typically beyond
lower-curriculum courses and deserves an illustrative explanation.</p><p>So let&rsquo;s return to <a href="#%28counter._%28figure._fig~3aco-schematic%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">19</span></a>, which illustrates this idea
with a diagram. Concretely, the diagram can be understood as summarizing how the
game server for <span style="font-style: italic">Ticket to Ride</span>&#8212;<wbr></wbr>the sample project from the preceding
chapter&#8212;<wbr></wbr>and its clients interact. Recall the architecture from the right side
of <a href="part_three.html#%28counter._%28figure._fig~3asa-client-server-xyz%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">16</span></a>. It shows how the game server and the
hacker&rsquo;s game players live on distinct computers, interacting via means of remote
communication. <a href="part_three.html#%28counter._%28figure._fig~3agame-plan-fixed%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">17</span></a> displays a construction
plan. Focus on just the interface component in the third layer from the bottom;
it is supposed to specify how the referee from the game server interacts with the
logical player(s). As the dependency arrows in the diagram imply, designing and
expressing this interface relies on a thorough understanding of several other
components: the rule checker, the game state, and those representing the game
pieces. In this sense, the player-referee interfaces consist of not just
something like a Java <span class="stt">interface</span> but of knowledge about several specific
components.</p><h4 class="heading">13.1<tt>&nbsp;</tt><a name="(part._sec~3aontology)"></a>An Interface is the Common Ontology for Clients and Server<span class="button-group"><a href="#(part._sec~3aontology)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p>In some language contexts, developers think of component interfaces as essential
linguistic constructs for separating the specification of functionality from its
implementation; in others, it is just a mental separation of such pieces.  While
this separation is definitely an important aspect for all kinds of
reasons&#8212;<wbr></wbr>from clarity of purpose to separate compilation and variability of
implementation&#8212;<wbr></wbr>this view undercuts that every interface&#8212;<wbr></wbr>not just external
ones&#8212;<wbr></wbr>is primarily for human consumption. The true purpose of an interface is
to establish a common ground for conversations between the producing and
consumning developers of a component.</p><p><div class="SIntrapara">A consumer must completely understand the meaning of the pieces of an interface
to exploit the functionality of the server component properly. Typical uses
compose the pieces of functionality from an interface where &ldquo;composition&rdquo; may
mean a series of statements, including loops and conditionals, nested
expressions formed from the exported methods and functions; or any other form of
a composite phrase. No matter what, from a language perspective, an interface
provides a vocabulary for creating &ldquo;sentences&rdquo; and &ldquo;paragraphs&rdquo; from the
visible parts of a component.  functions and methods.  This perspective suggests
the following re-statement, using the terminology of linguists:
</div><div class="SIntrapara"><blockquote><p> an interface provides a <span class="emph">common ontology</span> for the
producers and consumers of a server component.</p></blockquote></div><div class="SIntrapara">&ldquo;Common ontology&rdquo; is a concise phrase for saying that an interface determines
the precise meaning of the specified vocabulary. Here &ldquo;vocabulary&rdquo; denotes the
words (names of types; function and methods names; the pieces of their
signatures; and so on) mentioned in the interface.  And &ldquo;determines the
meaning&rdquo; says that an interface must make sure a reader understands how to use
these words properly, especially their proper use in context, their
relationships, and anything else that may affect communication between
components.</div></p><p><div class="SIntrapara">To make this concrete, consider a software system that controls an autonomous
vehicle. Such a system must deal with distances. The very word&#8212;<wbr></wbr>or an allusion
to the concept&#8212;<wbr></wbr>will show up in some interfaces. The developers have to agree
on its meaning. They can ask questions such as
</div><div class="SIntrapara"><ol><li><p>distance from where to where?</p></li><li><p>distance measured in terms of which units?</p></li></ol></div><div class="SIntrapara">Question 1 addresses the difference between theory and practice of mechanics.
In a theoretical course on mechanical physics, calculations tend to assume an
object is a point. A software developer in an autonomous vehicle team cannot
make such an assumption; the vehicle has an extent and that extent must be taken
into account. So the answer to the question clarifies on which two points the
distance measurement is based.  Question 2 is especially critical in a country
such as the United States, which has not accepted the metric system but whose
engineers often work with colleagues in countries that have.</div></p><p><div class="SIntrapara">So imagine yourself encountering the following interface element during a
design inspection:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">interface Vehicle:</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">int moveRight(int distance)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr></table></div><div class="SIntrapara">You must insist on a clarification from its creator. While a presenter may
verbally clarify the interpretation, you must further insist that this
clarification becomes a part of the method&rsquo;s purpose statement. Conversely, it
is easy to see that without a clarification, things can go horribly wrong.</div></p><p>A common ontology may require a lot more than a simple comment that explains the
meaning of a parameter.  Let&rsquo;s once again take a close look at what a &ldquo;hacker&rdquo;
needs to understand in order to participate in the board-game tournaments of our
running example. It is best to start with a close look at
<a href="part_three.html#%28counter._%28figure._fig~3agame-plan-fixed%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">17</span></a>, focusing on the <span class="stt">player interface</span>
component. As the inspection of the construction plan revealed, the interface is
best understood in terms of the game state to which a <span class="stt">player</span> component has
access. In turn, this data structure refers to the map, the colored cards, the
destinations, and the rails. A &ldquo;hacker&rdquo; can implement a player only with a
complete understanding of these pieces. But this is not all. Additionally, a
&ldquo;hacker&rdquo; must also know the protocol of how the referee interacts with the
player.</p><p><div class="SIntrapara">Here then is a list of all the pieces that belong to the common ontology of our
running case study, starting with the least important but not to be overlooked
piece:
</div><div class="SIntrapara"><ul><li><p>the rails</p></li><li><p>the cards</p></li><li><p>the destinations</p></li><li><p>the map</p></li><li><p>the game state</p></li><li><p>the protocol: how the methods are called and in what order.</p></li></ul></div><div class="SIntrapara">To drive home how all this matters, consider the methods for starting a railroad
game. A refined design may consist of two methods, whose plain signatures in a
Java-like programming notation are like this:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">void mapForTheGame(GameMap m)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Set[Destinations] choose(Set[Destinations] from)</span></p></td></tr></table></div></p><p><div class="SIntrapara">Now consider the following questions about this variant:
</div><div class="SIntrapara"><ul><li><p>Which set of <span class="stt">Destinations</span> should <span class="stt">choose</span> return? The ones that the
player picked or the ones the player rejected?</p></li><li><p>Which call order makes the most sense for these methods? 
Should the player know that <span class="stt">mapForTheGame</span> is called only once?</p></li></ul></div><div class="SIntrapara">These questions illustrate just how important it is to establish a comprehensive
understanding for the vocabulary of an interface, to nail down the meaning of
all functions, methods, and other pieces of an interface. Put differently, the
answers to such questions make up an interface; otherwise it does not provide a
common ontology.</div></p><p><a name="(counter._(exercise._ex~3aprotocol))"></a><span style="font-weight: bold">Exercise</span>&nbsp;8. Provide answers for the above two questions. Justify
your answers. Work through these points with a partner.<a href="#%28counter._%28exercise._ex~3aprotocol%29%29" class="ex-end" data-pltdoc="x"></a></p><p>Different kinds of interfaces call for different kinds of common ontologies. For
library interfaces and for the interfaces of plug-in frameworks, the common
ontology is often the responsibility of its developer, and the consumer is
typically an anonymous developer. Ensuring that the interface is properly
explained calls for thorough in-person inspections and reactions to on-line
reviews.  For bespoke interfaces specifically created for a software system, the
producer of the server module and its consumers may jointly develop the common
ontology; for an inspection, they may wish to get a third party involved to
overcome &ldquo;group think.&rdquo;  When the consumer of a bespoke interface is unknown,
the authors of the interface document should revisit and inspect it with the
help of actual an end-users once the product has been soft-launched.</p><p><span style="font-weight: bold">Reading</span></p><p>Ajay Harish. When NASA Lost a Spacecraft Due to a Metric Math
Mistake. 2021.&#8212;<wbr></wbr>Harish summarizes a NASA crash story from the late 1990s, when
the agency launched the Mars Climate Orbiter. The Orbiter, a space probe,
<span class="refelem"><span class="refcolumn"><span class="refcontent"><a href="https://www.simscale.com/blog/2017/12/nasa-mars-climate-orbiter-metric/">Harish
at Simscale</a></span></span></span> was to explore the Martian atmosphere and surface changes. In
burned up and broke into pieces, because its software developers had not
developed a common ontology. The story is widely studied in engineering and
software circles; also research the story on-line.</p><h3 class="heading">14<tt>&nbsp;</tt><a name="(part._ch~3amodules)"></a>Encapsulation via Interfaces<span class="button-group"><a href="#(part._ch~3amodules)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p>While equipping a component with an interface has the primary objective to
create a common ontology for producers and consumers, it also means that the
existence of an interface relieves developers from reading the entire code of a
component just because they need its services.  Conversely, a component producer
can rely on the existence of an interface in two ways. First, if the interface
is written down up front, it can guide the implementation effort. See the next
chapter for this idea. Second, the producer can use the interface to isolate
design decisions from the rest of the system and thus keep open the option to
change them in the future.</p><p>As mentioned, developers and programming language researchers speak of
encapsulation or say that the design decision is encapsulated. Language
designers recognized the importance of encapsulation a long time ago and added
various forms of <span class="emph">syntactic</span> support to express and check some aspect of
interfaces as part of the compilation process. For example, Simula&rsquo;67
implemented <span class="stt">private</span>, <span class="stt">protected</span>, and <span class="stt">public</span> class annotations by
the early 1970s so that programmers could separate what consumers should read
from what they could skip. By the 1990s, typed programming languages offered
linguistic constructs for specifying the interface of a component separately
from the implementing code. Developers working with untyped programming
languages must establish and follow some () discipline to
express the same kind of separation.</p><p><div class="SIntrapara">Encapsulation is far more, however, than annotating the members of a class or
writing an interface for a module. If encapsulation means &ldquo;housing a design
decision in a single hiding place,&rdquo; then mere syntactic annotations simply do
not suffice. To capture this difference, researchers recommend the simple policy of
</div><div class="SIntrapara"><blockquote><p><span class="emph">hiding those pieces of knowledge of a component that restrict future
changes to a data representation to this one component.</span></p></blockquote></div><div class="SIntrapara">This kind of knowledge encompasses many parts, including the chosen data
representation, its interpretation, some functionality, and much more.</div></p><h4 class="heading">14.1<tt>&nbsp;</tt><a name="(part._sec~3aencapsulation)"></a>Interface Inspections for Encapsulation<span class="button-group"><a href="#(part._sec~3aencapsulation)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p>To gain a solid understanding of the encapsulation concept, let&rsquo;s study yet
another game that could be used in the context of the running game-server
example (see <a href="part_three.html#%28part._ch~3asample-project%29" data-pltdoc="x">A Sample Project: Analysis, Discovery, Planning</a>):</p><blockquote><p>Qwirkle is a game that challenges players to construct an unbounded, contiguous
arrangement of rectangular tiles. Each tile displays a shape in one of six
colors.  A player may add a tile to the map as long as one of its sides is
aligned with the side of an already-present tile. Furthermore, the new tile must
satisfy certain constraints regarding the shapes of all neighboring tiles, those
to its left, right, top, and bottom.</p></blockquote><blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="qwirkle-map-diagram.svg" alt="" width="833.33446713pt" height="374.39820000000003pt"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3acoordinate-enscapsulation))" x-target-lift="Figure"></a>Figure&nbsp;20: </span>Encapsulating knowledge (a Qwirkle map data representation)</span></p></blockquote><p>This description clearly identifies four pieces of information: the
<span class="emph">arrangement</span>, which consists of <span class="emph">tiles</span> plus their <span class="emph">shapes</span> and
<span class="emph">colors</span>. Less obviously, it includes the information concept of neighbor,
that is, that each tile has at least one and up to four neighbors. One
straightforward way to represent neighbor uses a notion of <span class="emph">coordinate</span>,
associating each tile in the arrangement with one place.</p><p><a href="#%28counter._%28figure._fig~3acoordinate-enscapsulation%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">20</span></a> presents a plan in the form of a
doodle diagram. It sketches the four concepts and their relationship.  Each box
denotes a data representation of an information concept. The <span class="stt">Map</span> box
represents the arrangement of tiles; it suggests the use of a collection to
create an association between <span class="stt">Tile</span>s and <span class="stt">Coordinate</span>s. The former
combines an instance of <span class="stt">Color</span> with an instance of <span class="stt">Shape</span>, just as the
informal description indicates.</p><p><div class="SIntrapara">The intention behind such a diagram is to convey, from this perspective, several
important ideas to the future maintainer of this component
</div><div class="SIntrapara"><ol><li><p><span class="stt">Map</span> is the key class, and all knowledge about the tile arrangement is
found there;</p></li><li><p>similarly, <span class="stt">Coordinate</span>, <span class="stt">Tile</span>, <span class="stt">Color</span>, and <span class="stt">Shape</span> are the
classes that collect the knowledge about the respective information concepts;
and</p></li><li><p>if any client module needs a service about any of these five concepts, it
must consult the respective class.</p></li></ol></div></p><p><div class="SIntrapara">Instead of discussing encapsulation abstractly, let&rsquo;s see how a code inspection
might deal with the concept:
<span class="refelem"><span class="refcolumn"><span class="refcontent">This conversation is a simple code walk. See the next chapter for
many more examples.</span></span></span>
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Hi. I am presenting the design of the central data representation for the Qwirkle game. Here is the class diagram (<a href="#%28counter._%28figure._fig~3acoordinate-enscapsulation%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">20</span></a>). </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Could you explain the <span class="stt">Coordinate</span> class first? It looks suspicious because it comes with getters for the X and Y fields? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Sure. Here is the code for the coordinate class (<a href="#%28counter._%28figure._fig~3abad-encapsulation-server%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">21</span></a>). It comes with a purpose statement. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> This is a comprehensive purpose statement with the inclusion of the second line. But what is the interpretation of a <span class="stt">Coordinate</span> object? </p></td></tr></table></div></p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// represents either the location of tiles in the map</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// or: places where a player may wish to place a tile</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">class Coordinate {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">private int x;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">private int y;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">public int getX() { return x; }</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">public int getY() { return y; }</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3abad-encapsulation-server))" x-target-lift="Figure"></a>Figure&nbsp;21: </span>A Java-style class for representing coordinates</span></p></blockquote><p>We stop here and look back. The panel takes control of the code inspection
because the diagram alone may suggest a problem. While the presenter and the
panel could discuss this potential problem abstractly, working with the actual
code is best in this situation.</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>Interpretation? </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Well, an X-Y pair may denote Cartesian or computer coordinates. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Ah, we had the standard computer-graphics meaning in mind. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> This statement should be added to the class so that a reader of the code doesn&rsquo;t have to dig through the entire class to find out.</p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  I will make sure an interpretation gets added. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Why does the class include plain getters for the fields? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  The two integers are private. But the <span class="stt">Map</span> class needs access to their values. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> What for? And how are they used? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Here is the code for <span class="stt">Map</span> (<a href="#%28counter._%28figure._fig~3abad-encapsulation-client%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">22</span></a>). </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Where do the getters used? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  All the computations matching a tile to its potential neighbor use the getters. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Let&rsquo;s take a look. </p></td></tr></table></div><div class="SIntrapara">Stop! Can you already guess what the panelist is getting at?</div></p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">class Map {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">private Assoc&lt;Tile, Coordinate&gt; assoc = ...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">// would `toBePlaced` at coordinate `atC` match</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">// the color and shape of its up neighbors</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Coordinate up</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= new Coordinate(atC.getX(), atC.getY() - 1);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Is&lt;Tile&gt; neighbor = this.assoc.retrieve(up);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Boolean matchesUp = !(neighbor.none()) &amp;&amp; this.match(neighbor.some(), atC);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3abad-encapsulation-client))" x-target-lift="Figure"></a>Figure&nbsp;22: </span>A Java-style method in the <span class="stt">Map</span> class for Qwirkle</span></p></blockquote><p><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>It&rsquo;s probably best to look at the computation that makes sure tiles match an up neighbor. These three lines are the key.  </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> This comment cleanly separates one direction from the other. Can you explains the three lines? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  The first line computes the place that is exactly above the given coordinate. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> How does this computation work? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  It retrieves X and Y parts, subtracts 1 from the latter, ... </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Stop. Why does it subtract 1? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Isn&rsquo;t it the natural way to determine the Y part of the place above the given <span class="stt">c</span>? </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Only if the person who reads the code of <span class="stt">Map</span> also knows the interpretation of the <span class="stt">Coordinate</span> class </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Oh. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> .. which isn&rsquo;t even written down.</p></td></tr></table></p><p>At this point, the panelists have clarified why the <span class="stt">Coordinate</span> class does
<span class="emph">not</span> encapsulate the coordinate information concept from the problem
statement. Even though the <span class="stt">x</span> and <span class="stt">y</span> fields are private and thus hidden,
exposing plain getters leaks knowledge that should stay internal to the class,
specifically its interpretation. Here the presenters know that the
interpretation of <span class="stt">Coordinate</span> is the normal computer-graphics meaning, that
is, if <span style="font-style: italic">y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"> &lt; y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span>, then <span style="font-style: italic">y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> is <span class="emph">above</span> <span style="font-style: italic">y</span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span>. Thus
computing <span class="stt">atC.getY() - 1</span> gets the correct result in this case. If, for some
reason however, the instances of the <span class="stt">Coordinate</span> class should be interpreted
as ordinary Cartesian coordinates, changing just <span class="stt">Coordinate</span> will not work.</p><h4 class="heading">14.2<tt>&nbsp;</tt><a name="(part._sec~3areact-encapsulation)"></a>Encapsulating Properly<span class="button-group"><a href="#(part._sec~3areact-encapsulation)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p><div class="SIntrapara">The code walk&rsquo;s focus on encapsulation leads to a general lesson about.  The
developer of a component who wishes to encapsulate knowledge must ask
</div><div class="SIntrapara"><blockquote><p><span class="emph">whether a change in interpretation or any
internal code can possibly affect application code, i.e. code that uses the
functionality of the class or module.</span></p></blockquote></div><div class="SIntrapara">If so, we say that the interface is too wide. Conversely, a component&rsquo;s
interface should be sufficiently narrow so that essential knowledge doesn&rsquo;t
leak. &ldquo;Narrow&rdquo; means do not expose functions or methods that enable client
programmers to exploit the internals of the component. While fields and some
methods are obviously internals, the informal data interpretation may have to
count, too, especially if the interface includes plain getters.</div></p><p>In Java, and many object-oriented languages, the most basic meaning of
&ldquo;interface&rdquo; is the collection fields, methods, and other pieces of an object
design that are accessible to a client programmer. This collection may or may
not come with a Java <span class="stt">interface</span> or an Interface document; indeed, a Java
component may need both.</p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0"><tr><td valign="top"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">interface ICoordinate {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// INTERPRETATION</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// a data representation</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// for Map coordinates</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// the place logically</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// above `this` coordinate</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Coordinate above();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Coordinate below();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Coordinate left();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Coordinate right();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></table></td><td valign="top"><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td valign="top"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">class Coordinate {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">private int x;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">private int y;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">public Coordinate above() {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">int newX = this.x;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">int newY = this.y-1;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">return</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">new Coordinate(newX, newY)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr></table></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3agood-encapsulation-server))" x-target-lift="Figure"></a>Figure&nbsp;23: </span>A Java-style class for an <span class="emph">encapsulated</span> coordinate representation</span></p></blockquote><p>Let&rsquo;s take a look at how a Java developer could react to the code inspection.
The minimal reaction is to remove the getters from the class; in their place,
the class comes with methods that determine the coordinates of neighboring
places. For example, the code snippet of the <span class="stt">Map</span> class (in
<a href="#%28counter._%28figure._fig~3abad-encapsulation-client%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">22</span></a>) would use the method <span class="stt">above</span> to
compute the value of <span class="stt">matchesUp</span>. See the right-hand side of
<a href="#%28counter._%28figure._fig~3agood-encapsulation-server%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">23</span></a> for the result of such a revision.</p><p>The left-hand side of <a href="#%28counter._%28figure._fig~3agood-encapsulation-server%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">23</span></a> displays a
second, complementary way of reacting to the criticism&#8212;<wbr></wbr>if the coordinate class
should be considered a component.  The displayed <span class="stt">interface</span> hints at what an
Interface document might look like. Here the Interface consists of a simple data
<span class="refelem"><span class="refcolumn"><span class="refcontent">An instructor of a course on object-oriented programming may ask
students to design an interface per class as just such an exercise.</span></span></span>
interpretation statement, plus the signatures and purpose statements of methods
that compute the four coordinates of immediate neighbors. That is, the document
consists of a mix of actual code, say, a Java <span class="stt">interface</span> and plain English.
The next section tackles the task of how to design Interfaces for different
kinds of components.</p><h3 class="heading">15<tt>&nbsp;</tt><a name="(part._sec~3aapi-design)"></a>Designing an Interface<span class="button-group"><a href="#(part._sec~3aapi-design)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><p><a href="#%28counter._%28figure._fig~3ainterface-schematic%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">18</span></a> shows two ways of looking at an interface:
as the producing developer and as the consuming one.  From the perspective of
the first, it is the document that guides the implementation. The component must
live up to this interface; it must implement the promised functionality and
everything else that the document says it delivers. From the perspective of the
second, it is the document that tells everyone how to use the component.</p><p>As such, the figure suggests that an interface is the result of a
&ldquo;negotiation&rdquo; between the two parties. In many cases, a consumer would like to
get a lot more functionality than the producer wishes to show. The consumer may
even like to know more about the design decisions and the resulting
implementation details than the producer wishes to make publicly visible.</p><p>The word &ldquo;negotiation&rdquo; seems to imply that the producer knows the consumer but
this clearly isn&rsquo;t always the case. A component might be one-of-a-kind, a part
of a large bespoke system, and the two parties know each other to actually
negotiate the interface.  Historically, component meant a library. Once
developers primarily used object-oriented languages, these components became
frameworks, such as the game server analyzed in the preceding chapter. Given
this variety, the design of an interface is clearly not going to follow one and
only way either.</p><p>Since the role of an interface includes encapsulation of design decisions,
understanding the interface-design process can start with asking how future
changes affect an interface. When a change of a bespoke component affects its
interface&#8212;<wbr></wbr>the result of an actual negotiation between two parties&#8212;<wbr></wbr>the
producer can alert the consumer, who, in turn, can search the code base for
potential problems. For example, if some visible function must consume an
additional argument, the creator of client just looks for applications of this
function and fixes those call sites.</p><p>By contrast, the producers of a library or framework rarely know their consumers
and must therefore be much more careful about changes. In many cases, changing
the interface is nearly impossible. External programmers and developers may have
created extensive bodies of code relying on the published interface.  Hence,
removing functionality is essentially impossible, which imposes constraints on
changes to internals of the component. Adding named functionality to the
interface may interfere with names that client programmers chose for something.
Finally, even changing a &ldquo;bug&rdquo;&#8212;<wbr></wbr>meaning a contradiction between interface
elements and implementation&#8212;<wbr></wbr>may affect the behavior of client code; consumers
may have developed elaborate work-arounds for such short-comings.</p><p><a name="(counter._(exercise._ex~3ajava-poly))"></a><span style="font-weight: bold">Exercise</span>&nbsp;9. Research how the designers of Java introduced modified
libraries when they added expressive power to the type
system&#8212;<wbr></wbr>parametric-polymorphic types, often called generics. By adapting the
run-time libraries interfaces, they could promise that the compiler would catch
certain classes of problems at compile time.<a href="#%28counter._%28exercise._ex~3ajava-poly%29%29" class="ex-end" data-pltdoc="x"></a></p><p>In sum, designing library and framework interfaces requires considerations in
two directions&#8212;<wbr></wbr>producers and consumers; demands some foresight into what the
latter may need from the former; and in general just deserves great care.  With
this much understood, let&rsquo;s consider what goes into the design of an interface:
the content and the process.</p><p><div class="SIntrapara"><span class="emph">Content</span> The preceding sections implicitly suggest a number of
items that show up in basically every interface:
</div><div class="SIntrapara"><ul><li><p>It should start with a succinct, focused purpose statement.</p></li><li><p>When needed, it should include a possibly partial interpretation of the
implemented data representation(s).</p></li><li><p>It should specify the functionality that the component makes
available. These specifications typically contains the following kinds
of functionality, though not necessarily all:</p><ul><li><p>ways to create or initialize a component;</p></li><li><p>ways to observe properties of the state of the component;</p></li><li><p>ways to extract properties from the state of the component; and</p></li><li><p>ways to modify the component&rsquo;s state.</p></li></ul><p>Each of these specifications states the name of the functionality; its purpose
(unless the name is truly bringing across what the function computes); a
signature, possibly expressed as a comment if the underlying language is
untyped; and any constraints that the signatures cannot express.</p></li><li><p>Finally, an interface often comes with constraints on pieces of
functionality or the interaction of various pieces of functionality.</p></li></ul></div><div class="SIntrapara">While the above list covers a lot of ground, interface documents differ from
case to case, in particular, depending on the role they play relative to a
system and depending on whether their creators know the consuming developers.</div></p><blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="feedback-loop.svg" alt="" width="588.06pt" height="196.02pt"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3afeedback-loop))" x-target-lift="Figure"></a>Figure&nbsp;24: </span>Feedback loop for the design of interfaces</span></p></blockquote><p><span class="emph">Process</span> Given the nature of an interface as the result of a &ldquo;negotiation,&rdquo;
the design process should involve both parties.  The creator is clearly in charge
of proposing drafts of an interface. But, a representative consumer must often, and
perhaps continuously, check whether it is possible to get work done with the
proposed interface. If the consumer representation determines that the interface
lacks functionality or is too inconvenient to use, it is back to the drawing board
for the producer of the component.</p><p>What these sentences describe is a feedback loop.  <a href="#%28counter._%28figure._fig~3afeedback-loop%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">24</span></a>
shows the essential elements of this interface-design feedback loop. The process
starts with the vague idea cloud on the left, which symbolizes the perceived
purpose of the component and its publicly visible pieces. Once the developer writes
down a draft of the component&rsquo;s interface, someone must inspect this draft from the
perspective of writing a client component. This evaluation step results in
suggestions on how to modify either the starting point or the written document or
both. Once the interaction has converged on an interface document, the producing
developer can (finish) implement(ing) the component&rsquo;s internals.</p><p>Keeping this feedback loop in mind, let&rsquo;s take a close look.  Like for any building
block in the world of software development, the design process for interfaces must
start with a focused purpose statement. Without such a statement, it is too easy to
pack too much functionality into an interface or even too little. That is, when
during the somewhat parallel development of the component and its interface
questions arise as to where functionality should reside, a focused statement can
help answer them.</p><p><div class="SIntrapara">An alternative look at the sample problem from the preceding section illustrates
this point. The panelists could have asked the creators of the <span class="stt">Coordinate</span>
class what the purpose statement exactly means. Concretely, they could have asked
</div><div class="SIntrapara"><blockquote><p>&ldquo;if the class represents coordinates, why are there basic
computations on coordinates in the <span class="stt">Map</span> class?&rdquo;</p></blockquote></div><div class="SIntrapara">Once the inspection clarifies that the purpose statement means basic computations
on coordinates must happen in the <span class="stt">Coordinate</span>s class. This focused purpose
statement also answers the next question, namely, which functionality to add in
place of these generic observers. Since the presenter&rsquo;s client needs the neighbors
of a coordinate, adding four corresponding methods solves the problem.</div></p><p><div class="SIntrapara">Generally speaking, a focused purpose statement helps with the balancing act of
deciding
</div><div class="SIntrapara"><ul><li><p>which parts of the component must remain hidden; and</p></li><li><p>which parts to make public and what explanations are needed so that client
programmers can get their work done.</p></li></ul></div><div class="SIntrapara">Unsurprisingly, at this early stage, it is also common to consider alternatives,
mostly for the proposed pieces of functionality.</div></p><p>For the first aspect, the authors of interfaces must decide how much of the data
interpretation to encapsulate. It is the interpretation that really describes
hidden pieces. Take the <span class="stt">Coordinate</span> class as an example again, a client
programmer doesn&rsquo;t need to know whether the coordinates are of the Cartesian or
computer-graphics kind. Even the existing purpose statement implies this much.
Hence the interface designed should not make any functionality available that
allows client code to determine the Y dimension of a coordinate.</p><p>For the second aspect, the authors of the interface must imagine the use contexts
with the goal of identifying desirable functionality. In the case of one-of-a-kind
components, the system specification usually provides a sufficient number of
hints. The code inspection of the preceding section exposed one concrete use case,
and this use case also clarifies the exact functionality needed from the
<span class="stt">Coordinate</span> class. When it comes to libraries, the interface authors must use
their imagination as to how developers may wish to use the component&rsquo;s
functionality.</p><p><div class="SIntrapara">In sum then, the process works as follows:
</div><div class="SIntrapara"><ol><li><p>start by writing down a focused purpose statement</p></li><li><p>imagine a client component by name</p></li><li><p>informally write down descriptions of public information:</p><ul><li><p>a data interpretation;</p></li><li><p>the purpose of the pieces of functionality;</p></li><li><p>signatures, formal ones if a typed language is used;</p></li><li><p>any additional constraints on the latter.</p></li></ul></li><li><p>sketch use cases based on the informal interface description;</p></li><li><p>formulate alternatives, based on these use-case considerations;</p></li><li><p>inspect the informal design and request comments</p></li><li><p>re-start at step 3 or even step 1, until the process converges.</p></li></ol></div><div class="SIntrapara">Once an inspection does not uncover major gaps or problems, a developer will begin
to work on <span class="emph">expressing</span> the interface properly and on the implementation.
Right now, though, it is time to work through a simple example.</div></p><h4 class="heading">15.1<tt>&nbsp;</tt><a name="(part._sub~3aif-example1)"></a>Inspecting Simple Interface Designs<span class="button-group"><a href="#(part._sub~3aif-example1)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p>The diagram of <a href="#%28counter._%28figure._fig~3acoordinate-enscapsulation%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">20</span></a> is a good starting point
for illustrating how a software developer may develop an interface. Recall that the
figure relates data representations of all the Qwirkle game pieces, plus the
synthetic <span class="stt">Coordinate</span> class and their relationships. So imagine that a
developer for our game-server start-up wishes to write down an Interface for this
component. Notice the capital &ldquo;I&rdquo; because this section is not about a Java
<span class="stt">interface</span> even though it ends up using Java notation.</p><p><div class="SIntrapara">Following the above summary, the developer states a purpose:
</div><div class="SIntrapara"><blockquote><p>The component represents all basic game pieces for a
variant of the Qwirkle game.</p></blockquote></div><div class="SIntrapara">The diagram identifies the data representations needed based on the problem
statement, plus the <span class="stt">Coordinate</span> class, which is needed to refer to places on
the existing configuration of tiles or free spaces next to it.</div></p><p>As for clients of this component, two come to mind: the referee that resides on the
game server and the player that the start-up team must produce to test the referee.
Both need to create, inspect, and manipulate maps and the tiles that make up these
maps. The referee must maintain the map that all players see; as such it must be
able to create the initial map, add tiles on behalf of players, check the legality
of such player requests, and so on. A player component may need to compare the
value of two distinct maps, each created by adding different tiles to the map that
it receives when it is told to take a turn.  These rough sketches of client suggest
that three classes definitely must be public: <span class="stt">Map</span>, <span class="stt">Tile</span>, and <span class="stt">Coordinate</span>.</p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">**Component** : represents</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">all basic game pieces for Qwirkle</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Its public classes and their public methods:</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- Map : a data representation of a contiguous collection of tiles</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- create : creates the map, from a starter tile, so that we do</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">not have to deal with the degenerate case of an empty maps</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- adjacentPlaces : delivers the coordinates where tiles can</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">be added to `this` map</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- addTile : adds a tile to `this` map at coordinate `c` that</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">is adjacent to an existing tile</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">CONSTRAINT: `c` is in `this.adjacentPlaces()`</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- fits : checks whether a tile would fit at coordinate `c`</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">according to the rules</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- render : display `this` map as an image</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">RATIONALE: looking at a visual presentation of facilitates</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">the creation of unit tests</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- Tile : a data representation of (valid) tiles</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- create : creates a tile from a shape and a color;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">CONSTRAINT: consumes plain strings, then checks validity</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- getters for shapes and colors (returns strings)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">- Coordinate : a data representation for places on a Map</span></p></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3apieces-if-1))" x-target-lift="Figure"></a>Figure&nbsp;25: </span>A draft interface for the basic games pieces component</span></p></blockquote><p>Equipped with a purpose statement and a quick look at client components, our
imaginary developer can enumerate some basic and public pieces of functionality for
the three classes that are going to be public. <a href="#%28counter._%28figure._fig~3apieces-if-1%29%29" data-pltdoc="x">Figure&nbsp;<span class="FigureRef">25</span></a>
displays the result of this first attempt.</p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// ignore the !isPresent() case</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Placement pickNextCoordinate() {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Stream&lt;Coordinate&gt; free = map.adjacentPlaces().stream();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Coordinate best_coord</span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">= free.findFirst().get();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Tile best_tile</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">= this.availableTiles.get(0);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">for(Tile t : this.availableTiles) {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Stream&lt;Coordinate&gt; legal =</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">free.filter(c -&gt; map.fits(c,t));</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">Coordinate best_t</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">=</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">legal.max((c, d) -&gt; evaluate(c,t) &gt; evaluate(d,t)).get();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">if (evaluate(best_t, t) &gt; evaluate(best_coord, best_tile)) {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">best_coord = best_t;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">best_tile = t;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">return new Placement(best_coord, best_tile);</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aclient-example))" x-target-lift="Figure"></a>Figure&nbsp;26: </span>A sketch of a method for picking a player&rsquo;s next tile placement</span></p></blockquote><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="refelem"><span class="refcolumn"><span class="refcontent">Could 17 or 17.1 be incorporated into this chapter to illustrate
weighing alternatives?</span></span></span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">let's work through an example with an interface for the component that represents</span></p></td></tr><tr><td><p><span class="stt">all the Qwirkle game pieces</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">then let's work through one aspect of a complex example to study serious</span></p></td></tr><tr><td><p><span class="stt">alternatives:</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">-- feedback-loop style design often means presenting and discussing alternatives.</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- one aspect to consider: once the functionality interface is done and a first</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">implementation of the component exists, it may already be time to consider</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">simple performance stress tests. Example: queue</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">-- after release: be prepared to fix; it is critical to backwards compatible as</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">much as possible</span></p></td></tr></table></p><h3 class="heading">16<tt>&nbsp;</tt><a name="(part._sec~3aapi-expression)"></a>Expressing an Interface<span class="button-group"><a href="#(part._sec~3aapi-expression)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// represents either the location of tiles in the map</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// or: places where a player may wish to place a tile</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">interface ICoordinate {</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// INTERPRETATION a computer-graphics coordinate</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// the coordinate directly above this one</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Coordinate above();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// the coordinate directly below this one</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Coordinate below();</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">}</span></p></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3ainterface))" x-target-lift="Figure"></a>Figure&nbsp;27: </span>A Java-style interface for the <span class="stt">Coordinate</span> class from <a href="#%28counter._%28figure._fig~3agood-encapsulation-server%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">23</span></a></span></p></blockquote><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">expression:</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">- types: static checks; highly successful</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">- behavioral contracts; often documented</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">- pure pre and post conditions;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">- dependency on argument -- does it get checked in the post condition?</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">- protocols: almost always documented only</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">- order of calls</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="stt">- history dependency of calls</span></p></td></tr></table></p><p>contracts !!</p><p>Here is a piece of functionality:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define (create width height channels colorspace)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(unless (&gt; width 0)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(error 'create "expected width &gt; 0: ~a" width))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(unless (&gt; height 0)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(error 'create "expected height &gt; 0: ~a" height))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define size (* width height))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(unless (&lt;= size P-MAX)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(error 'create "expected width * height &lt;= ~a: ~a" P-MAX) size))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(unless (&lt;= 3 channels 4)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(error 'create "expected channels = 3|4: ~a" channels))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(unless (&lt;= 0 colorspace 1)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(error 'create "expected colorspace</span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">= 0|1: ~a" colorspace))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define load (make-bytes (* 4 size)))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(private-image width height channels colorspace load))</span></p></td></tr></table></div><div class="SIntrapara">Can you spot the computation that the method actually performs?</div></p><p>Instead write a contract that informs client programmers about the constraints:</p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">[create</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(-&gt; (and/c integer? (&gt;/c 0))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(and/c integer? (&gt;/c 0))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(between/c 3 4)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(between/c 0 1)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">image?)]</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define (create-image width height channels colorspace)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define size (* width height))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(unless (&lt;= size P-MAX)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(error 'create "expected width * height &lt;= ~a: ~a" P-MAX size))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define load (make-bytes (* 4 size)))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(private-image width height channels colorspace load))</span></p></td></tr></table></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3acontract1))" x-target-lift="Figure"></a>Figure&nbsp;28: </span>Contract 1</span></p></blockquote><p>If it is critical to let the &ldquo;client&rdquo; of <span class="stt">create</span> know about the
<span class="stt">size</span> restriction, incorporated a constraint into the contract:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">[create</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(-&gt;i ([width (and/c integer? (&gt;/c 0))]</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[height (and/c integer? (&gt;/c 0))]</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[channels (between/c 3 4)]</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[colorspace (between/c 0 1)])</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">#:pre (width height) (&lt;= (* width height) P-MAX)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">(r image?))]</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define (create-image-2 width height channels colorspace)</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define size (* width height))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(define load (make-bytes (* 4 size)))</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;&nbsp;</span><span class="stt">(private-image width height channels colorspace load))</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">- the ``game plan''</span></p></td></tr><tr><td><p><span class="stt">- the milestones, planning one step ahead</span></p></td></tr><tr><td><p><span class="stt">- iterative: refine as you go but keep the overall idea in mind</span></p></td></tr><tr><td><p><span class="stt">- contracts?</span></p></td></tr></table></p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">: Methods and Functions are the Basic Building Blocks</span></p></td></tr><tr><td><p><span class="stt">- keep them small</span></p></td></tr><tr><td><p><span class="stt">- develop them systematically: design recipe</span></p></td></tr></table></p><h3 class="heading">17<tt>&nbsp;</tt><a name="(part._ch~3adesign-alt)"></a>Interface Inspections, Systematically<span class="button-group"><a href="#(part._ch~3adesign-alt)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h3><blockquote class="SCentered"><p>Reconcile with the below</p></blockquote><p><div class="SIntrapara">In the running example, the external interface between <span class="RktSym">referee</span><span class="RktMeta"></span> and
<span class="RktSym">player</span><span class="RktMeta"></span> is critical to the entire enterprise. Its pieces therefore deserve
a thorough inspection, like the one in the preceding section, which focused on
the logic and the temporal relationships. Recall <a href="#%28counter._%28figure._fig~3aplayer-rest%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">29</span></a>
and how the inspection forced the presenter to clarify the timing of player
notifications relative to game-state changes. The method documentation
explicitly states
</div><div class="SIntrapara"><blockquote><p>the player is informed of any change to the publicly 
visible state of the game as soon as it happens</p></blockquote></div><div class="SIntrapara">The &ldquo;hacker&rdquo; participating in these game tournaments may consider such a
constraint critical, because it allows a speculative approach to determining
future turn responses. Hence, supplementing the formal interface with such
informal comments and even diagrams is critical, because these constraints
aren&rsquo;t expressible.</div></p><p>A combination of formal code with informal comments has direct implications for
the development process. While language implementations can check the formal
elements of interfaces, the informal ones don&rsquo;t undergo any mechanical
validation. Hence, implementing interfaces or referring to them in other modules
quickly reveal flaws in their formal elements. The informal ones, however,
aren&rsquo;t subjected to this form of mechanical checking and tend to remain flawed
more easily. It falls to the team as a whole to ensure that the interface
component is complete, logically coherent, and unambiguous.</p><p>Frequent and thorough inspections can help achieve this satisfactory mix of
formal and informal interface elements. For external interfaces, it is also
necessary to work with the person in charge of writing the visible
documentation. Indeed, once a team thinks some interface documentation is ready
for release, it should still ask an outsider&#8212;<wbr></wbr>a developer unfamiliar with the
specification and the implementation&#8212;<wbr></wbr>to use it and to provide feedback on its
(lack of) clarity and completeness. To clarify this point, the remainder of this
section explains what such interfaces actually are.</p><h4 class="heading">17.1<tt>&nbsp;</tt><a name="(part._sec~3aintf-inspection)"></a>Inspections and Design Alternatives<span class="button-group"><a href="#(part._sec~3aintf-inspection)" class="heading-anchor" title="Link to here">ðŸ”—</a><span style="visibility: hidden"> </span></span></h4><p>The inspection of the construction plan points to an implicit design decision
when one of the reviewers asks about the back-and-forth between referees and
players. As imagined, the conversation glosses over the rather obvious question
whether there are alternatives to the presenter&rsquo;s idea of using a
RESTful&#8212;<wbr></wbr>really, <span class="emph">functional</span>&#8212;<wbr></wbr>interface. Since it is the point of this
stage to settle architectural-level design decisions and since the dialog points
to the central role of the player interface component, this question deserves
more attention than it receives in the sample review dialog. If not at this
point, the question will come up when a pair of team members starts working on
the player interface component.</p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><blockquote class="SubFlow"><p><img src="img_1.svg" alt="" width="536.35pt" height="367.87402365pt"/></p></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aplayer-rest))" x-target-lift="Figure"></a>Figure&nbsp;29: </span>A <span class="emph">restful</span> interface for the player-client</span></p></blockquote><p><div class="SIntrapara">Given that work on the player interface may progress in parallel to work on the
foundation layer, the decision can be discussed now as an illustration of how a
<span class="emph">design conversation</span> may proceed. Thus imagine that the responsible team
members convene a meeting to explain the choice they are facing:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> We discussed the various ways in which the referee may interact with the  players. But, it turns out there are two alternatives. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Can you summarize these alternatives with a few words or perhaps an adjective? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Sure. The first one is a <span class="emph">functional</span> interface. Here is the spec  (shows <a href="#%28counter._%28figure._fig~3aplayer-rest%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">29</span></a>). </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> What does &ldquo;functional&rdquo; mean here? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  The referee calls the player with all of the relevant data, and the  player returns a complete response. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Is it correct that the  signatures and the <span class="RktSym">type</span><span class="RktMeta"></span> definition of <span class="RktSym">TurnAction</span><span class="RktMeta"></span>  suggest a response is a request to the referee? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Yes. The referee executes actions on behalf of the player, especially for turns, so it can check their legality. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Agreed. The referee can check because it knows everything about the game and the players&rsquo; game pieces. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  And to take a turn, a player must know what other players have done during their  turns. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> When we discussed the construction plan, we settled on adding a public game  state component for this purpose. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Correct, but the existence of this component is not enough. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> What else do we  need? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  We need to settle on when to convey this game state from the referee to the  player. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> That makes sense. The signature of <span class="RktSym">takeTurn</span><span class="RktMeta"></span> tells us that the  player receives a <span class="RktSym">GameState</span><span class="RktMeta"></span> when it is told to take a turn. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Yes. That&rsquo;s what &ldquo;functional&rdquo; means.  The player can compute the desired action  from the given information for the one call. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Doesn&rsquo;t it need the <span class="RktSym">GameMap</span><span class="RktMeta"></span> and the  <span class="RktSym">Destinations</span><span class="RktMeta"></span>? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  The referee could include those in the <span class="RktSym">GameState</span><span class="RktMeta"></span>, or we could agree that  these two pieces of information are essentially global constants. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Yes,  sending them over with the first method suffices. And now it is clear why this  proposed <span class="stt">take-turn</span> method is easily testable. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Good. Ready to move on to the alternative? </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Let&rsquo;s take a look at the alternative.</p></td></tr></table></div></p><p>The interface in <a href="#%28counter._%28figure._fig~3aplayer-rest%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">29</span></a> employs no known programming
language (but alludes to some) and thus deserves a bit of additional
explanation. It specifies five named pieces of functionality via functional
signatures. Each signature lists the input types first, followed by <span class="RktSym"><a href="http://docs.racket-lang.org/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="RktMeta"></span>, and
a result type. Finally, each piece of functionality is accompanied by a purpose
statement, a comment that explains <span class="emph">what</span> (not <span class="emph">how</span>) the functionality computes.</p><blockquote class="Herefigure"><blockquote class="Leftfigure"><blockquote class="FigureInside"><blockquote class="SubFlow"><p><img src="img_2.svg" alt="" width="536.35pt" height="436.55302745pt"/></p></blockquote></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aplayer-state))" x-target-lift="Figure"></a>Figure&nbsp;30: </span>A <span class="emph">stateful</span> interface for the player-client</span></p></blockquote><p>The <span style="font-weight: bold">bold-faced</span> signature of the <span class="RktSym">takeTurn</span><span class="RktMeta"></span> functionality is an
illustration of what &ldquo;functional&rdquo; means.  The function consumes a
<span class="RktSym">GameState</span><span class="RktMeta"></span> and returns a <span class="RktSym">TurnAction</span><span class="RktMeta"></span>, a type that is indicated to
exist but isn&rsquo;t defined yet.  The <span class="RktSym">takeTurn</span><span class="RktMeta"></span> functionality is <span class="emph">not</span>
supposed to need any other information to determine the action that the player
wishes to take.</p><p><div class="SIntrapara">The rest of the inspection might proceed like this:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Here it is (shows <a href="#%28counter._%28figure._fig~3aplayer-state%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">30</span></a>). I have bold-faced the difference to the first alternative. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> What does the additional functionality provide? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  It informs the player about state changes. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> When does this update go out? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  As soon as one player finishes a turn. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Does the referee send out the new state or just the change information? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  It is simplest to send out the entire state. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Why is that? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  There are several kinds of changes that can happen. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> True. A player may choose different kinds of actions. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Correct, and even worse, a player may fail to respond. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> It makes sense. Sending the entire state covers all possibilities.</p></td></tr></table></div></p><p>The signature of <span class="RktSym">takeTurn</span><span class="RktMeta"></span> in the alternative interface says that this
functionality does not consume any arguments. By implication, the player must
get the relevant information about the <span class="RktSym">GameState</span><span class="RktMeta"></span> from calls to other
methods. This is where the additional method, <span class="RktSym">inform</span><span class="RktMeta"></span>, comes in.</p><blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="seq-oo.svg" alt="" width="382.08pt" height="448.94399999999996pt"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3aoo-seq))" x-target-lift="Figure"></a>Figure&nbsp;31: </span>A diagram illustrating stateful interactions (<a href="#%28counter._%28figure._fig~3aplayer-state%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">30</span></a>)</span></p></blockquote><p>What these textual interfaces do not show clearly is how these functions relate
to each other. A design inspection should pick up on this aspect:</p><p><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> So the referee calls <span class="RktSym">inform</span><span class="RktMeta"></span> as soon as the state changes? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Its purpose statement says so. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Oh. Is there anything better? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  We doodled a diagram on a napkin (shows <a href="#%28counter._%28figure._fig~3aoo-seq%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">31</span></a>). </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Can you walk us  through this diagram? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  The components are listed at the top. The vertical lines below are their  <span class="emph">life lines</span>. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Does time flow from top to bottom? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  It does. And calls go from one life line to another. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Just to clarify. Do the first three calls show us how the referee sets up the game? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  They do. And the dotted lines go in the reverse direction to indicate that the result is <span class="RktSym">Void</span><span class="RktMeta"></span>. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> In that case the second batch of arrows indicates how the referee runs a single turn. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Yes! The call arrow indicates that the referee requests a decision.  And the return arrow says <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> tells the referee which action it wants to take. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> And then the diagram very clearly says that the referee immediately uses <span class="RktSym">inform</span><span class="RktMeta"></span> to tell the other two players of the action. </p></td></tr></table></p><p>As this dialog illustrates, this kind of diagram&#8212;<wbr></wbr>inspired by the UML sequence
 notation&#8212;<wbr></wbr>brings across temporal relationships among calls much more clearly
 than text. Since such relationships are common, it is good practice to
 supplement the textual specifications with such &ldquo;doodle diagrams.&rdquo; A photo (or
 some ASCII art) suffices, and the README should reference or include the
 diagram. It is unnecessary to follow a particular standard, such as UML,
 for discussions on napkins or design inspections such as those discussed here.</p><p><div class="SIntrapara">Let&rsquo;s move on to an even more interesting part of the diagram:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> One more thing. Check the bottom of the <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span> lifeline </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Right, what does the triangle mean? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  It indicates that the client component terminates, possibly in an irregular fashion. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> That seems to be a special case. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  We wanted your opinion about it. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Does it mean <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span> does not respond? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Precisely. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> And do the next two arrows mean <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> and <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> find out about <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span> and its unresponsiveness?  </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  We were thinking that such a player should be terminated and the others should immediately find out. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> It seems to be a reasonable decision, considering that the players will exist on remote computers and such a failure could cause havoc for the overall system. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  This is what we decided </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> To confirm. At the bottom of the sketch, both players have the information.</p></td></tr></table></div></p><blockquote class="Herefigure"><blockquote class="Centerfigure"><blockquote class="FigureInside"><p><img src="seq-fun.svg" alt="" width="382.08pt" height="334.32pt"/></p></blockquote></blockquote><p class="Centertext"><span class="Legend"><span class="FigureTarget"><a name="(counter._(figure._fig~3afun-seq))" x-target-lift="Figure"></a>Figure&nbsp;32: </span>A diagram illustrating RESTful interactions (<a href="#%28counter._%28figure._fig~3aplayer-rest%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">29</span></a>)</span></p></blockquote><p>The dialog brings out how the inspecting team members can infer the correct
timing of calls from these diagrams. Specifically the last two interactions
clarify <span class="emph">when</span> player components find <span class="emph">out</span> what about their peers.</p><p>Additionally, the construction of the diagram allows the designers to present a
potentially ambiguous error situation. Even if all components exist in a single
program in one and the same programming language, a bug in the <span class="RktSym">player</span><span class="RktMeta"></span>
component could bring down the entire system. Similarly, a remote component may
become unresponsive due to other reasons. Given that the team has decided that
such single-component failures should not terminate the game server, the team
should inspect how <span class="RktSym">referee</span><span class="RktMeta"></span> reacts in these situations and what players
find out about them when.</p><p><div class="SIntrapara">With these sequence diagram, the designers can also contrast the two
alternatives in some detail:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Do you have a doodle diagram for what you originally called the RESTful alternative? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Yes, we have such a sequence diagram for the functional alternative (shows <a href="#%28counter._%28figure._fig~3afun-seq%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">32</span></a>). </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Is it worth comparing the two? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  It is is quite instructive to compare them, especially the failure scenarios. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  What can fail here? The <span class="RktSym">player</span><span class="RktMeta"></span> doesn&rsquo;t have an <span class="RktSym">inform</span><span class="RktMeta"></span>  functionality. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  True, but any method can fail. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Of course. It looks like you worked through a failure of the <span class="RktSym">takeTurn</span><span class="RktMeta"></span> method to <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span> this time. </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  Exactly. Notice how the lifeline of <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span> ends during the call, before it returns a <span class="RktSym">turnAction</span><span class="RktMeta"></span>. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Is it correct that the next call of the <span class="RktSym">takeTurn</span><span class="RktMeta"></span> method to <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> delivers this knowledge about the elimination of <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>2<span style="font-style: italic"></span></span><span style="font-style: italic"></span> as part of <span class="RktSym">gameState</span><span class="RktMeta"></span>? </p></td></tr><tr><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p>  It does. And you probably guessed that <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> has not found out yet. </p></td><td valign="top" width="280" style="border-bottom: 1px solid black;; padding: 10px;"><p> Yes, that&rsquo;s clear. You should add these diagrams to the repository and point to them from the README file.</p></td></tr></table></div><div class="SIntrapara">Let&rsquo;s stop here.  Reflect on the <span class="emph">style</span> of the design inspection
dialog and its content.</div></p><p><a name="(counter._(exercise._ex~3adesign-inspection-2))"></a><span style="font-weight: bold">Exercise</span>&nbsp;10. Consider the follow scenario. The
<span class="RktSym">referee</span><span class="RktMeta"></span> successfully calls a method of <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> but the player fails
after it returns a <span class="RktSym">takeAction</span><span class="RktMeta"></span> result. When do <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>0<span style="font-style: italic"></span></span><span style="font-style: italic"></span> and <span class="RktSym">player</span><span class="RktMeta"></span><span style="font-style: italic"></span><span style="vertical-align: sub; font-size: 80%"><span style="font-style: italic"></span>1<span style="font-style: italic"></span></span><span style="font-style: italic"></span> find
out according to the two alternative interfaces? Sketch sequence diagrams. Work
through these diagrams with a partner.<a href="#%28counter._%28exercise._ex~3adesign-inspection-2%29%29" class="ex-end" data-pltdoc="x"></a></p><p><a name="(counter._(exercise._ex~3adesign-alternative))"></a><span style="font-weight: bold">Exercise</span>&nbsp;11. The design inspection has demonstrated that
the interface of <a href="#%28counter._%28figure._fig~3aplayer-rest%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">29</span></a> differs from the one in
<a href="#%28counter._%28figure._fig~3aplayer-state%29%29" data-pltdoc="x">figure&nbsp;<span class="FigureRef">30</span></a> in significant ways. Write down a concise
explanation of an advantage or disadvantage to the developer of the game-server
software, and similarly, articulate an advantage or disadvantage to the
developer of the player clients. Work through these points with a partner.<a href="#%28counter._%28exercise._ex~3adesign-alternative%29%29" class="ex-end" data-pltdoc="x"></a></p><blockquote class="SCentered"><p>Old Material</p></blockquote><p>Deep down buildings consist of bricks and mortar, but what people see are walls
and ceilings. These large pieces hide the fundamental building blocks, and over
time, what they consist of changes. Often these changes enable the construction
of much larger building from one era to another.</p><p>Software systems are the analogues of entire houses or even highrises. Just like
with buildings, the fundamental building blocks&#8212;<wbr></wbr>functions and methods for data
representations&#8212;<wbr></wbr>are hidden behind large pieces: modules and classes.  Usually,
software architects make plans for just the latter, but software developers see
all levels. Once handed a plan, they built things from bottom up, starting with
simple classes and methods, ending with complex classes or even components
that consist of many classes.</p><blockquote class="SCentered"><p>More Old Stuff</p></blockquote><p>As a result, an interface is probably the most important example of writing that
isn&rsquo;t (just) code. At a minimum, an interface demands supplementary descriptions
of what the arguments and the results of a method or function mean.  Similarly,
interfaces of bespoke components or sophisticated frameworks work properly only
if additional conditions are met. Often these conditions are about temporal
relationships among method calls; at other times, they concern the connection
between the values of different calls to the same method.  Finally, contemporary
software systems also offer interfaces for external developers, people whom the
team members are unlikely to ever meet.  These interfaces tend to impose the
same kinds of logical and temporal constraints as internal ones as well as
formatting specifications for remote access.</p><p>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>&#8212;<wbr></wbr>-</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">Designing an interface can go wrong in several ways. It may expose too much</span></p></td></tr><tr><td><p><span class="stt">functionality and information about the internals, as in the </span><span class="stt">Coordinate</span><span class="stt"></span></p></td></tr><tr><td><p><span class="stt">example of the preceding section. The interface may expose too little</span></p></td></tr><tr><td><p><span class="stt">functionality. And, the interface may be in conflict with the actual</span></p></td></tr><tr><td><p><span class="stt">implementation.</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr><tr><td><p><span class="stt">Once released, changes to an interface should come with versioning so that the</span></p></td></tr><tr><td><p><span class="stt">creators of client code can specify which version of the</span></p></td></tr><tr><td><p><span class="stt">interface-implementation combination their code depends on. When the creator of</span></p></td></tr><tr><td><p><span class="stt">a framework releases a new interface, the release documentation must clarify in</span></p></td></tr><tr><td><p><span class="stt">what way the new version may break compatibility relative to the preceding</span></p></td></tr><tr><td><p><span class="stt">version. Documenting this compatibility comparison helps programmers adjust</span></p></td></tr><tr><td><p><span class="stt">application code; in the ideal case, new releases are </span><span class="emph">backwards
compatible</span><span class="stt">, meaning client programmers can switch from the old to the new</span></p></td></tr><tr><td><p><span class="stt">version without problem.</span></p></td></tr><tr><td><p><span class="stt"></span><span class="hspace">&nbsp;</span></p></td></tr></table></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="part_three.html" title="backward to &quot;III Project&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Socially Responsible  Software Development&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="part_five.html" title="forward to &quot;V Programming Basics&quot;" data-pltdoc="x" rel="next">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>