<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>Serving the Web</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Building Extensible Systems</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="general.html" class="tocviewlink" data-pltdoc="x">General</a></td></tr><tr><td align="right"></td><td><a href="syllabus.html" class="tocviewlink" data-pltdoc="x">Syllabus</a></td></tr><tr><td align="right"></td><td><a href="projects.html" class="tocviewlink" data-pltdoc="x">Projects</a></td></tr><tr><td align="right"></td><td><a href="resources.html" class="tocviewlink" data-pltdoc="x">Resources</a></td></tr><tr><td align="right"></td><td><a href="homework.html" class="tocviewselflink" data-pltdoc="x">Homework</a></td></tr><tr><td align="right"></td><td><a href="writing.html" class="tocviewlink" data-pltdoc="x">Notes on Writing</a></td></tr><tr><td align="right"></td><td><a href="log.html" class="tocviewlink" data-pltdoc="x">Your Rust Log</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td></td><td><a href="homework.html" class="tocviewlink" data-pltdoc="x">Homework</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="hw_guide.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">Homework Guidelines</span></a></td></tr><tr><td align="right"></td><td><a href="1.html" class="tocviewlink" data-pltdoc="x">Averages and Things</a></td></tr><tr><td align="right"></td><td><a href="2.html" class="tocviewlink" data-pltdoc="x">Counting Words</a></td></tr><tr><td align="right"></td><td><a href="3.html" class="tocviewlink" data-pltdoc="x">Word Frequencies</a></td></tr><tr><td align="right"></td><td><a href="4.html" class="tocviewlink" data-pltdoc="x">A Spelling Corrector</a></td></tr><tr><td align="right"></td><td><a href="5.html" class="tocviewlink" data-pltdoc="x">Graph Traversals</a></td></tr><tr><td align="right"></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Serving the Web</a></td></tr><tr><td align="right"></td><td><a href="7.html" class="tocviewlink" data-pltdoc="x">Running the T</a></td></tr><tr><td align="right"></td><td><a href="8.html" class="tocviewlink" data-pltdoc="x">Reflective Essay</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Serving the Web</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="#%28part._web_server%29" class="tocviewlink" data-pltdoc="x"><span class="stt">web_<span class="mywbr"> &nbsp;</span>server</span></a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._web_server%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">web_<span class="mywbr"> &nbsp;</span>server</span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">6.2.0.2</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="5.html" title="backward to &quot;Graph Traversals&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="homework.html" title="up to &quot;Homework&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="7.html" title="forward to &quot;Running the T&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3><a name="(part._6)"></a>Serving the Web</h3><a name="(part._chap~3a6)"></a><p>For this homework set, you will implement a rudimentary web server in Rust.</p><p>The objective of this homework is to get to know Rust&rsquo;s concurrency model
and constructs.</p><p><span style="font-weight: bold">Deadline</span> <span style="color: red">Friday 13 March NOON</span>.</p><h3><a name="(part._web_server)"></a><span class="stt">web_server</span></h3><p><div class="SIntrapara">The purpose of <span class="stt">web_server</span> is to respond to the single command of HTTP 0.9, the
<span class="stt">GET</span> command, which has the following shape:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">GET </span><span style="color: blue">&lt;path_to_file&gt;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">HTTP</span></p></td></tr></table></div><div class="SIntrapara">That is, it is the literal world <span class="stt">GET</span>, followed by a blank space,
followed by a Unix-style path to a file, followed by another
blank space and the literal token <span class="stt">HTTP</span>. The following line is a blank
line.</div></p><p><div class="SIntrapara">In return to a valid <span class="stt">GET</span> command, the web server spawns a task that
retrieves the command, records it in a log file, and generates a
response. For this assignment, the following four forms of responses are
appropriate:
</div><div class="SIntrapara"><ul><li><p>an <span class="stt">200 OK</span> status, which starts a reply that serves the specified
file;</p></li><li><p>a <span class="stt">400 Bad Request</span>, which indicates that the command is not a
properly formatted <span class="stt">GET</span> command;</p></li><li><p>a <span class="stt">403 Forbidden</span>, which rejects a command because it
specifies a file that is off-limits;</p></li><li><p>a <span class="stt">404 Not Found</span>, which informs the client that the specified
file does not exist.</p></li></ul></div><div class="SIntrapara">Each response is preceded by <span class="stt">HTTP/1.0</span> plus a blank space.</div></p><p><div class="SIntrapara">The complete header of a <span class="stt">200 OK</span> response is formatted as follows:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">HTTP/1.0 200 OK</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span><span style="color: blue">&lt;name_of_web_server&gt;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Content-type: text/</span><span style="color: blue">&lt;plain_or_html&gt;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Content-Length: </span><span style="color: blue">&lt;number_of_bytes_sent&gt;</span></p></td></tr></table></div><div class="SIntrapara">plus a blank line. To keep things simple, the <span style="color: blue">&lt;plain_or_html&gt;</span>
property is either <span class="stt">html</span> for files whose suffix is <span class="stt">.html</span> or
<span class="stt">plain</span> for all others.</div></p><p>The remainder of a 200-message is the content of the specified file.</p><p><div class="SIntrapara">A path specification <span style="color: blue">&lt;path_to_file&gt;</span> must start with <span class="stt">/</span> and is
interpreted after concatenating it with the server&rsquo;s root path:
</div><div class="SIntrapara"><ul><li><p>if the resulting path points to a file, the file is served with a
200-message unless its permissions do not allow so.</p></li><li><p>if the resulting path points to a directory, it is interpreted as
pointing to one of these files:
<span class="stt">index.html</span>,
<span class="stt">index.shtml</span>, and
<span class="stt">index.txt</span>.
The first file found is served assuming it is accessible. Otherwise the
path triggers a 404-message.</p></li><li><p>otherwise the server responds with an error message.</p></li></ul></div></p><p><div class="SIntrapara">Run your web server on localhost (127.0.0.1), port 8000. To explore its
workings, point your web browser to <span class="stt">http://localhost:8000/main.rs</span>
(assuming you are running it out of the <span class="stt">src</span> directory) or use
<span class="stt">telnet</span>:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">$ telnet 127.0.0.1 8080</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Trying 127.0.0.1...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Connected to localhost.</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Escape character is '^]'.</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">GET /main.rs HTTP/1.0</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr></table></div><div class="SIntrapara">The result should be a response of this shape:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">HTTP/1.0 200 OK</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">MFs_web_server</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Content-type: text/plain</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Content-Length: 2034...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">// This module implements a simplistic HTTP server.</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">use std::io;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">use std::io::{TcpListener,TcpStream};</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">use std::io::{Listener,Acceptor};</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">use std::thread::Thread;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">use std::io::net::tcp;</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">...</span></p></td></tr></table></div><div class="SIntrapara">Do not try to cover additional HTTP commands. The purpose of the assignment
is to prepare the <a href="7.html" data-pltdoc="x">Running the T</a> project.</div></p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="5.html" title="backward to &quot;Graph Traversals&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="homework.html" title="up to &quot;Homework&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="7.html" title="forward to &quot;Running the T&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>