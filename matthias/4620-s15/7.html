<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>Running the T</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Building Extensible Systems</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="general.html" class="tocviewlink" data-pltdoc="x">General</a></td></tr><tr><td align="right"></td><td><a href="syllabus.html" class="tocviewlink" data-pltdoc="x">Syllabus</a></td></tr><tr><td align="right"></td><td><a href="projects.html" class="tocviewlink" data-pltdoc="x">Projects</a></td></tr><tr><td align="right"></td><td><a href="resources.html" class="tocviewlink" data-pltdoc="x">Resources</a></td></tr><tr><td align="right"></td><td><a href="homework.html" class="tocviewselflink" data-pltdoc="x">Homework</a></td></tr><tr><td align="right"></td><td><a href="writing.html" class="tocviewlink" data-pltdoc="x">Notes on Writing</a></td></tr><tr><td align="right"></td><td><a href="log.html" class="tocviewlink" data-pltdoc="x">Your Rust Log</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td></td><td><a href="homework.html" class="tocviewlink" data-pltdoc="x">Homework</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="hw_guide.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">Homework Guidelines</span></a></td></tr><tr><td align="right"></td><td><a href="1.html" class="tocviewlink" data-pltdoc="x">Averages and Things</a></td></tr><tr><td align="right"></td><td><a href="2.html" class="tocviewlink" data-pltdoc="x">Counting Words</a></td></tr><tr><td align="right"></td><td><a href="3.html" class="tocviewlink" data-pltdoc="x">Word Frequencies</a></td></tr><tr><td align="right"></td><td><a href="4.html" class="tocviewlink" data-pltdoc="x">A Spelling Corrector</a></td></tr><tr><td align="right"></td><td><a href="5.html" class="tocviewlink" data-pltdoc="x">Graph Traversals</a></td></tr><tr><td align="right"></td><td><a href="6.html" class="tocviewlink" data-pltdoc="x">Serving the Web</a></td></tr><tr><td align="right"></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Running the T</a></td></tr><tr><td align="right"></td><td><a href="8.html" class="tocviewlink" data-pltdoc="x">Reflective Essay</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">Running the T</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="#%28part._t_query%29" class="tocviewlink" data-pltdoc="x"><span class="stt">t_<span class="mywbr"> &nbsp;</span>query</span></a></td></tr><tr><td align="right"></td><td><a href="#%28part._.Details%29" class="tocviewlink" data-pltdoc="x">Details</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber"></span><a href="#%28part._t_query%29" class="tocsubseclink" data-pltdoc="x"><span class="stt">t_<span class="mywbr"> &nbsp;</span>query</span></a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#%28part._.Details%29" class="tocsubseclink" data-pltdoc="x">Details</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">6.2.0.2</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="6.html" title="backward to &quot;Serving the Web&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="homework.html" title="up to &quot;Homework&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="8.html" title="forward to &quot;Reflective Essay&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3><a name="(part._7)"></a>Running the T</h3><a name="(part._chap~3a7)"></a><p>For this homework set, you will design an application for managing the T&rsquo;s
subway system.</p><p>The objective of this homework is to improve your knowledge about Rust&rsquo;s
concurrency model and constructs. The assignment "combines" knowledge from
<a href="5.html" data-pltdoc="x">Graph Traversals</a> and <a href="6.html" data-pltdoc="x">Serving the Web</a>.</p><p><span style="font-weight: bold">Deadline</span> <span style="color: red"><span class="strike" style="text-decoration:line-through">Friday 20 March NOON</span></span>, new due date <span style="color: red">Friday 27 March NOON</span>.</p><h3><a name="(part._t_query)"></a><span class="stt">t_query</span></h3><p><div class="SIntrapara">The purpose of the <span class="stt">t_query</span> service is to manage the MBTA&rsquo;s subway
stations. It has two distinct tasks. First, <span class="stt">t_query</span> responds to queries by T
riders on how to get from one station to another. The queries have the
following format:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">from </span><span style="font-style: italic">STATION</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">to </span><span style="font-style: italic">STATION</span></p></td></tr></table></div><div class="SIntrapara">where <span style="font-style: italic">STATION</span> is a string that is supposed to uniquely identify a
subway station.</div></p><p><div class="SIntrapara">Second, <span class="stt">t_query</span> accepts en/disable two kinds of commands from T operators:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">disable </span><span style="font-style: italic">STATION</span><span class="stt"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">enable </span><span style="font-style: italic">STATION</span></p></td></tr></table></div><div class="SIntrapara">The first one temporarily takes the specified station out of operations,
the second one brings it back on line.</div></p><p><div class="SIntrapara">Here are some sample dialogs. The first one is a query by a newly arrived
freshman student on how to get from the Airport station to the Northeastern
stop:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; from Airport to Northeastern</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Airport Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Maverick Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Aquarium Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">State Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Government Center Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---switch from blue to green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Park Street Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Boylston Street Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Arlington Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Copley Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---ensure you are on E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Prudential Station, take E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Symphony Station, take E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Northeastern University Station, take E</span></p></td></tr></table></div><div class="SIntrapara">My sample implementation picks the route with the fewest switches because
newly arrived freshman students tend to come with huge suitcases. Next,
some operator disables the Government station:<span class="refelem"><span class="refcolumn"><span class="refcontent">To repair
Government station, a real T operator would not use such a command but take
the station out of the database and restart the service.</span></span></span>
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; disable Government</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">done</span></p></td></tr></table></div><div class="SIntrapara">Not surprisingly, the next passenger at the Airport station gets completely
different advice from the above on how to get to Northeastern:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; from Airport to Northeastern</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Airport Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Maverick Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Aquarium Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">State Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---switch from blue to orange</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Downtown Crossing Station, take orange</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---switch from orange to red</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Park Street Station, take red</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---switch from red to green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Boylston Street Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Arlington Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Copley Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---ensure you are on E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Prudential Station, take E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Symphony Station, take E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Northeastern University Station, take E</span></p></td></tr></table></div><div class="SIntrapara">Once Government Center is put back on-line,
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; enable Government</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">done</span></p></td></tr></table></div><div class="SIntrapara">the service once again suggests a route with a single transfer:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; from Airport to Northeastern</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Airport Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Maverick Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Aquarium Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">State Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Government Center Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---switch from blue to green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Park Street Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Boylston Street Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Arlington Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Copley Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---ensure you are on E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Prudential Station, take E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Symphony Station, take E</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Northeastern University Station, take E</span></p></td></tr></table></div></p><p><div class="SIntrapara">The service is robust and survives typos in the names of stations:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; from Airport to Northe**stern</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">no such destination: Northe**stern</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; from Airport to Center</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">disambiguate your destination: Quincy Center Station Government Center Station Tufts Medical Center Station Malden Center Station</span></p></td></tr></table></div><div class="SIntrapara">Similarly, operators also can&rsquo;t trip up <span class="stt">t_query</span>:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; disable Nor'easter</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">no such station to disable: Nor'easter</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; enable Gov'm**nt</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">no such station to enable: Gov'm**nt</span></p></td></tr></table></div><div class="SIntrapara">Even an insistent operator who enables stations that are on-line or
disables stations twice, can&rsquo;t get the service to crash:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; enable Government</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">done</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; disable Government</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">done</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; disable Government</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">done</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; enable Government</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">done</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">===&gt;&gt;&gt; from Airport to Hynes</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Airport Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Maverick Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Aquarium Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">State Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Government Center Station, take blue</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---switch from blue to green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Park Street Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Boylston Street Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Arlington Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Copley Station, take green</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">---ensure you are on C D B</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="stt">Hynes Convention Center, take C D B</span></p></td></tr></table></div><div class="SIntrapara">A single <span class="stt">enable</span> command suffices to bring Government Center back
on-line, even though it was <span class="stt">disable</span>d twice.</div></p><h3><a name="(part._.Details)"></a>Details</h3><p>The current<span class="refelem"><span class="refcolumn"><span class="refcontent">Hope springs eternal.</span></span></span> four T lines are specified
in four data files, named after their color: <a href="green.dat"><span class="stt">green.dat</span></a>, <a href="blue.dat"><span class="stt">blue.dat</span></a>,
<a href="red.dat"><span class="stt">red.dat</span></a>, and <a href="orange.dat"><span class="stt">orange.dat</span></a>.</p><p>Your <span class="stt">t_query</span> server must listen for queries and commands on the local
loopback interface (<span class="stt">127.0.0.1</span>) on port <span class="stt">12345</span>. For each command or
query, it spawns a separate process so that the service can cope with many
queries in parallel.</p><p>As for the format of the responses, they do not need to match the
interactions above exactly but they should come close.  Regardless, <span class="stt">t_query</span>
must be robust with respect to errors from passengers and operators.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="6.html" title="backward to &quot;Serving the Web&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="homework.html" title="up to &quot;Homework&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="8.html" title="forward to &quot;Reflective Essay&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>