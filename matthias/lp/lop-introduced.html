<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>1&nbsp;Programming Languages</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Programming Languages</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="preface.html" class="tocviewlink" data-pltdoc="x">Prelude</a></td></tr><tr><td align="right">1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Programming Languages</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="a-model.html" class="tocviewlink" data-pltdoc="x">A Model of Macro Expansion</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="onward.html" class="tocviewlink" data-pltdoc="x">Onward to Racket</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="patterns.html" class="tocviewlink" data-pltdoc="x">Pattern-<wbr></wbr>Matching Macros</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="extensions.html" class="tocviewlink" data-pltdoc="x">Language Extensions</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="advanced.html" class="tocviewlink" data-pltdoc="x">Syntax Classes</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="tue-aft-lecture.html" class="tocviewlink" data-pltdoc="x">Lexical Scope, (Un)Hygienic Macros</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="conspiracy.html" class="tocviewlink" data-pltdoc="x">Macros that Conspire</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="embedded.html" class="tocviewlink" data-pltdoc="x">Embedded Languages</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="module-langs.html" class="tocviewlink" data-pltdoc="x">Module Languages</a></td></tr><tr><td align="right"></td><td><a href="postlude.html" class="tocviewlink" data-pltdoc="x">Postlude</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>1&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Programming Languages</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">1.1&nbsp;</td><td><a href="#%28part._.One_.Project__.Many_.Programming_.Languages%29" class="tocviewlink" data-pltdoc="x">One Project, Many Programming Languages</a></td></tr><tr><td align="right">1.2&nbsp;</td><td><a href="#%28part._.One_.Programming_.Language__.Many_.Languages%29" class="tocviewlink" data-pltdoc="x">One Programming Language, Many Languages</a></td></tr><tr><td align="right">1.3&nbsp;</td><td><a href="#%28part._.Why_.Embedded_.Languages_.Matter%29" class="tocviewlink" data-pltdoc="x">Why Embedded Languages Matter</a></td></tr><tr><td align="right">1.4&nbsp;</td><td><a href="#%28part._.One_.Racket_.Programmer__.Many_.Languages%29" class="tocviewlink" data-pltdoc="x">One Racket Programmer, Many Languages</a></td></tr><tr><td align="right">1.5&nbsp;</td><td><a href="#%28part._.Programming_.A_.Language__.Programming_.Many_.Languages%29" class="tocviewlink" data-pltdoc="x">Programming A Language, Programming Many Languages</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#%28part._.One_.Project__.Many_.Programming_.Languages%29" class="tocsubseclink" data-pltdoc="x">One Project, Many Programming Languages</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#%28part._.One_.Programming_.Language__.Many_.Languages%29" class="tocsubseclink" data-pltdoc="x">One Programming Language, Many Languages</a></td></tr><tr><td><span class="tocsublinknumber">1.2.1<tt>&nbsp;</tt></span><a href="#%28part._.Embedded_.Programs_as_.Strings%29" class="tocsubseclink" data-pltdoc="x">Embedded Programs as Strings</a></td></tr><tr><td><span class="tocsublinknumber">1.2.2<tt>&nbsp;</tt></span><a href="#%28part._.Embedded_.Programs_as_.Grammatical_.Productions%29" class="tocsubseclink" data-pltdoc="x">Embedded Programs as Grammatical Productions</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#%28part._.Why_.Embedded_.Languages_.Matter%29" class="tocsubseclink" data-pltdoc="x">Why Embedded Languages Matter</a></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="#%28part._.One_.Racket_.Programmer__.Many_.Languages%29" class="tocsubseclink" data-pltdoc="x">One Racket Programmer, Many Languages</a></td></tr><tr><td><span class="tocsublinknumber">1.5<tt>&nbsp;</tt></span><a href="#%28part._.Programming_.A_.Language__.Programming_.Many_.Languages%29" class="tocsubseclink" data-pltdoc="x">Programming A Language, Programming Many Languages</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">7.4.0.1</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="preface.html" title="backward to &quot;Prelude&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Programming Languages&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="a-model.html" title="forward to &quot;2 A Model of Macro Expansion&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>1<tt>&nbsp;</tt><a name="(part._lop-introduced)"></a>Programming Languages</h3><p><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><span style="font-weight: bold">Goals</span></p></td></tr><tr><td><p> &#8212;<wbr></wbr> the many ways of language-oriented programming</p></td></tr><tr><td><p> &#8212;<wbr></wbr> programming languages in Racket</p></td></tr></table></p><h4>1.1<tt>&nbsp;</tt><a name="(part._.One_.Project__.Many_.Programming_.Languages)"></a>One Project, Many Programming Languages</h4><p>In this day and age, a software project employs many different programming
languages. A &ldquo;full stack&rdquo; web application has software running in the web
browser and the web server, and this software is rarely written in the same
language. Furthermore the server is hardly ever a monolithic piece of
software in one language. It typically glues together code that interprets
requests (from the network), turns them into database queries, checks some
business logic, and many more actions. Each of them might have been written
in a different language (and possibly in a different era).</p><p><div class="SIntrapara">A few years ago a colleague from IBM presented (roughly) the following
stack during his keynote address at POPL:
</div><div class="SIntrapara"><blockquote class="SCentered"><p><img style="vertical-align: -0.0px; margin: -3px -3px -3px -3px;" src="pict.svg" type="image/svg+xml"/></p></blockquote></div><div class="SIntrapara">Programming with multiple external programming languages has been a reality
for decades. It still is. Here are reasons why projects use many languages:</div></p><p><div class="SIntrapara"><ul><li><p>history&#8212;<wbr></wbr>someone started a project in a language, and the language
falls out of favor.</p></li><li><p>platform&#8212;<wbr></wbr>a new platform appears and demands attention. The new
platform (terminal, pc, browser, mobile) does not support the language in
which the software is currently written.</p></li><li><p>expressiveness, productivity&#8212;<wbr></wbr>on rare occasions, a team of
developers can convince the project manager that a new programming language
will make them more productive than the one that has been used so far.</p></li></ul></div><div class="SIntrapara">There are probably more such reasons but, regardless, the only way to add a
new component in a new language comes with a singular condition: there must
be a &ldquo;natural&rdquo; way to separate the two components. Usually &ldquo;natural&rdquo;
means the two components may communicated via an easy-to-use FFI or they
are forced to communicate via some form of input/output anyways (say, the
network for a view written for a web browser).</div></p><p>While one could call this form of programming, &ldquo;language-oriented
programming&rdquo; this is a wider notion than the one we cover here. Indeed, in
a way we would like to help programmers avoid such &ldquo;language stacks&rdquo; by
<span style="font-style: italic">internalizing</span> it into Racket, as much as possible at least&#8212;<wbr></wbr>because
what we do accept from this historic development is that the use of
multiple languages makes a software developers life easier. A close look at
programming languages shows that designers have recognized this fact a long
time ago, possibly from the very first moment they abstracted over
assembly.</p><h4>1.2<tt>&nbsp;</tt><a name="(part._.One_.Programming_.Language__.Many_.Languages)"></a>One Programming Language, Many Languages</h4><p>Almost every programming language comes with several distinct sub-languages
that deal with distinct programming domains. Let&rsquo;s look at a couple of
examples in Racket, illustrating how far back this idea dates.</p><h5>1.2.1<tt>&nbsp;</tt><a name="(part._.Embedded_.Programs_as_.Strings)"></a>Embedded Programs as Strings</h5><p><div class="SIntrapara">Strings are the easiest way for a programming language to embedded programs
from a separate language. The first example is the familiar one of format
strings, dating back at least to platform-specific dialects of Algol 60:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktVal">"~a :: ~a\n"</span></p></blockquote></div><div class="SIntrapara">By itself, such a format string is pointless. But, if a programming language
supports interpreters for such strings, it greatly facilitate the rendering
of values  into strings for output devices:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">formatting strings to prepare for printing</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/Writing.html#%28def._%28%28quote._~23~25kernel%29._printf%29%29" class="RktValLink" data-pltdoc="x">printf</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a :: ~a\n"</span><span class="hspace">&nbsp;</span><span class="RktVal">"hello"</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">String</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">The <span class="RktSym"><a href="http://docs.racket-lang.org/reference/Writing.html#%28def._%28%28quote._~23~25kernel%29._printf%29%29" class="RktValLink" data-pltdoc="x">printf</a></span> function really plays the role of an interpreter for a
program written as a string, whose inputs is a sequence of arbitrary Racket
values. Of course, neither the Racket compiler nor the IDE understand the
program because it is a string. Hence they can&rsquo;t statically analyze it
(well) and the developer is left without much assistance.</div></p><p><div class="SIntrapara">In Racket there are several interpreters for such embedded string-programs:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/Writing.html#%28def._%28%28quote._~23~25kernel%29._format%29%29" class="RktValLink" data-pltdoc="x">format</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"~a :: ~a\n"</span><span class="hspace">&nbsp;</span><span class="RktVal">"hello"</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">String</span><span class="RktPn">)</span></p></blockquote></div><div class="SIntrapara">And this is a common phenomenon.</div></p><p><div class="SIntrapara">The language of regular expressions is a second string-based example that
is equally common in modern languages. Many (all?) modern programming
languages come with functions that interpret certain strings as regular
expressions and matching such expressions against strings:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">String -&gt; False of [List String Char-String Char-String]</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract-digits</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/regexp.html#%28def._%28%28quote._~23~25kernel%29._regexp-match%29%29" class="RktValLink" data-pltdoc="x">regexp-match</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"20(.)(.)"</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">This is a function that extracts the last two digits of a string that
represents a 21st-century year:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym">extract-digits</span><span class="hspace">&nbsp;</span><span class="RktVal">"2018"</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">extract-digits</span><span class="hspace">&nbsp;</span><span class="RktVal">"1999"</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Again, <span class="RktSym"><a href="http://docs.racket-lang.org/reference/regexp.html#%28def._%28%28quote._~23~25kernel%29._regexp-match%29%29" class="RktValLink" data-pltdoc="x">regexp-match</a></span> servers as an interpreter for an embedded
program here. Racket comes with different embedded languages of regular
expressions, and some facilitate solving this problem even more than plain
regular-expressions-as-strings:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">String -&gt; False of [List String Digit-String Digit-String]</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">extract-digits-version-2</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/regexp.html#%28def._%28%28quote._~23~25kernel%29._regexp-match%29%29" class="RktValLink" data-pltdoc="x">regexp-match</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#px"20(\\d)(\\d)"</span><span class="hspace">&nbsp;</span><span class="RktSym">year</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">In the &ldquo;#px&rdquo; language of regular expressions, we know that &ldquo;\d&rdquo; really
matches just digits so this version of the function is &ldquo;more correct&rdquo;
than the previous one.</div></p><p>Stop! Pick a natural number <span style="font-style: italic">n</span>. Enumerate <span style="font-style: italic">n</span> disadvantages of
embedded programs as strings, not just for the formatting and
regular-expression languages, but any such embedded domain-specific
language you know.</p><h5>1.2.2<tt>&nbsp;</tt><a name="(part._.Embedded_.Programs_as_.Grammatical_.Productions)"></a>Embedded Programs as Grammatical Productions</h5><p>Extending a language&rsquo;s grammar is an alternative to strings for adding
small sub-languages. For example, many modern languages come with
sub-languages for matching tree-shaped patterns of data and others for
dealing with external events. Others support &ldquo;frameworks&rdquo; that are nearly
indistinguishable from separate languages, though those do not enforce
certain basic grammatical constraints and instead use run-time checking.
This section illustrates this point with Racket examples, mostly to point
out immediately that non-experts can program such grammatical extensions.</p><p>Pattern matching is one prominent example of a grammatical sub-language.
While pattern matching in a language with type inference is a necessity,
developers have come to love the idea of de-structuring deeply nested trees
of (algebraic) data with just a bit of notations and pattern matching has
thus made it into all kinds of programming languages.</p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The rest of these notes expect readers to be comfortable with
programs such as this one.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">Here is an example from our world:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">racket</span></a></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">rackunit</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">LAMBDA is one of:</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> symbol, but not </span><span class="RktVal">'</span><span class="RktVal">function</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> a list of two LAMBDAs, or </span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">&ndash;</span><span class="RktCmt"> a list of this shape: </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">function</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/pairs.html#%28def._%28%28quote._~23~25kernel%29._list%29%29" class="RktValLink" data-pltdoc="x">list</a></span><span class="stt"> </span><span class="RktSym">symbol</span><span class="RktPn">)</span><span class="stt"> </span><span class="RktSym">LAMBDA</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">simple-tree</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">(</span><span class="RktVal">function</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">x</span><span class="hspace">&nbsp;</span><span class="RktVal">x</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktVal">f</span><span class="hspace">&nbsp;</span><span class="RktVal">y</span><span class="RktVal">)</span><span class="RktVal">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">how many times </span><span class="RktVal">'</span><span class="RktVal">function</span><span class="RktCmt"> occurs as part of LAMBDA data</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">how-many-functions</span><span class="hspace">&nbsp;</span><span class="RktSym">tree</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktSym">tree</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/data-structure-contracts.html#%28def._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._and%2Fc%29%29" class="RktValLink" data-pltdoc="x">and/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/procedures.html#%28def._%28%28lib._racket%2Fprivate%2Flist..rkt%29._compose%29%29" class="RktValLink" data-pltdoc="x">compose</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._not%29%29" class="RktValLink" data-pltdoc="x">not</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/procedures.html#%28def._%28%28lib._racket%2Ffunction..rkt%29._curry%29%29" class="RktValLink" data-pltdoc="x">curry</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._eq~3f%29%29" class="RktValLink" data-pltdoc="x">eq?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">function</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktSym">function-expression</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktSym">argument-expression</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">how-many-functions</span><span class="hspace">&nbsp;</span><span class="RktSym">function-expression</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">how-many-functions</span><span class="hspace">&nbsp;</span><span class="RktSym">argument-expression</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktVal">`</span><span class="RktVal">(</span><span class="RktVal">function</span><span class="hspace">&nbsp;</span><span class="RktVal">(</span><span class="RktRdr">,</span><span class="RktPn">(</span><span class="RktSym">?</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/symbols.html#%28def._%28%28quote._~23~25kernel%29._symbol~3f%29%29" class="RktValLink" data-pltdoc="x">symbol?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">function-parameter</span><span class="RktPn">)</span><span class="RktVal">)</span><span class="hspace">&nbsp;</span><span class="RktRdr">,</span><span class="RktSym">function-body</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">how-many-functions</span><span class="hspace">&nbsp;</span><span class="RktSym">function-body</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/exns.html#%28def._%28%28quote._~23~25kernel%29._error%29%29" class="RktValLink" data-pltdoc="x">error</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">how-many-functions</span><span class="hspace">&nbsp;</span><span class="RktVal">"LAMBDA expected, given: ~e"</span><span class="hspace">&nbsp;</span><span class="RktSym">tree</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/module.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._module%2B%29%29" class="RktStxLink" data-pltdoc="x">module+</a></span><span class="hspace">&nbsp;</span><span class="RktSym">test</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">check-equal?</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">how-many-functions</span><span class="hspace">&nbsp;</span><span class="RktSym">simple-tree</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">A <span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> expression consists of an expression followed by sequence
of <span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> clauses. The patterns on the left hand side of such
clauses are a brand-new category of syntactic things that &ldquo;match
programmers&rdquo; can write down. In the above example, the last proper pattern
demonstrates particularly well how easy it is to extract both the embedded
symbol and the embedded <span class="stt">LAMBDA</span> from a <span class="RktVal">'</span><span class="RktVal">function</span> list.</div></p><p>Patterns are a new syntactic category, not comparable to anything that
exists in Racket. Clearly one immediate advantage of this arrangement is
that the compiler can check the validity of the &ldquo;pattern program;&rdquo; there
is no need to wait until run time to discover problems. Equally important,
if a programmer accidentally places a pattern outside, the compiler can
issue an explanatory error message.</p><p>Additionally, Racket patterns allow escapes to Racket as the first one
shows.  The Racket code can be arbitrarily complicated, using elements of
any library. And naturally, this Racket code could use <span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> again.</p><p>We call such embeddings of sub-languages <span style="font-style: italic">fine-grained</span>, because
elements of one grammatical category (patterns) can embedded Racket
expressions and vice versa.</p><p><div class="SIntrapara">Our second example originates from the Racket-based teaching languages for
&ldquo;How to Design Programs.&rdquo; Those supply a domain-specific language for
dealing with events such as clock ticks, key strokes, mouse movements and
clicks, and more. We can use this language of event inside of regular Racket
programs:
</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">dealing with events from the environment</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">2htdp/universe</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span><span class="hspace">&nbsp;</span><span class="RktSym">2htdp/image</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">main</span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s0</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-tick%29%29" class="RktStxLink" data-pltdoc="x">on-tick</a></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._sub1%29%29" class="RktValLink" data-pltdoc="x">sub1</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._stop-when%29%29" class="RktStxLink" data-pltdoc="x">stop-when</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._zero~3f%29%29" class="RktValLink" data-pltdoc="x">zero?</a></span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._to-draw%29%29" class="RktStxLink" data-pltdoc="x">to-draw</a></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/lambda.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpimage.html#%28def._%28%28lib._2htdp%2Fimage..rkt%29._circle%29%29" class="RktValLink" data-pltdoc="x">circle</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2B%29%29" class="RktValLink" data-pltdoc="x">+</a></span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._%2A%29%29" class="RktValLink" data-pltdoc="x">*</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">solid</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">red</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara">Run <span class="RktPn">(</span><span class="RktSym">main</span><span class="stt"> </span><span class="RktVal">40</span><span class="RktPn">)</span> and watch how this program deals with clock-tick
events.</div></p><p>Writing down a keyword such as <span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span> or even a complete
<span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span> clause outside a <span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> context is a syntactic
error:</p><p><div class="SIntrapara"></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._on-key%29%29" class="RktStxLink" data-pltdoc="x">on-key</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/lambda.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._lambda%29%29" class="RktStxLink" data-pltdoc="x">lambda</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">ke</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><table cellspacing="0" cellpadding="0"><tr><td><p><span class="RktErr">on-key: used out of context</span></p></td></tr><tr><td><p><span class="RktErr"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktErr">in: (on-key (lambda (s ke) s))</span></p></td></tr></table></td></tr></table></blockquote></div></p><p>Moving this clause inside the above <span class="RktSym"><a href="http://docs.racket-lang.org/teachpack/2htdpuniverse.html#%28form._world._%28%28lib._2htdp%2Funiverse..rkt%29._big-bang%29%29" class="RktStxLink" data-pltdoc="x">big-bang</a></span> allows us to stop the
shrinking-circle animation in mid-sequence.</p><p>Stop! What kind of embedded domain-specific languages for programmers does
your favorite programming language support?</p><p>Hint. Consider how how the JavaScript world has developed many such
domain-specific embedded framework-languages to deal with queries of the
DOM as a database rather a recursive tree or event-handling via virtual
DOMs.</p><h4>1.3<tt>&nbsp;</tt><a name="(part._.Why_.Embedded_.Languages_.Matter)"></a>Why Embedded Languages Matter</h4><p>Programming languages come with many different sub-languages because
language designers accept the communication role of code. Every piece of
code that moves from the initial prototyping stage to the maintenance phase
needs a lot of attention; developers must repeatedly re-visit the code,
read it, comprehend it, modify it, get it through unit and integration
testing. Language designers embrace the idea that the language in which
developers express ideas matters; and they go further in that they
recognize the need for specialized sub-languages for the different aspects
of programs.</p><p><div class="SIntrapara">The advantage of internal sub-languages over external languages is also
clear, Combining such special-purposed languages into a coherent whole is
much easier than linking programs via input/output code:
</div><div class="SIntrapara"><ul><li><p>Composition is a mere syntactic act.</p></li><li><p>Computation is accomplished via translation into the host.</p></li><li><p>Communication is easy because embedded programs compute host values.
<span class="refelem"><span class="refcolumn"><span class="refcontent">Of course, this form of communicating poses its own problems.</span></span></span></p></li></ul></div><div class="SIntrapara">In short, internal languages take away a lot of the pain of program linking.</div></p><p>In general though, only the designers of a programming language can extend
the language with new sub-languages. They do not enable ordinary developers
to program such languages on their own. On one hand, they may not trust
developers to create languages with the necessary coherence. On the other
hand, equipping a language with the tools for programming new well-designed
(implementations of) sub-languages has been a research problem for several
decades, and we seem to have figured it out only recently.</p><h4>1.4<tt>&nbsp;</tt><a name="(part._.One_.Racket_.Programmer__.Many_.Languages)"></a>One Racket Programmer, Many Languages</h4><p><div class="SIntrapara">Racket translates these insights into an explicit <span style="font-weight: bold">design goal</span>:
</div><div class="SIntrapara"><blockquote><p> Racket empowers developers to add (sub)languages,
and the process of adding these languages to the existing eco-system is
free of any friction.</p></blockquote></div><div class="SIntrapara">When we speak of <span style="font-weight: bold">language-oriented programming</span> (LOP), we mean this
specific idea.</div></p><p>Racket comes with an expressive interface for the front-end of its
implementation, that is, the <span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29._syntax%29%29" class="RktStxLink" data-pltdoc="x">syntax</a></span> system. It enables developers
to write compile-time functions and to hook such functions into the
compiler.  As a result, <span style="font-style: italic">Racket is easy to extend</span> with forms that
abstract over recurring patterns in code that <span style="font-style: italic">cannot be abstracted
over with functions</span> (or other conventional means of linguistic
abstraction). Over the past two decades, we have figured out how to use
these tools to program a wide spectrum of new sub-languages within Racket.</p><p><div class="SIntrapara">Let&rsquo;s go over these ideas with some simplistic examples before we dive in.
Here is an example of two similar syntactic phrases:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="highlighted"><span class="RktSym">bigger-string</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._number-~3estring%29%29" class="RktValLink" data-pltdoc="x">number-&gt;string</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._add1%29%29" class="RktValLink" data-pltdoc="x">add1</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/attaching-contracts-to-values.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._contract-out%29%29" class="RktStxLink" data-pltdoc="x">contract-out</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="highlighted"><span class="RktSym">bigger-string</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/strings.html#%28def._%28%28quote._~23~25kernel%29._string~3f%29%29" class="RktValLink" data-pltdoc="x">string?</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td><td valign="top"><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="highlighted"><span class="RktSym">smaller-than-5</span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._~3c%29%29" class="RktValLink" data-pltdoc="x">&lt;</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym">x</span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktVal">5</span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span></td></tr><tr><td><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/attaching-contracts-to-values.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._contract-out%29%29" class="RktStxLink" data-pltdoc="x">contract-out</a></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="highlighted"><span class="RktSym">smaller-than-5</span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="highlighted"><span class="RktPn">(</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._number~3f%29%29" class="RktValLink" data-pltdoc="x">number?</a></span></span><span class="highlighted"><span class="hspace">&nbsp;</span></span><span class="highlighted"><span class="RktSym"><a href="http://docs.racket-lang.org/reference/booleans.html#%28def._%28%28quote._~23~25kernel%29._boolean~3f%29%29" class="RktValLink" data-pltdoc="x">boolean?</a></span></span><span class="highlighted"><span class="RktPn">)</span></span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></div><div class="SIntrapara"><span class="refelem"><span class="refcolumn"><span class="refcontent">Racket&rsquo;s notion of language extension goes back to the primitive Lisp
macros from 1964. The idea has been thoroughly studied in
the intervening 55 years, and Racketeers have advanced it more than any
other community in the Lisp family.</span></span></span>
While functional (or OO) abstraction doesn&rsquo;t work to hide these two similar
phrases, syntactic extension does. And with a well-designed mechanism for
language extension the result of building an extension is a new form of
abstraction.</div></p><p>One direction of advancement concerns the creation of language modules.
Like all modern languages, Racket supports modules and a modular style of
programming. Unlike in other languages, a Racket programmer chooses the
programming language for each module in a software base independently of
what languages the other components are written in. Conversely, a language
is just a module. So to construct languages we write modules and to write
modules we use languages. This notion of langauge-modules is key to
writing software systems in Racket.</p><p>Here are two modules that use languages other than plain <span class="stt">racket</span>:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed" style="border-collapse: collapse;"><tr><td style="border-bottom: 1px solid black;"><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/datalog/interop.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">datalog</span></a></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><a href="http://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="hspace">&nbsp;</span><a href="http://docs.racket-lang.org/ts-reference/index.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">typed/racket</span></a></td></tr><tr><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktSym">edge</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="RktRdr">,</span><span class="RktSym">b</span><span class="RktPn">)</span><span class="RktInBG"><span class="hspace"></span><span class="RktIn">.</span><span class="hspace"></span></span></td></tr><tr><td><span class="RktSym">edge</span><span class="RktPn">(</span><span class="RktSym">b</span><span class="RktRdr">,</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktInBG"><span class="hspace"></span><span class="RktIn">.</span><span class="hspace"></span></span></td></tr><tr><td><span class="RktSym">edge</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="RktRdr">,</span><span class="RktSym">d</span><span class="RktPn">)</span><span class="RktInBG"><span class="hspace"></span><span class="RktIn">.</span><span class="hspace"></span></span></td></tr><tr><td><span class="RktSym">edge</span><span class="RktPn">(</span><span class="RktSym">d</span><span class="RktRdr">,</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="RktInBG"><span class="hspace"></span><span class="RktIn">.</span><span class="hspace"></span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktSym">path</span><span class="RktPn">(</span><span class="RktSym">X</span><span class="RktRdr">,</span><span class="RktSym">Y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktSym">edge</span><span class="RktPn">(</span><span class="RktSym">X</span><span class="RktRdr">,</span><span class="RktSym">Y</span><span class="RktPn">)</span><span class="RktInBG"><span class="hspace"></span><span class="RktIn">.</span><span class="hspace"></span></span></td></tr><tr><td><span class="RktSym">path</span><span class="RktPn">(</span><span class="RktSym">X</span><span class="RktRdr">,</span><span class="RktSym">Y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">edge</span><span class="RktPn">(</span><span class="RktSym">X</span><span class="RktRdr">,</span><span class="RktSym">Z</span><span class="RktPn">)</span><span class="RktRdr">,</span><span class="RktSym">path</span><span class="RktPn">(</span><span class="RktSym">Z</span><span class="RktRdr">,</span><span class="RktSym">Y</span><span class="RktPn">)</span><span class="RktInBG"><span class="hspace"></span><span class="RktIn">.</span><span class="hspace"></span></span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktSym">path</span><span class="RktPn">(</span><span class="RktSym">X</span><span class="RktRdr">,</span><span class="RktSym">Y</span><span class="RktPn">)</span><span class="RktSym">?</span></td></tr></table></td><td valign="top"><p><span class="hspace">&nbsp;&nbsp;</span></p></td><td valign="top"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span><span class="hspace">&nbsp;</span><span class="RktSym">string-&gt;er</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">define-type</span><span class="hspace">&nbsp;</span><span class="RktSym">ER</span><span class="hspace">&nbsp;</span><span class="RktSym">Exact-Rational</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;</span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">string-&gt;er</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">String</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/function-contracts.html#%28form._%28%28lib._racket%2Fcontract%2Fbase..rkt%29._-~3e%29%29" class="RktStxLink" data-pltdoc="x"><span class="nobreak">-&gt;</span></a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">U</span><span class="hspace">&nbsp;</span><span class="RktSym">ER</span><span class="hspace">&nbsp;</span><span class="RktSym">False</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktCmt">;</span><span class="RktCmt">&nbsp;</span><span class="RktCmt">convert string to exact rational if possible </span></td></tr><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">string-&gt;er</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/define.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29" class="RktStxLink" data-pltdoc="x">define</a></span><span class="hspace">&nbsp;</span><span class="RktSym">r</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/parameters.html#%28form._%28%28lib._racket%2Fprivate%2Fmore-scheme..rkt%29._parameterize%29%29" class="RktStxLink" data-pltdoc="x">parameterize</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/Reading.html#%28def._%28%28quote._~23~25kernel%29._read-decimal-as-inexact%29%29" class="RktValLink" data-pltdoc="x">read-decimal-as-inexact</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/generic-numbers.html#%28def._%28%28quote._~23~25kernel%29._string-~3enumber%29%29" class="RktValLink" data-pltdoc="x">string-&gt;number</a></span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/if.html#%28form._%28%28lib._racket%2Fprivate%2Fletstx-scheme..rkt%29._and%29%29" class="RktStxLink" data-pltdoc="x">and</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._rational~3f%29%29" class="RktValLink" data-pltdoc="x">rational?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/number-types.html#%28def._%28%28quote._~23~25kernel%29._exact~3f%29%29" class="RktValLink" data-pltdoc="x">exact?</a></span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ann</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">ER</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></div><div class="SIntrapara">Creating and experimenting with such languages has become straightforward
in the Racket eco-system.</div></p><p>Another direction of advancement is about the creation of fine-grained
language embeddings. The preceding section presents the idea of a language
of <span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> patterns. Two other sub-languages are about exporting
from, and importing into, Racket. In Racket <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> and
<span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span> specifications employ their own rich sub-languages.</p><p>Programming both kinds of languages in Racket&#8212;<wbr></wbr>module languages and
embedded languages&#8212;<wbr></wbr>benefits tremendously from what we refer to as
<span style="font-style: italic">linguistic inheritance</span>. New languages implementations may inherit
many notions from an existing one. This principle makes programming
languages in Racket so effective and quick.</p><p>One particular inheritance that module languages and embedded languages can
benefit from is extensibility. That is, we may want sub-languages to be as
extensible as Racket itself, and we can occasionally achieve this partly by
inheriting Racket&rsquo;s form of extensibility in some ways.</p><p><div class="SIntrapara">For example, Racket&rsquo;s <span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> pattern language is extensible. Here
is a concrete example, an extension that allows the expression
<span class="RktPn">(</span><span class="RktSym">adder</span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktPn">)</span> to mean one thing in a Racket expression context:
</div><div class="SIntrapara"><p><div class="SIntrapara"></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym">adder</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">'(2<span class="stt"> </span>3<span class="stt"> </span>4)</span></p></td></tr></table></blockquote></div></p></div><div class="SIntrapara">and something different in a Racket pattern context:
</div><div class="SIntrapara"><p><div class="SIntrapara"></div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktVal">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">adder</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"success!"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><a href="http://docs.racket-lang.org/reference/stx-patterns.html#%28form._%28%28lib._racket%2Fprivate%2Fstxcase-scheme..rkt%29.__%29%29" class="RktStxLink" data-pltdoc="x">_</a></span><span class="hspace">&nbsp;</span><span class="RktVal">"** failure **"</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">"success!"</span></p></td></tr></table></blockquote></div></p></div><div class="SIntrapara">That is, in a regular context the phrase is evaluated as a regular function
application, while in a pattern context within a <span class="RktSym"><a href="http://docs.racket-lang.org/reference/match.html#%28form._%28%28lib._racket%2Fmatch..rkt%29._match%29%29" class="RktStxLink" data-pltdoc="x">match</a></span> the same
phrase turns into a pattern (that sets up a match with the result of the
function call).</div></p><p>Similarly, the <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._provide%29%29" class="RktStxLink" data-pltdoc="x">provide</a></span> and <span class="RktSym"><a href="http://docs.racket-lang.org/reference/require.html#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._require%29%29" class="RktStxLink" data-pltdoc="x">require</a></span> sub-languages are
extensible, too. See <a href="http://docs.racket-lang.org/reference/define.html#%28part._provide-syntax%29" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">provide</span></span> Macros</a> and <a href="http://docs.racket-lang.org/reference/define.html#%28part._require-syntax%29" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">require</span></span> Macros</a> for the documentation
on how to extend these languages.</p><h4>1.5<tt>&nbsp;</tt><a name="(part._.Programming_.A_.Language__.Programming_.Many_.Languages)"></a>Programming A Language, Programming Many Languages</h4><p>The goal of these notes is to introduce you to the idea of programming a
language extension, programming a complete language, and eventually
programming as many languages as needed for any project.</p><p>In short, you can think of these notes as introduction to the art of
hacking your own languages (in Racket).</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="preface.html" title="backward to &quot;Prelude&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Programming Languages&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="a-model.html" title="forward to &quot;2 A Model of Macro Expansion&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>