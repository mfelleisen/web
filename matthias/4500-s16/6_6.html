<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><title>6 --- Incremental refinement, the second step</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Software Development</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="abstract.html" class="tocviewlink" data-pltdoc="x">Abstract</a></td></tr><tr><td align="right"></td><td><a href="general.html" class="tocviewlink" data-pltdoc="x">General</a></td></tr><tr><td align="right"></td><td><a href="readings.html" class="tocviewlink" data-pltdoc="x">Readings</a></td></tr><tr><td align="right"></td><td><a href="communication.html" class="tocviewlink" data-pltdoc="x">Communication</a></td></tr><tr><td align="right"></td><td><a href="log.html" class="tocviewlink" data-pltdoc="x">Log Book</a></td></tr><tr><td align="right"></td><td><a href="projects.html" class="tocviewlink" data-pltdoc="x">Projects, General</a></td></tr><tr><td align="right"></td><td><a href="assignments.html" class="tocviewselflink" data-pltdoc="x">Projects, Specifics</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td></td><td><a href="assignments.html" class="tocviewlink" data-pltdoc="x">Projects, Specifics</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right"></td><td><a href="readme.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">Read Me</span></a></td></tr><tr><td align="right"></td><td><a href="reviews.html" class="tocviewlink" data-pltdoc="x"><span style="color: red">Design Reviews, Code Walks</span></a></td></tr><tr><td align="right"></td><td><a href="take5.html" class="tocviewlink" data-pltdoc="x">6 Nimmt!</a></td></tr><tr><td align="right"></td><td><a href="evolution.html" class="tocviewlink" data-pltdoc="x">Evolution</a></td></tr><tr><td align="right"></td><td><a href="faq.html" class="tocviewlink" data-pltdoc="x">FAQ on Evolution</a></td></tr><tr><td align="right"></td><td><a href="iprotocol.html" class="tocviewlink" data-pltdoc="x">Internal Protocol</a></td></tr><tr><td align="right"></td><td><a href="r_remote.html" class="tocviewlink" data-pltdoc="x">Remote Protocol</a></td></tr><tr><td align="right"></td><td><a href="1.html" class="tocviewlink" data-pltdoc="x">1 &#8212;<wbr></wbr> Your Favorite Programming Language</a></td></tr><tr><td align="right"></td><td><a href="2.html" class="tocviewlink" data-pltdoc="x">2 &#8212;<wbr></wbr> Living up to interfaces</a></td></tr><tr><td align="right"></td><td><a href="3.html" class="tocviewlink" data-pltdoc="x">3 &#8212;<wbr></wbr> Development includes maintenance</a></td></tr><tr><td align="right"></td><td><a href="4.html" class="tocviewlink" data-pltdoc="x">4 &#8212;<wbr></wbr> From interfaces to protocols</a></td></tr><tr><td align="right"></td><td><a href="5_5.html" class="tocviewlink" data-pltdoc="x">5 &#8212;<wbr></wbr> Incremental refinement, a minimal start</a></td></tr><tr><td align="right"></td><td><a href="" class="tocviewselflink" data-pltdoc="x">6 &#8212;<wbr></wbr> Incremental refinement, the second step</a></td></tr><tr><td align="right"></td><td><a href="7.html" class="tocviewlink" data-pltdoc="x">7 &#8212;<wbr></wbr> Changing an API</a></td></tr><tr><td align="right"></td><td><a href="8_8.html" class="tocviewlink" data-pltdoc="x">8 &#8212;<wbr></wbr> Selecting testable methods</a></td></tr><tr><td align="right"></td><td><a href="9.html" class="tocviewlink" data-pltdoc="x">9 &#8212;<wbr></wbr> GUI design, get UX people involved</a></td></tr><tr><td align="right"></td><td><a href="10.html" class="tocviewlink" data-pltdoc="x">10 &#8212;<wbr></wbr> Refactoring</a></td></tr><tr><td align="right"></td><td><a href="11_11.html" class="tocviewlink" data-pltdoc="x">11 &#8212;<wbr></wbr> Designing a Protocol</a></td></tr><tr><td align="right"></td><td><a href="12.html" class="tocviewlink" data-pltdoc="x">12 &#8212;<wbr></wbr> Integration Time</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;">&bull;</td><td></td><td><a href="" class="tocviewselflink" data-pltdoc="x">6 &#8212;<wbr></wbr> Incremental refinement, the second step</a></td></tr></table></div></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">6.4.0.15</span></div><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="5_5.html" title="backward to &quot;5 --- Incremental refinement, a minimal start&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="assignments.html" title="up to &quot;Projects, Specifics&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="7.html" title="forward to &quot;7 --- Changing an API&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4><a name="(part._6)"></a>6 &#8212;<wbr></wbr> Incremental refinement, the second step</h4><a name="(part._chap~3a6)"></a><p><span style="font-weight: bold">Due</span>
  <span class="strike" style="text-decoration:line-through">Sunday, 21 February, midnight</span>
  <span style="color: red">Wednesday, 24 February, noon</span></p><p>Your software architect has determined that the dealer can perform some
actions of the feeding step without input from the players. For example, if
a player possesses a single hungry species and there is food available at
the watering hole, the rules dictate that the player will feed this
species. Similarly, if a player is in possession of a single hungry
carnivore and only one other player has an attackable species, then the
former will launch the attack on the latter. The dealer ought to ask the
player, however, if it is willing to attack one its own species with such a
single hungry carnivore. In other situations, the dealer must interact with
the player and acquire the necessary information before it can take the
next step in the feeding cycle.</p><p>Since this interaction is the most complex part of the player-dealer
interaction, your architect asked for the <span class="stt">attackable?</span> method last week
and now requests a method that implements a sample strategy for picking the
next species to be fed.</p><p><span style="font-weight: bold">Rule Change</span> After some reflection, your software architect has also
decided to disallow duplicate trait cards for a species.</p><p><div class="SIntrapara"><span style="color: red"><span style="font-weight: bold">Rule Reinforcements</span></span> The architect also re-considered two
additional points:
</div><div class="SIntrapara"><ul><li><p>Carnivores cannot attack themselves or, succinctly, carnivores are
not cannibals.</p></li><li><p>If a species becomes extinct due to an attack, its food is lost to
the player and the species board is immediately removed from the player&rsquo;s
possession. The player receives two cards at the end of the turn for this
loss.</p></li></ul></div></p><p><span style="color: blue">Task 1</span> Design a data representation for the players of the
<a href="evolution.html" data-pltdoc="x">Evolution</a> game.</p><p>Develop a function (method) that determines a player&rsquo;s next species to be
fed. Recall that this may be either a vegetarian or a carnivore. In the
latter case, the response must not only specify which carnivore to feed but
also which species it will attack and to which player this species belongs.</p><p><div class="SIntrapara">The function has the following kinds of contracts:
</div><div class="SIntrapara"><ul><li><p><div class="SIntrapara">Its <span style="font-style: italic">type signature</span> dictates that it consumes representations
of the other players, in case one of the player&rsquo;s carnivores must attack
a species of some other player. The result type ought to describe the
following possibilities:
</div><div class="SIntrapara"><ol><li><p>one of its own species with the fat-tissue trait and the number of tokens
it wishes to store</p></li><li><p>one of its own vegetarian species</p></li><li><p>one of its own carnivores plus a different player and one of this player&rsquo;s species</p></li><li><p>an indication that it does not wish to feed any species anymore.</p></li></ol></div></p></li><li><p>Its <span style="font-style: italic">behavioral contract</span> adds that the second and third kind
of results must be "hungry" species and that in the third case, the first
species can successfully attack the second one.</p></li><li><p>The <span style="font-style: italic">sequencing constraints</span> of the method implies that there
is some food at the watering hole and that the player is in possession of
at least two hungry species or of a carnivore that must decide which
species to attack, if any.</p></li></ul></div></p><p><div class="SIntrapara"><span style="font-weight: bold">Strategy</span> This particular player feeds the species according to the
following strategy:
</div><div class="SIntrapara"><ol><li><p>If any species has a fat-tissue trait, the player will first request
as much food as this trait allows. In case, more than one species has the
fat-tissue trait, the player picks the one with the largest need for
fat-tissue food. Finally, if two or more species have a largest need for
fat-tissue food, the player goes by an order on species (specified below)
and, secondary to that, uses the order of species boards.</p></li><li><p>If any of its vegetarians is still hungry, it feeds the largest one
of those next. <span style="color: red">Ties are broken by the order of the species boards.</span></p></li><li><p>If there are no hungry vegetarians, the player use the largest
carnivore that can attack some other species from the other players It
attacks the largest species that can be attacked. A tie is broken with the
order in which the players are given; the first player&rsquo;s species in this
ordering is picked; within the player, the strategy breaks ties via the
ordering of the player&rsquo;s species boards.</p></li><li><p>The player will not use one of its carnivores to attack any of its
own species.</p></li></ol></div></p><p><span style="font-weight: bold">Ordering</span> Species are ordered in a <a href="https://en.wikipedia.org/wiki/Lexicographical_order">lexicographic</a> manner, starting with the (plain) population
attribute, followed by the food that the species has been fed so far, and
finally the (plain) body size.</p><p><span style="font-weight: bold">Delivery</span> Create a sub-directory called <span class="stt">feeding</span> and place all
necessary files/modules for the data representation and the method into
this sub-directory.</p><p><span style="color: blue">Task 2</span> Develop a test harness for the method that accepts a single JSON
expression from <span class="stt">STDIN</span> and writes its results to <span class="stt">STDOUT</span> after turning
it into JSON.</p><p><div class="SIntrapara">The input consists of a single <a href="#%28tech._feeding%29" class="techoutside" data-pltdoc="x"><span class="techinside">Feeding</span></a>. The output is one of:
</div><div class="SIntrapara"><ul><li><p><span class="stt">false</span>, meaning the only possibility is to have one of this
player&rsquo;s species attack some other species and the player chooses to forgo
any attack now and for the rest of this turn;</p></li><li><p><a href="#%28tech._species%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Species+</span></a>, meaning the species is vegetarian and gets the next
token of food;</p></li><li><p><span class="stt">[</span><a href="#%28tech._species%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Species+</span></a><span class="stt">, </span><font class="badlink"><span class="techoutside"><span class="techinside">Nat</span></span></font><span class="stt">]</span>, meaning the species comes with a
fat-tissue trait and wishes to store the specified number of food tokens;</p></li><li><p><span class="stt">[</span><a href="#%28tech._species%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Species+</span></a><span class="stt">, </span><a href="#%28tech._player%29" class="techoutside" data-pltdoc="x"><span class="techinside">Player</span></a><span class="stt">, </span><a href="#%28tech._species%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Species+</span></a><span class="stt">]</span>, meaning the
first species attacks the second species, which belongs to the given player.</p></li></ul></div></p><p><div class="SIntrapara">Here are the relevant data definitions:
</div><div class="SIntrapara"><blockquote class="smaller"><p>A <a name="(tech._feeding)"></a><span style="font-style: italic">Feeding</span> is <span class="stt">[</span><a href="#%28tech._player%29" class="techoutside" data-pltdoc="x"><span class="techinside">Player</span></a><span class="stt">, </span><a href="#%28tech._natural%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Natural+</span></a><span class="stt">,</span><span class="stt">
</span><a href="#%28tech._lop%29" class="techoutside" data-pltdoc="x"><span class="techinside">LOP</span></a><span class="stt">]</span>. <span style="color: red">The natural number in the middle specifies how many tokens
of food are left at the watering hole.</span></p><p><div class="SIntrapara">A <a name="(tech._player)"></a><span style="font-style: italic">Player</span> is
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[["id",</span><a href="#%28tech._natural%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Natural+</span></a><span class="stt">],</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">["species",</span><a href="#%28tech._lo%29" class="techoutside" data-pltdoc="x"><span class="techinside">LOS</span></a><span class="stt">],</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">["bag",</span><a href="#%28tech._natural%29" class="techoutside" data-pltdoc="x"><span class="techinside">Natural</span></a><span class="stt">]]</span></p></td></tr></table></div></p><p>A <a name="(tech._lop)"></a><span style="font-style: italic">LOP</span> is <span class="stt">[</span><a href="#%28tech._player%29" class="techoutside" data-pltdoc="x"><span class="techinside">Player</span></a><span class="stt">, ..., </span><a href="#%28tech._player%29" class="techoutside" data-pltdoc="x"><span class="techinside">Player</span></a><span class="stt">]</span>; the list might be empty.</p><p>A <a name="(tech._lo)"></a><span style="font-style: italic">LOS</span> is <span class="stt">[</span><a href="#%28tech._species%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Species+</span></a><span class="stt">, ..., </span><a href="#%28tech._species%2B%29" class="techoutside" data-pltdoc="x"><span class="techinside">Species+</span></a><span class="stt">]</span>; the list might be empty.</p><p>A <a name="(tech._natural+)"></a><span style="font-style: italic">Natural+</span> is a JSON number interpretable as a natural number
larger than, <span style="color: red">or equal to</span>, 1.</p><p>A <a name="(tech._natural)"></a><span style="font-style: italic">Natural</span> is a JSON number interpretable as a natural number.</p><p><div class="SIntrapara"><span style="color: red">A <a name="(tech._species+)"></a><span style="font-style: italic">Species+</span> is one of:</span>
</div><div class="SIntrapara"><ul><li><p>a regular <font class="badlink"><span class="techoutside"><span class="techinside">Species</span></span></font></p></li><li><p><div class="SIntrapara">a <font class="badlink"><span class="techoutside"><span class="techinside">Species</span></span></font> with a <span class="stt">"fat-food"</span> field:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">[["food",Nat],</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">["body",Nat],</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">["population",</span><span style="color: red"><font class="badlink"><span class="techoutside"><span class="techinside">Nat+</span></span></font></span><span class="stt">],</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">["traits",LOT]</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt"></span><span class="hspace">&nbsp;</span><span class="stt">["fat-food" ,Nat]]</span></p></td></tr></table></div><div class="SIntrapara">The additional field specifies how much food is stored on the species&rsquo;s
fat-tissue card. The specification is inconsistent if the traits list does
not come with the trait <span class="stt">"fat-tissue"</span>.</div></p></li></ul></div></p></blockquote></div></p><p><div class="SIntrapara"><span style="font-weight: bold">Delivery</span> Place an executable called <span class="stt">xfeed</span> into your main
folder (for this project). Make sure it can be run from the command line like this:
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">./xfeed &lt; some-json-input &gt; some-json-output</span></p></td></tr></table></div><div class="SIntrapara">The <span class="stt">xfeed</span> executable must use the method from task 1.
It may assume that all test inputs satisfy the JSON specification above.</div></p><p><div class="SIntrapara"><span style="color: red">Three Bonus Points</span> Create a script called <span class="stt">compile</span> that
(byte-code)compiles <span class="stt">xfeed</span>. Place it into your main folder (for this
project). Make sure it can be run from the command line like this
<span class="refelem"><span class="refcolumn"><span class="refcontent"><span style="font-style: italic">Exit status</span> is another one of those things you need
to pick up as you turn into a software dev.</span></span></span>
</div><div class="SIntrapara"><table cellspacing="0" cellpadding="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="stt">./compile</span></p></td></tr></table></div><div class="SIntrapara">and that its exit status is <span class="stt">0</span> if the compilation is successful. If
<span class="stt">compile</span> exists and it exits with a status other than 0, we will not
run <span class="stt">xfeed</span>.</div></p><p><span style="color: red">Implied by <a href="4.html" data-pltdoc="x">4 &#8212;<wbr></wbr> From interfaces to protocols</a></span> Develop up to five pairs of JSON files that
represent unit tests for <span class="stt">./xfeed</span>. The input file contains a single
JSON expressions that plays the role of a message piped into your harness;
the output file contains the expected JSON return messages.</p><p><span style="color: blue">Task 3</span> Study how a dealer (1) decides whether to call the above
method for a player when it is the player&rsquo;s turn to feed a species and (2)
applies the results of the above method to the state of the game.</p><p><span style="font-weight: bold">Delivery</span> Write a one-page PDF memo and name it <span class="stt">feed.pdf</span>. There
is no need for any header material other than a subject line and your
names. Place the document into the folder for this project.</p><p><img src="pict_7.png" alt="image" width="651" height="1"/></p><blockquote><table cellspacing="0" cellpadding="0" style="border-collapse: collapse;"><tr><td style="border-bottom: 1px solid black;"><p>question</p></td><td style="border-bottom: 1px solid black;"><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td style="border-bottom: 1px solid black;"><p>answer</p></td></tr><tr><td valign="top"><p>What should <span class="stt">xfeed</span> produce if the JSON is well-formed but violates
some other constraint(s)?</p></td><td valign="top"><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td valign="top"><p>Your program should not return anything in this case.</p></td></tr><tr><td valign="top"><p></p></td><td valign="top"><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p></td><td valign="top"><p></p></td></tr></table></blockquote><p>The rest was moved to <a href="faq.html" data-pltdoc="x">FAQ on Evolution</a>.</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="5_5.html" title="backward to &quot;5 --- Incremental refinement, a minimal start&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="assignments.html" title="up to &quot;Projects, Specifics&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="7.html" title="forward to &quot;7 --- Changing an API&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>